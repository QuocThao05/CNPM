<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/AndroidManifest.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/AndroidManifest.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;&#10;&#10;    &lt;application&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:theme=&quot;@style/Theme.Final&quot;&#10;        tools:targetApi=&quot;31&quot;&gt;&#10;&#10;        &lt;!-- Main Activity (Launcher) --&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;&#10;        &lt;!-- Home Activity - Thêm vào để khắc phục lỗi --&gt;&#10;        &lt;activity&#10;            android:name=&quot;.HomeActivity&quot;&#10;            android:theme=&quot;@style/Theme.Final.NoActionBar&quot; /&gt;&#10;&#10;        &lt;!-- Splash Activity --&gt;&#10;        &lt;activity android:name=&quot;.SplashActivity&quot; /&gt;&#10;&#10;        &lt;!-- Authentication Activities --&gt;&#10;        &lt;activity android:name=&quot;.LoginActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.RegisterActivity&quot; /&gt;&#10;&#10;        &lt;!-- Dashboard Activities --&gt;&#10;        &lt;activity android:name=&quot;.TeacherDashboardActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentDashboardActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.AdminDashboardActivity&quot; /&gt;&#10;&#10;        &lt;!-- Course Activities --&gt;&#10;        &lt;activity&#10;            android:name=&quot;.StudentCourseSearchActivity&quot;&#10;            android:theme=&quot;@style/Theme.Final.NoActionBar&quot; /&gt;&#10;&#10;        &lt;activity&#10;            android:name=&quot;.CourseRequestManagementActivity&quot;&#10;            android:label=&quot;Quản lý yêu cầu khóa học&quot;&#10;            android:parentActivityName=&quot;.TeacherDashboardActivity&quot; /&gt;&#10;&#10;        &lt;!-- Student Learning Activities --&gt;&#10;        &lt;activity android:name=&quot;.StudentMyCoursesActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentCourseLessonsActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentCourseDetailActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentLessonLearningActivity&quot; /&gt;&#10;&#10;&#10;        &lt;!-- Quiz Management Activities --&gt;&#10;        &lt;activity&#10;            android:name=&quot;.SelectCourseForQuizActivity&quot;&#10;            android:label=&quot;Chọn khóa học&quot;&#10;            android:parentActivityName=&quot;.TeacherDashboardActivity&quot; /&gt;&#10;        &lt;activity&#10;            android:name=&quot;.CreateQuizActivity&quot;&#10;            android:label=&quot;Tạo bài kiểm tra&quot;&#10;            android:parentActivityName=&quot;.SelectCourseForQuizActivity&quot; /&gt;&#10;&#10;&#10;        &lt;!-- Other Activities --&gt;&#10;        &lt;activity android:name=&quot;.CourseManagementActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.LessonManagementActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.EnrollmentManagementActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.CreateCourseActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.EditCourseActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.CourseListActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.CourseLessonsActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.CourseStudentsActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.CreateLessonActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.EditLessonActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.LessonDetailActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.PersonalScheduleActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudyProgressActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentProgressDetailActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.QuizActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.UpdateProfileActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.FeedbackActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.AdminAccountManagementActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.ContentCreationActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.SystemStatisticsActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentReportActivity&quot; /&gt;&#10;        &lt;activity android:name=&quot;.StudentDetailReportActivity&quot; /&gt;&#10;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#13;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#13;&#10;&#13;&#10;    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;&#13;&#10;    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;application&#13;&#10;        android:allowBackup=&quot;true&quot;&#13;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#13;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#13;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#13;&#10;        android:label=&quot;@string/app_name&quot;&#13;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#13;&#10;        android:supportsRtl=&quot;true&quot;&#13;&#10;        android:theme=&quot;@style/Theme.Final&quot;&#13;&#10;        tools:targetApi=&quot;31&quot;&gt;&#13;&#10;&#13;&#10;        &lt;!-- Main Activity (Launcher) --&gt;&#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.MainActivity&quot;&#13;&#10;            android:exported=&quot;true&quot;&gt;&#13;&#10;            &lt;intent-filter&gt;&#13;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#13;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#13;&#10;            &lt;/intent-filter&gt;&#13;&#10;        &lt;/activity&gt;&#13;&#10;&#13;&#10;        &lt;!-- Home Activity - Thêm vào để khắc phục lỗi --&gt;&#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.HomeActivity&quot;&#13;&#10;            android:theme=&quot;@style/Theme.Final.NoActionBar&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- Splash Activity --&gt;&#13;&#10;        &lt;activity android:name=&quot;.SplashActivity&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- Authentication Activities --&gt;&#13;&#10;        &lt;activity android:name=&quot;.LoginActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.RegisterActivity&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- Dashboard Activities --&gt;&#13;&#10;        &lt;activity android:name=&quot;.TeacherDashboardActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentDashboardActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.AdminDashboardActivity&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- Course Activities --&gt;&#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.StudentCourseSearchActivity&quot;&#13;&#10;            android:theme=&quot;@style/Theme.Final.NoActionBar&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- Edit Test Questions Activity --&gt;&#13;&#10;        &lt;activity android:name=&quot;.EditTestQuestionsActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.EditSingleTestQuestionActivity&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.CourseRequestManagementActivity&quot;&#13;&#10;            android:label=&quot;Quản lý yêu cầu khóa học&quot;&#13;&#10;            android:parentActivityName=&quot;.TeacherDashboardActivity&quot; /&gt;&#13;&#10;&#13;&#10;        &lt;!-- Student Learning Activities --&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentMyCoursesActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentCourseLessonsActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentCourseDetailActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentLessonLearningActivity&quot; /&gt;&#13;&#10;&#13;&#10;&#13;&#10;        &lt;!-- Quiz Management Activities --&gt;&#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.SelectCourseForQuizActivity&quot;&#13;&#10;            android:label=&quot;Chọn khóa học&quot;&#13;&#10;            android:parentActivityName=&quot;.TeacherDashboardActivity&quot; /&gt;&#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.CreateQuizActivity&quot;&#13;&#10;            android:label=&quot;Tạo bài kiểm tra&quot;&#13;&#10;            android:parentActivityName=&quot;.SelectCourseForQuizActivity&quot; /&gt;&#13;&#10;&#13;&#10;&#13;&#10;        &lt;!-- Other Activities --&gt;&#13;&#10;        &lt;activity android:name=&quot;.CourseManagementActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.LessonManagementActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.EnrollmentManagementActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.CreateCourseActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.EditCourseActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.CourseListActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.CourseLessonsActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.CourseStudentsActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.CreateLessonActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.EditLessonActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.LessonDetailActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.PersonalScheduleActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudyProgressActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentProgressDetailActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.QuizActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.UpdateProfileActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.FeedbackActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.AdminAccountManagementActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.ContentCreationActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.SystemStatisticsActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentReportActivity&quot; /&gt;&#13;&#10;        &lt;activity android:name=&quot;.StudentDetailReportActivity&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;/application&gt;&#13;&#10;&#13;&#10;&lt;/manifest&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/ContentCreationActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/ContentCreationActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.LinearLayout;&#10;import android.widget.RadioButton;&#10;import android.widget.RadioGroup;&#10;import android.widget.Spinner;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.cardview.widget.CardView;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import com.google.android.material.floatingactionbutton.FloatingActionButton;&#10;import com.google.android.material.tabs.TabLayout;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;public class ContentCreationActivity extends AppCompatActivity {&#10;&#10;    private Toolbar toolbar;&#10;    private TabLayout tabLayout;&#10;    private CardView cardLessonCreation, cardQuizCreation, cardVocabularyList;&#10;    private LinearLayout layoutLessonForm, layoutQuizForm, layoutVocabularyForm;&#10;&#10;    // Lesson creation components&#10;    private EditText etLessonTitle, etLessonDescription, etLessonContent;&#10;    private Spinner spinnerLessonCategory, spinnerDifficulty;&#10;    private Button btnSaveLesson, btnPreviewLesson;&#10;&#10;    // Quiz creation components&#10;    private EditText etQuizTitle, etQuizDescription;&#10;    private EditText etQuestion, etOption1, etOption2, etOption3, etOption4;&#10;    private RadioGroup rgCorrectAnswer;&#10;    private RecyclerView rvQuestions;&#10;    private Button btnAddQuestion, btnSaveQuiz, btnPreviewQuiz;&#10;&#10;    // Vocabulary components&#10;    private EditText etWord, etMeaning, etExample, etPronunciation;&#10;    private Spinner spinnerWordCategory;&#10;    private Button btnAddWord, btnSaveVocabulary;&#10;    private RecyclerView rvVocabularyList;&#10;&#10;    private FloatingActionButton fabPublish;&#10;    private TextView tvContentCount;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String mode; // &quot;lesson&quot;, &quot;quiz&quot;, &quot;vocabulary&quot;&#10;    private String teacherId;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_content_creation);&#10;&#10;        // Get mode from intent&#10;        mode = getIntent().getStringExtra(&quot;mode&quot;);&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        if (mAuth.getCurrentUser() != null) {&#10;            teacherId = mAuth.getCurrentUser().getUid();&#10;        }&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupTabs();&#10;        setupClickListeners();&#10;        handleModeSpecificSetup();&#10;        loadExistingContent();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        tabLayout = findViewById(R.id.tab_layout);&#10;&#10;        // Cards&#10;        cardLessonCreation = findViewById(R.id.card_lesson_creation);&#10;        cardQuizCreation = findViewById(R.id.card_quiz_creation);&#10;        cardVocabularyList = findViewById(R.id.card_vocabulary_list);&#10;&#10;        // Layouts&#10;        layoutLessonForm = findViewById(R.id.layout_lesson_form);&#10;        layoutQuizForm = findViewById(R.id.layout_quiz_form);&#10;        layoutVocabularyForm = findViewById(R.id.layout_vocabulary_form);&#10;&#10;        // Lesson creation&#10;        etLessonTitle = findViewById(R.id.et_lesson_title);&#10;        etLessonDescription = findViewById(R.id.et_lesson_description);&#10;        etLessonContent = findViewById(R.id.et_lesson_content);&#10;        spinnerLessonCategory = findViewById(R.id.spinner_lesson_category);&#10;        spinnerDifficulty = findViewById(R.id.spinner_difficulty);&#10;        btnSaveLesson = findViewById(R.id.btn_save_lesson);&#10;        btnPreviewLesson = findViewById(R.id.btn_preview_lesson);&#10;&#10;        // Quiz creation&#10;        etQuizTitle = findViewById(R.id.et_quiz_title);&#10;        etQuizDescription = findViewById(R.id.et_quiz_description);&#10;        etQuestion = findViewById(R.id.et_question);&#10;        etOption1 = findViewById(R.id.et_option1);&#10;        etOption2 = findViewById(R.id.et_option2);&#10;        etOption3 = findViewById(R.id.et_option3);&#10;        etOption4 = findViewById(R.id.et_option4);&#10;        rgCorrectAnswer = findViewById(R.id.rg_correct_answer);&#10;        rvQuestions = findViewById(R.id.rv_questions);&#10;        btnAddQuestion = findViewById(R.id.btn_add_question);&#10;        btnSaveQuiz = findViewById(R.id.btn_save_quiz);&#10;        btnPreviewQuiz = findViewById(R.id.btn_preview_quiz);&#10;&#10;        // Vocabulary&#10;        etWord = findViewById(R.id.et_word);&#10;        etMeaning = findViewById(R.id.et_meaning);&#10;        etExample = findViewById(R.id.et_example);&#10;        etPronunciation = findViewById(R.id.et_pronunciation);&#10;        spinnerWordCategory = findViewById(R.id.spinner_word_category);&#10;        btnAddWord = findViewById(R.id.btn_add_word);&#10;        btnSaveVocabulary = findViewById(R.id.btn_save_vocabulary);&#10;        rvVocabularyList = findViewById(R.id.rv_vocabulary_list);&#10;&#10;        // Other components&#10;        fabPublish = findViewById(R.id.fab_publish);&#10;        tvContentCount = findViewById(R.id.tv_content_count);&#10;&#10;        // Setup RecyclerViews&#10;        if (rvQuestions != null) {&#10;            rvQuestions.setLayoutManager(new LinearLayoutManager(this));&#10;        }&#10;        if (rvVocabularyList != null) {&#10;            rvVocabularyList.setLayoutManager(new LinearLayoutManager(this));&#10;        }&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;            getSupportActionBar().setDisplayShowHomeEnabled(true);&#10;            getSupportActionBar().setTitle(&quot;Tạo nội dung&quot;);&#10;        }&#10;    }&#10;&#10;    private void setupTabs() {&#10;        if (tabLayout != null) {&#10;            tabLayout.addTab(tabLayout.newTab().setText(&quot;Bài học&quot;));&#10;            tabLayout.addTab(tabLayout.newTab().setText(&quot;Quiz&quot;));&#10;            tabLayout.addTab(tabLayout.newTab().setText(&quot;Từ vựng&quot;));&#10;&#10;            tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {&#10;                @Override&#10;                public void onTabSelected(TabLayout.Tab tab) {&#10;                    switchContentType(tab.getPosition());&#10;                }&#10;&#10;                @Override&#10;                public void onTabUnselected(TabLayout.Tab tab) {}&#10;&#10;                @Override&#10;                public void onTabReselected(TabLayout.Tab tab) {}&#10;            });&#10;        }&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        // Lesson creation&#10;        if (btnSaveLesson != null) {&#10;            btnSaveLesson.setOnClickListener(v -&gt; saveLesson());&#10;        }&#10;        if (btnPreviewLesson != null) {&#10;            btnPreviewLesson.setOnClickListener(v -&gt; previewLesson());&#10;        }&#10;&#10;        // Quiz creation&#10;        if (btnAddQuestion != null) {&#10;            btnAddQuestion.setOnClickListener(v -&gt; addQuestion());&#10;        }&#10;        if (btnSaveQuiz != null) {&#10;            btnSaveQuiz.setOnClickListener(v -&gt; saveQuiz());&#10;        }&#10;        if (btnPreviewQuiz != null) {&#10;            btnPreviewQuiz.setOnClickListener(v -&gt; previewQuiz());&#10;        }&#10;&#10;        // Vocabulary&#10;        if (btnAddWord != null) {&#10;            btnAddWord.setOnClickListener(v -&gt; addWord());&#10;        }&#10;        if (btnSaveVocabulary != null) {&#10;            btnSaveVocabulary.setOnClickListener(v -&gt; saveVocabularyList());&#10;        }&#10;&#10;        // FAB&#10;        if (fabPublish != null) {&#10;            fabPublish.setOnClickListener(v -&gt; publishContent());&#10;        }&#10;    }&#10;&#10;    private void handleModeSpecificSetup() {&#10;        if (&quot;lesson&quot;.equals(mode) &amp;&amp; tabLayout != null) {&#10;            tabLayout.getTabAt(0).select();&#10;            switchContentType(0);&#10;        } else if (&quot;quiz&quot;.equals(mode) &amp;&amp; tabLayout != null) {&#10;            tabLayout.getTabAt(1).select();&#10;            switchContentType(1);&#10;        } else if (&quot;vocabulary&quot;.equals(mode) &amp;&amp; tabLayout != null) {&#10;            tabLayout.getTabAt(2).select();&#10;            switchContentType(2);&#10;        }&#10;    }&#10;&#10;    private void switchContentType(int position) {&#10;        // Hide all layouts first&#10;        hideAllLayouts();&#10;&#10;        switch (position) {&#10;            case 0: // Lesson&#10;                if (layoutLessonForm != null) {&#10;                    layoutLessonForm.setVisibility(View.VISIBLE);&#10;                }&#10;                break;&#10;            case 1: // Quiz&#10;                if (layoutQuizForm != null) {&#10;                    layoutQuizForm.setVisibility(View.VISIBLE);&#10;                }&#10;                break;&#10;            case 2: // Vocabulary&#10;                if (layoutVocabularyForm != null) {&#10;                    layoutVocabularyForm.setVisibility(View.VISIBLE);&#10;                }&#10;                break;&#10;        }&#10;    }&#10;&#10;    private void hideAllLayouts() {&#10;        if (layoutLessonForm != null) layoutLessonForm.setVisibility(View.GONE);&#10;        if (layoutQuizForm != null) layoutQuizForm.setVisibility(View.GONE);&#10;        if (layoutVocabularyForm != null) layoutVocabularyForm.setVisibility(View.GONE);&#10;    }&#10;&#10;    private void saveLesson() {&#10;        if (teacherId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không thể xác định giáo viên&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        String title = etLessonTitle != null ? etLessonTitle.getText().toString().trim() : &quot;&quot;;&#10;        String description = etLessonDescription != null ? etLessonDescription.getText().toString().trim() : &quot;&quot;;&#10;        String content = etLessonContent != null ? etLessonContent.getText().toString().trim() : &quot;&quot;;&#10;&#10;        if (title.isEmpty() || content.isEmpty()) {&#10;            Toast.makeText(this, &quot;Vui lòng nhập đầy đủ tiêu đề và nội dung&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        Map&lt;String, Object&gt; lessonData = new HashMap&lt;&gt;();&#10;        lessonData.put(&quot;teacherId&quot;, teacherId);&#10;        lessonData.put(&quot;title&quot;, title);&#10;        lessonData.put(&quot;description&quot;, description);&#10;        lessonData.put(&quot;content&quot;, content);&#10;        lessonData.put(&quot;type&quot;, &quot;lesson&quot;);&#10;        lessonData.put(&quot;createdAt&quot;, System.currentTimeMillis());&#10;        lessonData.put(&quot;status&quot;, &quot;draft&quot;);&#10;&#10;        db.collection(&quot;content&quot;)&#10;                .add(lessonData)&#10;                .addOnSuccessListener(documentReference -&gt; {&#10;                    Toast.makeText(this, &quot;Bài học đã được lưu thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                    clearLessonForm();&#10;                    updateContentCount();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Toast.makeText(this, &quot;Lỗi khi lưu: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void previewLesson() {&#10;        Intent intent = new Intent(this, CourseListActivity.class);&#10;        intent.putExtra(&quot;mode&quot;, &quot;preview&quot;);&#10;        intent.putExtra(&quot;title&quot;, etLessonTitle != null ? etLessonTitle.getText().toString() : &quot;&quot;);&#10;        startActivity(intent);&#10;    }&#10;&#10;    private void addQuestion() {&#10;        String question = etQuestion != null ? etQuestion.getText().toString().trim() : &quot;&quot;;&#10;        String option1 = etOption1 != null ? etOption1.getText().toString().trim() : &quot;&quot;;&#10;        String option2 = etOption2 != null ? etOption2.getText().toString().trim() : &quot;&quot;;&#10;        String option3 = etOption3 != null ? etOption3.getText().toString().trim() : &quot;&quot;;&#10;        String option4 = etOption4 != null ? etOption4.getText().toString().trim() : &quot;&quot;;&#10;&#10;        if (question.isEmpty() || option1.isEmpty() || option2.isEmpty()) {&#10;            Toast.makeText(this, &quot;Vui lòng nhập câu hỏi và ít nhất 2 đáp án&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        int correctAnswer = 0;&#10;        if (rgCorrectAnswer != null &amp;&amp; rgCorrectAnswer.getCheckedRadioButtonId() != -1) {&#10;            RadioButton selectedButton = findViewById(rgCorrectAnswer.getCheckedRadioButtonId());&#10;            // Logic to determine correct answer index&#10;        }&#10;&#10;        // Add question to list (implementation would involve adapter)&#10;        Toast.makeText(this, &quot;Câu hỏi đã được thêm&quot;, Toast.LENGTH_SHORT).show();&#10;        clearQuestionForm();&#10;    }&#10;&#10;    private void saveQuiz() {&#10;        // Implementation similar to saveLesson&#10;        Toast.makeText(this, &quot;Quiz đã được lưu&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    private void previewQuiz() {&#10;        Intent intent = new Intent(this, QuizActivity.class);&#10;        intent.putExtra(&quot;mode&quot;, &quot;preview&quot;);&#10;        startActivity(intent);&#10;    }&#10;&#10;    private void addWord() {&#10;        String word = etWord != null ? etWord.getText().toString().trim() : &quot;&quot;;&#10;        String meaning = etMeaning != null ? etMeaning.getText().toString().trim() : &quot;&quot;;&#10;        String example = etExample != null ? etExample.getText().toString().trim() : &quot;&quot;;&#10;&#10;        if (word.isEmpty() || meaning.isEmpty()) {&#10;            Toast.makeText(this, &quot;Vui lòng nhập từ và nghĩa&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        // Add word to vocabulary list&#10;        Toast.makeText(this, &quot;Từ vựng đã được thêm&quot;, Toast.LENGTH_SHORT).show();&#10;        clearVocabularyForm();&#10;    }&#10;&#10;    private void saveVocabularyList() {&#10;        Toast.makeText(this, &quot;Danh sách từ vựng đã được lưu&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    private void publishContent() {&#10;        android.app.AlertDialog.Builder builder = new android.app.AlertDialog.Builder(this);&#10;        builder.setTitle(&quot;Xuất bản nội dung&quot;)&#10;                .setMessage(&quot;Bạn có chắc chắn muốn xuất bản nội dung này? Học viên sẽ có thể truy cập.&quot;)&#10;                .setPositiveButton(&quot;Xuất bản&quot;, (dialog, which) -&gt; {&#10;                    Toast.makeText(this, &quot;Nội dung đã được xuất bản!&quot;, Toast.LENGTH_SHORT).show();&#10;                })&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#10;                .show();&#10;    }&#10;&#10;    private void clearLessonForm() {&#10;        if (etLessonTitle != null) etLessonTitle.setText(&quot;&quot;);&#10;        if (etLessonDescription != null) etLessonDescription.setText(&quot;&quot;);&#10;        if (etLessonContent != null) etLessonContent.setText(&quot;&quot;);&#10;    }&#10;&#10;    private void clearQuestionForm() {&#10;        if (etQuestion != null) etQuestion.setText(&quot;&quot;);&#10;        if (etOption1 != null) etOption1.setText(&quot;&quot;);&#10;        if (etOption2 != null) etOption2.setText(&quot;&quot;);&#10;        if (etOption3 != null) etOption3.setText(&quot;&quot;);&#10;        if (etOption4 != null) etOption4.setText(&quot;&quot;);&#10;        if (rgCorrectAnswer != null) rgCorrectAnswer.clearCheck();&#10;    }&#10;&#10;    private void clearVocabularyForm() {&#10;        if (etWord != null) etWord.setText(&quot;&quot;);&#10;        if (etMeaning != null) etMeaning.setText(&quot;&quot;);&#10;        if (etExample != null) etExample.setText(&quot;&quot;);&#10;        if (etPronunciation != null) etPronunciation.setText(&quot;&quot;);&#10;    }&#10;&#10;    private void loadExistingContent() {&#10;        updateContentCount();&#10;    }&#10;&#10;    private void updateContentCount() {&#10;        if (teacherId != null) {&#10;            db.collection(&quot;content&quot;)&#10;                    .whereEqualTo(&quot;teacherId&quot;, teacherId)&#10;                    .get()&#10;                    .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                        int count = queryDocumentSnapshots.size();&#10;                        if (tvContentCount != null) {&#10;                            tvContentCount.setText(&quot;Đã tạo: &quot; + count + &quot; nội dung&quot;);&#10;                        }&#10;                    });&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            onBackPressed();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    @Override&#10;    public void onBackPressed() {&#10;        Intent intent = new Intent(this, TeacherDashboardActivity.class);&#10;        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);&#10;        startActivity(intent);&#10;        finish();&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#13;&#10;&#13;&#10;import android.content.Intent;&#13;&#10;import android.os.Bundle;&#13;&#10;import android.view.MenuItem;&#13;&#10;import android.view.View;&#13;&#10;import android.widget.Button;&#13;&#10;import android.widget.EditText;&#13;&#10;import android.widget.LinearLayout;&#13;&#10;import android.widget.RadioButton;&#13;&#10;import android.widget.RadioGroup;&#13;&#10;import android.widget.Spinner;&#13;&#10;import android.widget.TextView;&#13;&#10;import android.widget.Toast;&#13;&#10;import androidx.appcompat.widget.Toolbar;&#13;&#10;import androidx.cardview.widget.CardView;&#13;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#13;&#10;import androidx.recyclerview.widget.RecyclerView;&#13;&#10;&#13;&#10;import androidx.appcompat.app.AppCompatActivity;&#13;&#10;import com.google.android.material.floatingactionbutton.FloatingActionButton;&#13;&#10;import com.google.android.material.tabs.TabLayout;&#13;&#10;import com.google.firebase.auth.FirebaseAuth;&#13;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#13;&#10;&#13;&#10;import java.util.HashMap;&#13;&#10;import java.util.Map;&#13;&#10;&#13;&#10;public class ContentCreationActivity extends AppCompatActivity {&#13;&#10;&#13;&#10;    private Toolbar toolbar;&#13;&#10;    private TabLayout tabLayout;&#13;&#10;    private CardView cardLessonCreation, cardQuizCreation, cardVocabularyList;&#13;&#10;    private LinearLayout layoutLessonForm, layoutQuizForm, layoutVocabularyForm;&#13;&#10;&#13;&#10;    // Lesson creation components&#13;&#10;    private EditText etLessonTitle, etLessonDescription, etLessonContent;&#13;&#10;    private Spinner spinnerLessonCategory, spinnerDifficulty;&#13;&#10;    private Button btnSaveLesson, btnPreviewLesson;&#13;&#10;&#13;&#10;    // Quiz creation components&#13;&#10;    private EditText etQuizTitle, etQuizDescription;&#13;&#10;    private EditText etQuestion, etOption1, etOption2, etOption3, etOption4;&#13;&#10;    private RadioGroup rgCorrectAnswer;&#13;&#10;    private RecyclerView rvQuestions;&#13;&#10;    private Button btnAddQuestion, btnSaveQuiz, btnPreviewQuiz;&#13;&#10;&#13;&#10;    // Vocabulary components&#13;&#10;    private EditText etWord, etMeaning, etExample, etPronunciation;&#13;&#10;    private Spinner spinnerWordCategory;&#13;&#10;    private Button btnAddWord, btnSaveVocabulary;&#13;&#10;    private RecyclerView rvVocabularyList;&#13;&#10;&#13;&#10;    private FloatingActionButton fabPublish;&#13;&#10;    private TextView tvContentCount;&#13;&#10;&#13;&#10;    private FirebaseAuth mAuth;&#13;&#10;    private FirebaseFirestore db;&#13;&#10;    private String mode; // &quot;lesson&quot;, &quot;quiz&quot;, &quot;vocabulary&quot;&#13;&#10;    private String teacherId;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onCreate(Bundle savedInstanceState) {&#13;&#10;        super.onCreate(savedInstanceState);&#13;&#10;        setContentView(R.layout.activity_content_creation);&#13;&#10;&#13;&#10;        // Get mode from intent&#13;&#10;        mode = getIntent().getStringExtra(&quot;mode&quot;);&#13;&#10;&#13;&#10;        mAuth = FirebaseAuth.getInstance();&#13;&#10;        db = FirebaseFirestore.getInstance();&#13;&#10;&#13;&#10;        if (mAuth.getCurrentUser() != null) {&#13;&#10;            teacherId = mAuth.getCurrentUser().getUid();&#13;&#10;        }&#13;&#10;&#13;&#10;        initViews();&#13;&#10;        setupToolbar();&#13;&#10;        setupTabs();&#13;&#10;        setupClickListeners();&#13;&#10;        handleModeSpecificSetup();&#13;&#10;        loadExistingContent();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void initViews() {&#13;&#10;        toolbar = findViewById(R.id.toolbar);&#13;&#10;        tabLayout = findViewById(R.id.tab_layout);&#13;&#10;&#13;&#10;        // Cards&#13;&#10;        cardLessonCreation = findViewById(R.id.card_lesson_creation);&#13;&#10;        cardQuizCreation = findViewById(R.id.card_quiz_creation);&#13;&#10;        cardVocabularyList = findViewById(R.id.card_vocabulary_list);&#13;&#10;&#13;&#10;        // Layouts&#13;&#10;        layoutLessonForm = findViewById(R.id.layout_lesson_form);&#13;&#10;        layoutQuizForm = findViewById(R.id.layout_quiz_form);&#13;&#10;        layoutVocabularyForm = findViewById(R.id.layout_vocabulary_form);&#13;&#10;&#13;&#10;        // Lesson creation&#13;&#10;        etLessonTitle = findViewById(R.id.et_lesson_title);&#13;&#10;        etLessonDescription = findViewById(R.id.et_lesson_description);&#13;&#10;        etLessonContent = findViewById(R.id.et_lesson_content);&#13;&#10;        spinnerLessonCategory = findViewById(R.id.spinner_lesson_category);&#13;&#10;        spinnerDifficulty = findViewById(R.id.spinner_difficulty);&#13;&#10;        btnSaveLesson = findViewById(R.id.btn_save_lesson);&#13;&#10;        btnPreviewLesson = findViewById(R.id.btn_preview_lesson);&#13;&#10;&#13;&#10;        // Quiz creation&#13;&#10;        etQuizTitle = findViewById(R.id.et_quiz_title);&#13;&#10;        etQuizDescription = findViewById(R.id.et_quiz_description);&#13;&#10;        etQuestion = findViewById(R.id.et_question);&#13;&#10;        etOption1 = findViewById(R.id.et_option1);&#13;&#10;        etOption2 = findViewById(R.id.et_option2);&#13;&#10;        etOption3 = findViewById(R.id.et_option3);&#13;&#10;        etOption4 = findViewById(R.id.et_option4);&#13;&#10;        rgCorrectAnswer = findViewById(R.id.rg_correct_answer);&#13;&#10;        rvQuestions = findViewById(R.id.rv_questions);&#13;&#10;        btnAddQuestion = findViewById(R.id.btn_add_question);&#13;&#10;        btnSaveQuiz = findViewById(R.id.btn_save_quiz);&#13;&#10;        btnPreviewQuiz = findViewById(R.id.btn_preview_quiz);&#13;&#10;&#13;&#10;        // Vocabulary&#13;&#10;        etWord = findViewById(R.id.et_word);&#13;&#10;        etMeaning = findViewById(R.id.et_meaning);&#13;&#10;        etExample = findViewById(R.id.et_example);&#13;&#10;        etPronunciation = findViewById(R.id.et_pronunciation);&#13;&#10;        spinnerWordCategory = findViewById(R.id.spinner_word_category);&#13;&#10;        btnAddWord = findViewById(R.id.btn_add_word);&#13;&#10;        btnSaveVocabulary = findViewById(R.id.btn_save_vocabulary);&#13;&#10;        rvVocabularyList = findViewById(R.id.rv_vocabulary_list);&#13;&#10;&#13;&#10;        // Other components&#13;&#10;        fabPublish = findViewById(R.id.fab_publish);&#13;&#10;        tvContentCount = findViewById(R.id.tv_content_count);&#13;&#10;&#13;&#10;        // Setup RecyclerViews&#13;&#10;        if (rvQuestions != null) {&#13;&#10;            rvQuestions.setLayoutManager(new LinearLayoutManager(this));&#13;&#10;        }&#13;&#10;        if (rvVocabularyList != null) {&#13;&#10;            rvVocabularyList.setLayoutManager(new LinearLayoutManager(this));&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupToolbar() {&#13;&#10;        setSupportActionBar(toolbar);&#13;&#10;        if (getSupportActionBar() != null) {&#13;&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#13;&#10;            getSupportActionBar().setDisplayShowHomeEnabled(true);&#13;&#10;            getSupportActionBar().setTitle(&quot;Tạo nội dung&quot;);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupTabs() {&#13;&#10;        if (tabLayout != null) {&#13;&#10;            tabLayout.addTab(tabLayout.newTab().setText(&quot;Bài học&quot;));&#13;&#10;            tabLayout.addTab(tabLayout.newTab().setText(&quot;Quiz&quot;));&#13;&#10;            tabLayout.addTab(tabLayout.newTab().setText(&quot;Từ vựng&quot;));&#13;&#10;&#13;&#10;            tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {&#13;&#10;                @Override&#13;&#10;                public void onTabSelected(TabLayout.Tab tab) {&#13;&#10;                    switchContentType(tab.getPosition());&#13;&#10;                }&#13;&#10;&#13;&#10;                @Override&#13;&#10;                public void onTabUnselected(TabLayout.Tab tab) {}&#13;&#10;&#13;&#10;                @Override&#13;&#10;                public void onTabReselected(TabLayout.Tab tab) {}&#13;&#10;            });&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupClickListeners() {&#13;&#10;        // Lesson creation&#13;&#10;        if (btnSaveLesson != null) {&#13;&#10;            btnSaveLesson.setOnClickListener(v -&gt; saveLesson());&#13;&#10;        }&#13;&#10;        if (btnPreviewLesson != null) {&#13;&#10;            btnPreviewLesson.setOnClickListener(v -&gt; previewLesson());&#13;&#10;        }&#13;&#10;&#13;&#10;        // Quiz creation&#13;&#10;        if (btnAddQuestion != null) {&#13;&#10;            btnAddQuestion.setOnClickListener(v -&gt; addQuestion());&#13;&#10;        }&#13;&#10;        if (btnSaveQuiz != null) {&#13;&#10;            btnSaveQuiz.setOnClickListener(v -&gt; saveQuiz());&#13;&#10;        }&#13;&#10;        if (btnPreviewQuiz != null) {&#13;&#10;            btnPreviewQuiz.setOnClickListener(v -&gt; previewQuiz());&#13;&#10;        }&#13;&#10;&#13;&#10;        // Vocabulary&#13;&#10;        if (btnAddWord != null) {&#13;&#10;            btnAddWord.setOnClickListener(v -&gt; addWord());&#13;&#10;        }&#13;&#10;        if (btnSaveVocabulary != null) {&#13;&#10;            btnSaveVocabulary.setOnClickListener(v -&gt; saveVocabularyList());&#13;&#10;        }&#13;&#10;&#13;&#10;        // FAB&#13;&#10;        if (fabPublish != null) {&#13;&#10;            fabPublish.setOnClickListener(v -&gt; publishContent());&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void handleModeSpecificSetup() {&#13;&#10;        if (&quot;lesson&quot;.equals(mode) &amp;&amp; tabLayout != null) {&#13;&#10;            tabLayout.getTabAt(0).select();&#13;&#10;            switchContentType(0);&#13;&#10;        } else if (&quot;quiz&quot;.equals(mode) &amp;&amp; tabLayout != null) {&#13;&#10;            tabLayout.getTabAt(1).select();&#13;&#10;            switchContentType(1);&#13;&#10;        } else if (&quot;vocabulary&quot;.equals(mode) &amp;&amp; tabLayout != null) {&#13;&#10;            tabLayout.getTabAt(2).select();&#13;&#10;            switchContentType(2);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void switchContentType(int position) {&#13;&#10;        // Hide all layouts first&#13;&#10;        hideAllLayouts();&#13;&#10;&#13;&#10;        switch (position) {&#13;&#10;            case 0: // Lesson&#13;&#10;                if (layoutLessonForm != null) {&#13;&#10;                    layoutLessonForm.setVisibility(View.VISIBLE);&#13;&#10;                }&#13;&#10;                break;&#13;&#10;            case 1: // Quiz&#13;&#10;                if (layoutQuizForm != null) {&#13;&#10;                    layoutQuizForm.setVisibility(View.VISIBLE);&#13;&#10;                }&#13;&#10;                break;&#13;&#10;            case 2: // Vocabulary&#13;&#10;                if (layoutVocabularyForm != null) {&#13;&#10;                    layoutVocabularyForm.setVisibility(View.VISIBLE);&#13;&#10;                }&#13;&#10;                break;&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void hideAllLayouts() {&#13;&#10;        if (layoutLessonForm != null) layoutLessonForm.setVisibility(View.GONE);&#13;&#10;        if (layoutQuizForm != null) layoutQuizForm.setVisibility(View.GONE);&#13;&#10;        if (layoutVocabularyForm != null) layoutVocabularyForm.setVisibility(View.GONE);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void saveLesson() {&#13;&#10;        if (teacherId == null) {&#13;&#10;            Toast.makeText(this, &quot;Lỗi: Không thể xác định giáo viên&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        String title = etLessonTitle != null ? etLessonTitle.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String description = etLessonDescription != null ? etLessonDescription.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String content = etLessonContent != null ? etLessonContent.getText().toString().trim() : &quot;&quot;;&#13;&#10;&#13;&#10;        if (title.isEmpty() || content.isEmpty()) {&#13;&#10;            Toast.makeText(this, &quot;Vui lòng nhập đầy đủ tiêu đề và nội dung&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        Map&lt;String, Object&gt; lessonData = new HashMap&lt;&gt;();&#13;&#10;        lessonData.put(&quot;teacherId&quot;, teacherId);&#13;&#10;        lessonData.put(&quot;title&quot;, title);&#13;&#10;        lessonData.put(&quot;description&quot;, description);&#13;&#10;        lessonData.put(&quot;content&quot;, content);&#13;&#10;        lessonData.put(&quot;type&quot;, &quot;lesson&quot;);&#13;&#10;        lessonData.put(&quot;createdAt&quot;, System.currentTimeMillis());&#13;&#10;        lessonData.put(&quot;status&quot;, &quot;draft&quot;);&#13;&#10;&#13;&#10;        db.collection(&quot;content&quot;)&#13;&#10;                .add(lessonData)&#13;&#10;                .addOnSuccessListener(documentReference -&gt; {&#13;&#10;                    Toast.makeText(this, &quot;Bài học đã được lưu thành công!&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                    clearLessonForm();&#13;&#10;                    updateContentCount();&#13;&#10;                })&#13;&#10;                .addOnFailureListener(e -&gt; {&#13;&#10;                    Toast.makeText(this, &quot;Lỗi khi lưu: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#13;&#10;                });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void previewLesson() {&#13;&#10;        Intent intent = new Intent(this, CourseListActivity.class);&#13;&#10;        intent.putExtra(&quot;mode&quot;, &quot;preview&quot;);&#13;&#10;        intent.putExtra(&quot;title&quot;, etLessonTitle != null ? etLessonTitle.getText().toString() : &quot;&quot;);&#13;&#10;        startActivity(intent);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addQuestion() {&#13;&#10;        String question = etQuestion != null ? etQuestion.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String option1 = etOption1 != null ? etOption1.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String option2 = etOption2 != null ? etOption2.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String option3 = etOption3 != null ? etOption3.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String option4 = etOption4 != null ? etOption4.getText().toString().trim() : &quot;&quot;;&#13;&#10;&#13;&#10;        if (question.isEmpty() || option1.isEmpty() || option2.isEmpty()) {&#13;&#10;            Toast.makeText(this, &quot;Vui lòng nhập câu hỏi và ít nhất 2 đáp án&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        int correctAnswer = 0;&#13;&#10;        if (rgCorrectAnswer != null &amp;&amp; rgCorrectAnswer.getCheckedRadioButtonId() != -1) {&#13;&#10;            RadioButton selectedButton = findViewById(rgCorrectAnswer.getCheckedRadioButtonId());&#13;&#10;            // Logic to determine correct answer index&#13;&#10;        }&#13;&#10;&#13;&#10;        // Add question to list (implementation would involve adapter)&#13;&#10;        Toast.makeText(this, &quot;Câu hỏi đã được thêm&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;        clearQuestionForm();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void saveQuiz() {&#13;&#10;        // Implementation similar to saveLesson&#13;&#10;        Toast.makeText(this, &quot;Quiz đã được lưu&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void previewQuiz() {&#13;&#10;        Intent intent = new Intent(this, QuizActivity.class);&#13;&#10;        intent.putExtra(&quot;mode&quot;, &quot;preview&quot;);&#13;&#10;        startActivity(intent);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addWord() {&#13;&#10;        String word = etWord != null ? etWord.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String meaning = etMeaning != null ? etMeaning.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String example = etExample != null ? etExample.getText().toString().trim() : &quot;&quot;;&#13;&#10;&#13;&#10;        if (word.isEmpty() || meaning.isEmpty()) {&#13;&#10;            Toast.makeText(this, &quot;Vui lòng nhập từ và nghĩa&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Add word to vocabulary list&#13;&#10;        Toast.makeText(this, &quot;Từ vựng đã được thêm&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;        clearVocabularyForm();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void saveVocabularyList() {&#13;&#10;        Toast.makeText(this, &quot;Danh sách từ vựng đã được lưu&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void publishContent() {&#13;&#10;        android.app.AlertDialog.Builder builder = new android.app.AlertDialog.Builder(this);&#13;&#10;        builder.setTitle(&quot;Xuất bản nội dung&quot;)&#13;&#10;                .setMessage(&quot;Bạn có chắc chắn muốn xuất bản nội dung này? Học viên sẽ có thể truy cập.&quot;)&#13;&#10;                .setPositiveButton(&quot;Xuất bản&quot;, (dialog, which) -&gt; {&#13;&#10;                    Toast.makeText(this, &quot;Nội dung đã được xuất bản!&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                })&#13;&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#13;&#10;                .show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void clearLessonForm() {&#13;&#10;        if (etLessonTitle != null) etLessonTitle.setText(&quot;&quot;);&#13;&#10;        if (etLessonDescription != null) etLessonDescription.setText(&quot;&quot;);&#13;&#10;        if (etLessonContent != null) etLessonContent.setText(&quot;&quot;);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void clearQuestionForm() {&#13;&#10;        if (etQuestion != null) etQuestion.setText(&quot;&quot;);&#13;&#10;        if (etOption1 != null) etOption1.setText(&quot;&quot;);&#13;&#10;        if (etOption2 != null) etOption2.setText(&quot;&quot;);&#13;&#10;        if (etOption3 != null) etOption3.setText(&quot;&quot;);&#13;&#10;        if (etOption4 != null) etOption4.setText(&quot;&quot;);&#13;&#10;        if (rgCorrectAnswer != null) rgCorrectAnswer.clearCheck();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void clearVocabularyForm() {&#13;&#10;        if (etWord != null) etWord.setText(&quot;&quot;);&#13;&#10;        if (etMeaning != null) etMeaning.setText(&quot;&quot;);&#13;&#10;        if (etExample != null) etExample.setText(&quot;&quot;);&#13;&#10;        if (etPronunciation != null) etPronunciation.setText(&quot;&quot;);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void loadExistingContent() {&#13;&#10;        updateContentCount();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void updateContentCount() {&#13;&#10;        if (teacherId != null) {&#13;&#10;            db.collection(&quot;content&quot;)&#13;&#10;                    .whereEqualTo(&quot;teacherId&quot;, teacherId)&#13;&#10;                    .get()&#13;&#10;                    .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#13;&#10;                        int count = queryDocumentSnapshots.size();&#13;&#10;                        if (tvContentCount != null) {&#13;&#10;                            tvContentCount.setText(&quot;Đã tạo: &quot; + count + &quot; nội dung&quot;);&#13;&#10;                        }&#13;&#10;                    });&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean onOptionsItemSelected(MenuItem item) {&#13;&#10;        if (item.getItemId() == android.R.id.home) {&#13;&#10;            onBackPressed();&#13;&#10;            return true;&#13;&#10;        }&#13;&#10;        return super.onOptionsItemSelected(item);&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public void onBackPressed() {&#13;&#10;        super.onBackPressed();&#13;&#10;        Intent intent = new Intent(this, TeacherDashboardActivity.class);&#13;&#10;        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);&#13;&#10;        startActivity(intent);&#13;&#10;        finish();&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/CreateLessonActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/CreateLessonActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.os.Bundle;&#10;import android.text.TextUtils;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.ArrayAdapter;&#10;import android.widget.Button;&#10;import android.widget.LinearLayout;&#10;import android.widget.Spinner;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.HashMap;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;public class CreateLessonActivity extends AppCompatActivity {&#10;&#10;    private TextInputEditText etLessonTitle, etLessonContent, etEstimatedTime;&#10;    private Spinner spinnerLessonType;&#10;    private Button btnCreateLesson, btnAddExample, btnAddUsage, btnAddNote;&#10;    private Toolbar toolbar;&#10;&#10;    // Grammar-specific fields&#10;    private LinearLayout layoutGrammarContent;&#10;    private TextInputEditText etGrammarRule, etGrammarStructure;&#10;    private LinearLayout layoutExamples, layoutUsage, layoutNotes;&#10;    private List&lt;TextInputEditText&gt; exampleInputs, usageInputs, noteInputs;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String courseId, courseTitle, courseCategory;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_create_lesson);&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupSpinners();&#10;        setupClickListeners();&#10;        loadCourseCategory();&#10;        addAnimations();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        etLessonTitle = findViewById(R.id.et_lesson_title);&#10;        etLessonContent = findViewById(R.id.et_lesson_content);&#10;        etEstimatedTime = findViewById(R.id.et_estimated_time);&#10;        spinnerLessonType = findViewById(R.id.spinner_lesson_type);&#10;        btnCreateLesson = findViewById(R.id.btn_create_lesson);&#10;&#10;        // Grammar-specific views - Kích hoạt lại các view&#10;        layoutGrammarContent = findViewById(R.id.layout_grammar_content);&#10;        etGrammarRule = findViewById(R.id.et_grammar_rule);&#10;        etGrammarStructure = findViewById(R.id.et_grammar_structure);&#10;        layoutExamples = findViewById(R.id.layout_examples);&#10;        layoutUsage = findViewById(R.id.layout_usage);&#10;        layoutNotes = findViewById(R.id.layout_notes);&#10;        btnAddExample = findViewById(R.id.btn_add_example);&#10;        btnAddUsage = findViewById(R.id.btn_add_usage);&#10;        btnAddNote = findViewById(R.id.btn_add_note);&#10;&#10;        // Initialize lists&#10;        exampleInputs = new ArrayList&lt;&gt;();&#10;        usageInputs = new ArrayList&lt;&gt;();&#10;        noteInputs = new ArrayList&lt;&gt;();&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Tạo bài học mới&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupSpinners() {&#10;        String[] lessonTypes = {&quot;text&quot;, &quot;video&quot;, &quot;audio&quot;, &quot;quiz&quot;};&#10;        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, lessonTypes);&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerLessonType.setAdapter(adapter);&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnCreateLesson.setOnClickListener(v -&gt; createLesson());&#10;        btnAddExample.setOnClickListener(v -&gt; addExampleField());&#10;        btnAddUsage.setOnClickListener(v -&gt; addUsageField());&#10;        btnAddNote.setOnClickListener(v -&gt; addNoteField());&#10;    }&#10;&#10;    private void loadCourseCategory() {&#10;        if (courseId == null) return;&#10;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;            .get()&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#10;                if (documentSnapshot.exists()) {&#10;                    courseCategory = documentSnapshot.getString(&quot;category&quot;);&#10;                    android.util.Log.d(&quot;CreateLesson&quot;, &quot;Course category: &quot; + courseCategory);&#10;&#10;                    // Show/hide grammar-specific fields based on category&#10;                    if (&quot;Grammar&quot;.equalsIgnoreCase(courseCategory)) {&#10;                        layoutGrammarContent.setVisibility(View.VISIBLE);&#10;                        addInitialFields();&#10;                    } else {&#10;                        layoutGrammarContent.setVisibility(View.GONE);&#10;                    }&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;CreateLesson&quot;, &quot;Error loading course category&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            });&#10;    }&#10;&#10;    private void addInitialFields() {&#10;        // Add initial example, usage, and note fields for Grammar lessons&#10;        addExampleField();&#10;        addUsageField();&#10;        addNoteField();&#10;    }&#10;&#10;    private void addExampleField() {&#10;        TextInputEditText etExample = new TextInputEditText(this);&#10;        etExample.setHint(&quot;Ví dụ &quot; + (exampleInputs.size() + 1));&#10;        etExample.setLayoutParams(new LinearLayout.LayoutParams(&#10;            LinearLayout.LayoutParams.MATCH_PARENT,&#10;            LinearLayout.LayoutParams.WRAP_CONTENT));&#10;        etExample.setPadding(0, 8, 0, 8);&#10;&#10;        layoutExamples.addView(etExample);&#10;        exampleInputs.add(etExample);&#10;    }&#10;&#10;    private void addUsageField() {&#10;        TextInputEditText etUsage = new TextInputEditText(this);&#10;        etUsage.setHint(&quot;Cách sử dụng &quot; + (usageInputs.size() + 1));&#10;        etUsage.setLayoutParams(new LinearLayout.LayoutParams(&#10;            LinearLayout.LayoutParams.MATCH_PARENT,&#10;            LinearLayout.LayoutParams.WRAP_CONTENT));&#10;        etUsage.setPadding(0, 8, 0, 8);&#10;&#10;        layoutUsage.addView(etUsage);&#10;        usageInputs.add(etUsage);&#10;    }&#10;&#10;    private void addNoteField() {&#10;        TextInputEditText etNote = new TextInputEditText(this);&#10;        etNote.setHint(&quot;Ghi chú &quot; + (noteInputs.size() + 1));&#10;        etNote.setLayoutParams(new LinearLayout.LayoutParams(&#10;            LinearLayout.LayoutParams.MATCH_PARENT,&#10;            LinearLayout.LayoutParams.WRAP_CONTENT));&#10;        etNote.setPadding(0, 8, 0, 8);&#10;&#10;        layoutNotes.addView(etNote);&#10;        noteInputs.add(etNote);&#10;    }&#10;&#10;    private void addAnimations() {&#10;        // Add fade-in animation - Comment out vì không có main_content ID&#10;        // findViewById(R.id.main_content).setAlpha(0f);&#10;        // findViewById(R.id.main_content).animate()&#10;        //     .alpha(1f)&#10;        //     .setDuration(500)&#10;        //     .start();&#10;    }&#10;&#10;    private void createLesson() {&#10;        String title = etLessonTitle.getText().toString().trim();&#10;        String content = etLessonContent.getText().toString().trim();&#10;        String estimatedTimeStr = etEstimatedTime.getText().toString().trim();&#10;        String lessonType = spinnerLessonType.getSelectedItem().toString();&#10;&#10;        // Validation&#10;        if (TextUtils.isEmpty(title)) {&#10;            etLessonTitle.setError(&quot;Vui lòng nhập tiêu đề bài học&quot;);&#10;            return;&#10;        }&#10;&#10;        if (TextUtils.isEmpty(content)) {&#10;            etLessonContent.setError(&quot;Vui lòng nhập nội dung bài học&quot;);&#10;            return;&#10;        }&#10;&#10;        int estimatedTime = 30; // default&#10;        if (!TextUtils.isEmpty(estimatedTimeStr)) {&#10;            try {&#10;                estimatedTime = Integer.parseInt(estimatedTimeStr);&#10;            } catch (NumberFormatException e) {&#10;                etEstimatedTime.setError(&quot;Thời gian ước tính phải là số&quot;);&#10;                return;&#10;            }&#10;        }&#10;&#10;        // Create lesson object&#10;        Map&lt;String, Object&gt; lessonData = new HashMap&lt;&gt;();&#10;        lessonData.put(&quot;title&quot;, title);&#10;        lessonData.put(&quot;content&quot;, content);&#10;        lessonData.put(&quot;courseId&quot;, courseId);&#10;        lessonData.put(&quot;teacherId&quot;, mAuth.getCurrentUser().getUid());&#10;        lessonData.put(&quot;type&quot;, lessonType);&#10;        lessonData.put(&quot;category&quot;, courseCategory);&#10;        lessonData.put(&quot;estimatedTime&quot;, estimatedTime);&#10;        lessonData.put(&quot;createdAt&quot;, new Date());&#10;        lessonData.put(&quot;updatedAt&quot;, new Date());&#10;        lessonData.put(&quot;isPublished&quot;, false);&#10;&#10;        // Add grammar-specific data if this is a Grammar lesson&#10;        if (&quot;Grammar&quot;.equalsIgnoreCase(courseCategory)) {&#10;            addGrammarData(lessonData);&#10;        }&#10;&#10;        // Get next order number&#10;        getNextOrderNumber(lessonData);&#10;    }&#10;&#10;    private void addGrammarData(Map&lt;String, Object&gt; lessonData) {&#10;        String grammarRule = etGrammarRule.getText().toString().trim();&#10;        String grammarStructure = etGrammarStructure.getText().toString().trim();&#10;&#10;        if (!TextUtils.isEmpty(grammarRule)) {&#10;            lessonData.put(&quot;grammarRule&quot;, grammarRule);&#10;        }&#10;&#10;        if (!TextUtils.isEmpty(grammarStructure)) {&#10;            lessonData.put(&quot;grammarStructure&quot;, grammarStructure);&#10;        }&#10;&#10;        // Collect examples&#10;        List&lt;String&gt; examples = new ArrayList&lt;&gt;();&#10;        for (TextInputEditText etExample : exampleInputs) {&#10;            String example = etExample.getText().toString().trim();&#10;            if (!TextUtils.isEmpty(example)) {&#10;                examples.add(example);&#10;            }&#10;        }&#10;        if (!examples.isEmpty()) {&#10;            lessonData.put(&quot;grammarExamples&quot;, examples);&#10;        }&#10;&#10;        // Collect usage notes&#10;        List&lt;String&gt; usage = new ArrayList&lt;&gt;();&#10;        for (TextInputEditText etUsage : usageInputs) {&#10;            String usageNote = etUsage.getText().toString().trim();&#10;            if (!TextUtils.isEmpty(usageNote)) {&#10;                usage.add(usageNote);&#10;            }&#10;        }&#10;        if (!usage.isEmpty()) {&#10;            lessonData.put(&quot;grammarUsage&quot;, usage);&#10;        }&#10;&#10;        // Collect notes&#10;        List&lt;String&gt; notes = new ArrayList&lt;&gt;();&#10;        for (TextInputEditText etNote : noteInputs) {&#10;            String note = etNote.getText().toString().trim();&#10;            if (!TextUtils.isEmpty(note)) {&#10;                notes.add(note);&#10;            }&#10;        }&#10;        if (!notes.isEmpty()) {&#10;            lessonData.put(&quot;grammarNotes&quot;, notes);&#10;        }&#10;    }&#10;&#10;    private void getNextOrderNumber(Map&lt;String, Object&gt; lessonData) {&#10;        db.collection(&quot;lessons&quot;)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                int nextOrder = queryDocumentSnapshots.size() + 1;&#10;                lessonData.put(&quot;order&quot;, nextOrder);&#10;                saveLessonToFirebase(lessonData);&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                lessonData.put(&quot;order&quot;, 1);&#10;                saveLessonToFirebase(lessonData);&#10;            });&#10;    }&#10;&#10;    private void saveLessonToFirebase(Map&lt;String, Object&gt; lessonData) {&#10;        btnCreateLesson.setEnabled(false);&#10;        btnCreateLesson.setText(&quot;Đang tạo...&quot;);&#10;&#10;        db.collection(&quot;lessons&quot;)&#10;            .add(lessonData)&#10;            .addOnSuccessListener(documentReference -&gt; {&#10;                android.util.Log.d(&quot;CreateLesson&quot;, &quot;Lesson created with ID: &quot; + documentReference.getId());&#10;                Toast.makeText(this, &quot;Tạo bài học thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                finish();&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;CreateLesson&quot;, &quot;Error creating lesson&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tạo bài học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                btnCreateLesson.setEnabled(true);&#10;                btnCreateLesson.setText(&quot;Tạo bài học&quot;);&#10;            });&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#13;&#10;&#13;&#10;import android.os.Bundle;&#13;&#10;import android.text.TextUtils;&#13;&#10;import android.view.MenuItem;&#13;&#10;import android.view.View;&#13;&#10;import android.widget.ArrayAdapter;&#13;&#10;import android.widget.Button;&#13;&#10;import android.widget.LinearLayout;&#13;&#10;import android.widget.Spinner;&#13;&#10;import android.widget.TextView;&#13;&#10;import android.widget.Toast;&#13;&#10;import androidx.annotation.NonNull;&#13;&#10;import androidx.appcompat.app.AppCompatActivity;&#13;&#10;import androidx.appcompat.widget.Toolbar;&#13;&#10;import com.google.android.material.textfield.TextInputEditText;&#13;&#10;import com.google.firebase.auth.FirebaseAuth;&#13;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#13;&#10;import java.util.ArrayList;&#13;&#10;import java.util.Date;&#13;&#10;import java.util.HashMap;&#13;&#10;import java.util.List;&#13;&#10;import java.util.Map;&#13;&#10;&#13;&#10;public class CreateLessonActivity extends AppCompatActivity {&#13;&#10;&#13;&#10;    private TextInputEditText etLessonTitle, etLessonContent, etEstimatedTime;&#13;&#10;    private Spinner spinnerLessonType;&#13;&#10;    private Button btnCreateLesson, btnAddExample, btnAddUsage, btnAddNote;&#13;&#10;    private Toolbar toolbar;&#13;&#10;&#13;&#10;    // Grammar-specific fields&#13;&#10;    private LinearLayout layoutGrammarContent;&#13;&#10;    private TextInputEditText etGrammarRule, etGrammarStructure;&#13;&#10;    private LinearLayout layoutExamples, layoutUsage, layoutNotes;&#13;&#10;    private List&lt;TextInputEditText&gt; exampleInputs, usageInputs, noteInputs;&#13;&#10;&#13;&#10;    private FirebaseAuth mAuth;&#13;&#10;    private FirebaseFirestore db;&#13;&#10;    private String courseId, courseTitle, courseCategory;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onCreate(Bundle savedInstanceState) {&#13;&#10;        super.onCreate(savedInstanceState);&#13;&#10;        setContentView(R.layout.activity_create_lesson);&#13;&#10;&#13;&#10;        mAuth = FirebaseAuth.getInstance();&#13;&#10;        db = FirebaseFirestore.getInstance();&#13;&#10;&#13;&#10;        // Get course info from intent&#13;&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#13;&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#13;&#10;&#13;&#10;        initViews();&#13;&#10;        setupToolbar();&#13;&#10;        setupSpinners();&#13;&#10;        setupClickListeners();&#13;&#10;        loadCourseCategory();&#13;&#10;        addAnimations();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void initViews() {&#13;&#10;        toolbar = findViewById(R.id.toolbar);&#13;&#10;        etLessonTitle = findViewById(R.id.et_lesson_title);&#13;&#10;        etLessonContent = findViewById(R.id.et_lesson_content);&#13;&#10;        etEstimatedTime = findViewById(R.id.et_estimated_time);&#13;&#10;        spinnerLessonType = findViewById(R.id.spinner_lesson_type);&#13;&#10;        btnCreateLesson = findViewById(R.id.btn_create_lesson);&#13;&#10;&#13;&#10;        // Grammar-specific views - Kích hoạt lại các view&#13;&#10;        layoutGrammarContent = findViewById(R.id.layout_grammar_content);&#13;&#10;        etGrammarRule = findViewById(R.id.et_grammar_rule);&#13;&#10;        etGrammarStructure = findViewById(R.id.et_grammar_structure);&#13;&#10;        layoutExamples = findViewById(R.id.layout_examples);&#13;&#10;        layoutUsage = findViewById(R.id.layout_usage);&#13;&#10;        layoutNotes = findViewById(R.id.layout_notes);&#13;&#10;        btnAddExample = findViewById(R.id.btn_add_example);&#13;&#10;        btnAddUsage = findViewById(R.id.btn_add_usage);&#13;&#10;        btnAddNote = findViewById(R.id.btn_add_note);&#13;&#10;&#13;&#10;        // Initialize lists&#13;&#10;        exampleInputs = new ArrayList&lt;&gt;();&#13;&#10;        usageInputs = new ArrayList&lt;&gt;();&#13;&#10;        noteInputs = new ArrayList&lt;&gt;();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupToolbar() {&#13;&#10;        setSupportActionBar(toolbar);&#13;&#10;        if (getSupportActionBar() != null) {&#13;&#10;            getSupportActionBar().setTitle(&quot;Tạo bài học mới&quot;);&#13;&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupSpinners() {&#13;&#10;        String[] lessonTypes = {&quot;text&quot;, &quot;video&quot;, &quot;audio&quot;, &quot;quiz&quot;};&#13;&#10;        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;&gt;(this,&#13;&#10;            android.R.layout.simple_spinner_item, lessonTypes);&#13;&#10;        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#13;&#10;        spinnerLessonType.setAdapter(adapter);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupClickListeners() {&#13;&#10;        btnCreateLesson.setOnClickListener(v -&gt; createLesson());&#13;&#10;        btnAddExample.setOnClickListener(v -&gt; addExampleField());&#13;&#10;        btnAddUsage.setOnClickListener(v -&gt; addUsageField());&#13;&#10;        btnAddNote.setOnClickListener(v -&gt; addNoteField());&#13;&#10;    }&#13;&#10;&#13;&#10;    private void loadCourseCategory() {&#13;&#10;        if (courseId == null) return;&#13;&#10;&#13;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#13;&#10;            .get()&#13;&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#13;&#10;                if (documentSnapshot.exists()) {&#13;&#10;                    courseCategory = documentSnapshot.getString(&quot;category&quot;);&#13;&#10;                    android.util.Log.d(&quot;CreateLesson&quot;, &quot;Course category: &quot; + courseCategory);&#13;&#10;&#13;&#10;                    // Show/hide grammar-specific fields based on category&#13;&#10;                    if (&quot;Grammar&quot;.equalsIgnoreCase(courseCategory)) {&#13;&#10;                        layoutGrammarContent.setVisibility(View.VISIBLE);&#13;&#10;                        addInitialFields();&#13;&#10;                    } else {&#13;&#10;                        layoutGrammarContent.setVisibility(View.GONE);&#13;&#10;                    }&#13;&#10;                }&#13;&#10;            })&#13;&#10;            .addOnFailureListener(e -&gt; {&#13;&#10;                android.util.Log.e(&quot;CreateLesson&quot;, &quot;Error loading course category&quot;, e);&#13;&#10;                Toast.makeText(this, &quot;Lỗi tải thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addInitialFields() {&#13;&#10;        // Add initial example, usage, and note fields for Grammar lessons&#13;&#10;        addExampleField();&#13;&#10;        addUsageField();&#13;&#10;        addNoteField();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addExampleField() {&#13;&#10;        TextInputEditText etExample = new TextInputEditText(this);&#13;&#10;        etExample.setHint(&quot;Ví dụ &quot; + (exampleInputs.size() + 1));&#13;&#10;        etExample.setLayoutParams(new LinearLayout.LayoutParams(&#13;&#10;            LinearLayout.LayoutParams.MATCH_PARENT,&#13;&#10;            LinearLayout.LayoutParams.WRAP_CONTENT));&#13;&#10;        etExample.setPadding(0, 8, 0, 8);&#13;&#10;&#13;&#10;        layoutExamples.addView(etExample);&#13;&#10;        exampleInputs.add(etExample);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addUsageField() {&#13;&#10;        TextInputEditText etUsage = new TextInputEditText(this);&#13;&#10;        etUsage.setHint(&quot;Cách sử dụng &quot; + (usageInputs.size() + 1));&#13;&#10;        etUsage.setLayoutParams(new LinearLayout.LayoutParams(&#13;&#10;            LinearLayout.LayoutParams.MATCH_PARENT,&#13;&#10;            LinearLayout.LayoutParams.WRAP_CONTENT));&#13;&#10;        etUsage.setPadding(0, 8, 0, 8);&#13;&#10;&#13;&#10;        layoutUsage.addView(etUsage);&#13;&#10;        usageInputs.add(etUsage);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addNoteField() {&#13;&#10;        TextInputEditText etNote = new TextInputEditText(this);&#13;&#10;        etNote.setHint(&quot;Ghi chú &quot; + (noteInputs.size() + 1));&#13;&#10;        etNote.setLayoutParams(new LinearLayout.LayoutParams(&#13;&#10;            LinearLayout.LayoutParams.MATCH_PARENT,&#13;&#10;            LinearLayout.LayoutParams.WRAP_CONTENT));&#13;&#10;        etNote.setPadding(0, 8, 0, 8);&#13;&#10;&#13;&#10;        layoutNotes.addView(etNote);&#13;&#10;        noteInputs.add(etNote);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addAnimations() {&#13;&#10;        // Add fade-in animation - Comment out vì không có main_content ID&#13;&#10;        // findViewById(R.id.main_content).setAlpha(0f);&#13;&#10;        // findViewById(R.id.main_content).animate()&#13;&#10;        //     .alpha(1f)&#13;&#10;        //     .setDuration(500)&#13;&#10;        //     .start();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void createLesson() {&#13;&#10;        String title = etLessonTitle.getText().toString().trim();&#13;&#10;        String content = etLessonContent.getText().toString().trim();&#13;&#10;        String estimatedTimeStr = etEstimatedTime.getText().toString().trim();&#13;&#10;        String lessonType = spinnerLessonType.getSelectedItem().toString();&#13;&#10;&#13;&#10;        // Validation&#13;&#10;        if (TextUtils.isEmpty(title)) {&#13;&#10;            etLessonTitle.setError(&quot;Vui lòng nhập tiêu đề bài học&quot;);&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        if (TextUtils.isEmpty(content)) {&#13;&#10;            etLessonContent.setError(&quot;Vui lòng nhập nội dung bài học&quot;);&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        int estimatedTime = 30; // default&#13;&#10;        if (!TextUtils.isEmpty(estimatedTimeStr)) {&#13;&#10;            try {&#13;&#10;                estimatedTime = Integer.parseInt(estimatedTimeStr);&#13;&#10;            } catch (NumberFormatException e) {&#13;&#10;                etEstimatedTime.setError(&quot;Thời gian ước tính phải là số&quot;);&#13;&#10;                return;&#13;&#10;            }&#13;&#10;        }&#13;&#10;&#13;&#10;        // Create lesson object&#13;&#10;        Map&lt;String, Object&gt; lessonData = new HashMap&lt;&gt;();&#13;&#10;        lessonData.put(&quot;title&quot;, title);&#13;&#10;        lessonData.put(&quot;content&quot;, content);&#13;&#10;        lessonData.put(&quot;courseId&quot;, courseId);&#13;&#10;        lessonData.put(&quot;teacherId&quot;, mAuth.getCurrentUser().getUid());&#13;&#10;        lessonData.put(&quot;type&quot;, lessonType);&#13;&#10;        lessonData.put(&quot;category&quot;, courseCategory);&#13;&#10;        lessonData.put(&quot;estimatedTime&quot;, estimatedTime);&#13;&#10;        lessonData.put(&quot;createdAt&quot;, new Date());&#13;&#10;        lessonData.put(&quot;updatedAt&quot;, new Date());&#13;&#10;        lessonData.put(&quot;isPublished&quot;, true); // Changed from false to true - auto publish lessons&#13;&#10;&#13;&#10;        // Add grammar-specific data if this is a Grammar lesson&#13;&#10;        if (&quot;Grammar&quot;.equalsIgnoreCase(courseCategory)) {&#13;&#10;            addGrammarData(lessonData);&#13;&#10;        }&#13;&#10;&#13;&#10;        // Get next order number&#13;&#10;        getNextOrderNumber(lessonData);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void addGrammarData(Map&lt;String, Object&gt; lessonData) {&#13;&#10;        String grammarRule = etGrammarRule.getText().toString().trim();&#13;&#10;        String grammarStructure = etGrammarStructure.getText().toString().trim();&#13;&#10;&#13;&#10;        if (!TextUtils.isEmpty(grammarRule)) {&#13;&#10;            lessonData.put(&quot;grammarRule&quot;, grammarRule);&#13;&#10;        }&#13;&#10;&#13;&#10;        if (!TextUtils.isEmpty(grammarStructure)) {&#13;&#10;            lessonData.put(&quot;grammarStructure&quot;, grammarStructure);&#13;&#10;        }&#13;&#10;&#13;&#10;        // Collect examples&#13;&#10;        List&lt;String&gt; examples = new ArrayList&lt;&gt;();&#13;&#10;        for (TextInputEditText etExample : exampleInputs) {&#13;&#10;            String example = etExample.getText().toString().trim();&#13;&#10;            if (!TextUtils.isEmpty(example)) {&#13;&#10;                examples.add(example);&#13;&#10;            }&#13;&#10;        }&#13;&#10;        if (!examples.isEmpty()) {&#13;&#10;            lessonData.put(&quot;grammarExamples&quot;, examples);&#13;&#10;        }&#13;&#10;&#13;&#10;        // Collect usage notes&#13;&#10;        List&lt;String&gt; usage = new ArrayList&lt;&gt;();&#13;&#10;        for (TextInputEditText etUsage : usageInputs) {&#13;&#10;            String usageNote = etUsage.getText().toString().trim();&#13;&#10;            if (!TextUtils.isEmpty(usageNote)) {&#13;&#10;                usage.add(usageNote);&#13;&#10;            }&#13;&#10;        }&#13;&#10;        if (!usage.isEmpty()) {&#13;&#10;            lessonData.put(&quot;grammarUsage&quot;, usage);&#13;&#10;        }&#13;&#10;&#13;&#10;        // Collect notes&#13;&#10;        List&lt;String&gt; notes = new ArrayList&lt;&gt;();&#13;&#10;        for (TextInputEditText etNote : noteInputs) {&#13;&#10;            String note = etNote.getText().toString().trim();&#13;&#10;            if (!TextUtils.isEmpty(note)) {&#13;&#10;                notes.add(note);&#13;&#10;            }&#13;&#10;        }&#13;&#10;        if (!notes.isEmpty()) {&#13;&#10;            lessonData.put(&quot;grammarNotes&quot;, notes);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void getNextOrderNumber(Map&lt;String, Object&gt; lessonData) {&#13;&#10;        db.collection(&quot;lessons&quot;)&#13;&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#13;&#10;            .get()&#13;&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#13;&#10;                int nextOrder = queryDocumentSnapshots.size() + 1;&#13;&#10;                lessonData.put(&quot;order&quot;, nextOrder);&#13;&#10;                saveLessonToFirebase(lessonData);&#13;&#10;            })&#13;&#10;            .addOnFailureListener(e -&gt; {&#13;&#10;                lessonData.put(&quot;order&quot;, 1);&#13;&#10;                saveLessonToFirebase(lessonData);&#13;&#10;            });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void saveLessonToFirebase(Map&lt;String, Object&gt; lessonData) {&#13;&#10;        btnCreateLesson.setEnabled(false);&#13;&#10;        btnCreateLesson.setText(&quot;Đang tạo...&quot;);&#13;&#10;&#13;&#10;        db.collection(&quot;lessons&quot;)&#13;&#10;            .add(lessonData)&#13;&#10;            .addOnSuccessListener(documentReference -&gt; {&#13;&#10;                android.util.Log.d(&quot;CreateLesson&quot;, &quot;Lesson created with ID: &quot; + documentReference.getId());&#13;&#10;                Toast.makeText(this, &quot;Tạo bài học thành công!&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                finish();&#13;&#10;            })&#13;&#10;            .addOnFailureListener(e -&gt; {&#13;&#10;                android.util.Log.e(&quot;CreateLesson&quot;, &quot;Error creating lesson&quot;, e);&#13;&#10;                Toast.makeText(this, &quot;Lỗi tạo bài học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#13;&#10;                btnCreateLesson.setEnabled(true);&#13;&#10;                btnCreateLesson.setText(&quot;Tạo bài học&quot;);&#13;&#10;            });&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#13;&#10;        if (item.getItemId() == android.R.id.home) {&#13;&#10;            finish();&#13;&#10;            return true;&#13;&#10;        }&#13;&#10;        return super.onOptionsItemSelected(item);&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/CreateQuizActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/CreateQuizActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.RadioButton;&#10;import android.widget.RadioGroup;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import android.widget.LinearLayout;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.models.Quiz;&#10;import com.vantinh.tienganh.models.QuizQuestion;&#10;import com.vantinh.tienganh.models.TestQuestion;&#10;import com.vantinh.tienganh.models.SimpleTestQuestion;&#10;import com.vantinh.tienganh.utils.QuestionViewHelper;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;&#10;public class CreateQuizActivity extends AppCompatActivity implements QuestionViewHelper.OnQuestionCountChangeListener {&#10;&#10;    private Toolbar toolbar;&#10;    private EditText etQuizTitle;&#10;    private TextView tvCourseName, tvQuestionCount;&#10;    private Button btnCreateQuiz, btnAddQuestion, btnRemoveQuestion, btnDebugCreate;&#10;    private LinearLayout llQuestionsContainer;&#10;    private String courseId, courseName;&#10;    private FirebaseFirestore db;&#10;    private FirebaseAuth mAuth;&#10;&#10;    private QuestionViewHelper questionViewHelper;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_create_quiz);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        initFirebase();&#10;        getCourseInfo();&#10;        initQuestionHelper();&#10;        setupClickListeners();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        etQuizTitle = findViewById(R.id.et_quiz_title);&#10;        tvCourseName = findViewById(R.id.tv_course_name);&#10;        tvQuestionCount = findViewById(R.id.tv_question_count);&#10;        btnCreateQuiz = findViewById(R.id.btn_create_quiz);&#10;        btnAddQuestion = findViewById(R.id.btn_add_question);&#10;        btnRemoveQuestion = findViewById(R.id.btn_remove_question);&#10;        llQuestionsContainer = findViewById(R.id.ll_questions_container);&#10;        btnDebugCreate = findViewById(R.id.btn_debug_create);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Tạo bài kiểm tra&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void initFirebase() {&#10;        db = FirebaseFirestore.getInstance();&#10;        mAuth = FirebaseAuth.getInstance();&#10;    }&#10;&#10;    private void getCourseInfo() {&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseName = getIntent().getStringExtra(&quot;courseName&quot;);&#10;&#10;        if (courseName != null) {&#10;            tvCourseName.setText(&quot;Khóa học: &quot; + courseName);&#10;        }&#10;    }&#10;&#10;    private void initQuestionHelper() {&#10;        questionViewHelper = new QuestionViewHelper(this, llQuestionsContainer);&#10;        questionViewHelper.setOnQuestionCountChangeListener(this);&#10;        questionViewHelper.initializeWithDefaultQuestions();&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnCreateQuiz.setOnClickListener(v -&gt; createQuiz());&#10;&#10;        btnAddQuestion.setOnClickListener(v -&gt; {&#10;            questionViewHelper.addQuestion();&#10;            // Debug log&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Added question, total: &quot; + questionViewHelper.getQuestionCount());&#10;        });&#10;&#10;        btnRemoveQuestion.setOnClickListener(v -&gt; {&#10;            int countBefore = questionViewHelper.getQuestionCount();&#10;            questionViewHelper.removeLastQuestion();&#10;            int countAfter = questionViewHelper.getQuestionCount();&#10;            // Debug log&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Remove clicked - Before: &quot; + countBefore + &quot;, After: &quot; + countAfter);&#10;            Toast.makeText(this, &quot;Đã xóa câu hỏi cuối&quot;, Toast.LENGTH_SHORT).show();&#10;        });&#10;&#10;        btnDebugCreate.setOnClickListener(v -&gt; createDebugSampleData());&#10;    }&#10;&#10;    @Override&#10;    public void onQuestionCountChanged(int count) {&#10;        tvQuestionCount.setText(&quot;(&quot; + count + &quot; câu)&quot;);&#10;        boolean canRemove = count &gt; 2;&#10;        btnRemoveQuestion.setEnabled(canRemove);&#10;&#10;        // Debug log&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Question count changed: &quot; + count + &quot;, Can remove: &quot; + canRemove);&#10;&#10;        // Thay đổi màu nút để thể hiện trạng thái&#10;        if (canRemove) {&#10;            btnRemoveQuestion.setBackgroundTintList(getResources().getColorStateList(android.R.color.holo_red_dark));&#10;            btnRemoveQuestion.setAlpha(1.0f);&#10;        } else {&#10;            btnRemoveQuestion.setBackgroundTintList(getResources().getColorStateList(android.R.color.darker_gray));&#10;            btnRemoveQuestion.setAlpha(0.5f);&#10;        }&#10;    }&#10;&#10;    private void createQuiz() {&#10;        if (!validateInput()) {&#10;            return;&#10;        }&#10;&#10;        // Debug: Bắt đầu quá trình tạo bài kiểm tra&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;=== BẮT ĐẦU TẠO BÁI KIỂM TRA ===&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Course ID: &quot; + courseId);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Course Name: &quot; + courseName);&#10;&#10;        List&lt;SimpleTestQuestion&gt; simpleTestQuestions = new ArrayList&lt;&gt;();&#10;&#10;        // Tạo từng câu hỏi theo cấu trúc mới chỉ với 3 trường&#10;        List&lt;QuestionViewHelper.QuestionViewData&gt; questionViews = questionViewHelper.getQuestionViews();&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Số câu hỏi cần tạo: &quot; + questionViews.size());&#10;&#10;        for (int i = 0; i &lt; questionViews.size(); i++) {&#10;            QuestionViewHelper.QuestionViewData questionData = questionViews.get(i);&#10;&#10;            // 1. Lấy question (String) - nội dung câu hỏi&#10;            String questionText = questionData.etQuestion.getText().toString().trim();&#10;            &#10;            // 2. Lấy correctAnswer (Array) - 4 đáp án A,B,C,D&#10;            List&lt;String&gt; correctAnswerArray = new ArrayList&lt;&gt;();&#10;            for (int j = 0; j &lt; 4; j++) {&#10;                String optionText = questionData.etOptions[j].getText().toString().trim();&#10;                correctAnswerArray.add(optionText);&#10;                android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  Option &quot; + (char)('A' + j) + &quot;: &quot; + optionText);&#10;            }&#10;&#10;            // 3. Lấy options (Number) - index của đáp án đúng (0-3)&#10;            int correctAnswerIndex = getCorrectAnswerIndex(questionData);&#10;            &#10;            // Tạo SimpleTestQuestion chỉ với 4 trường dữ liệu (thêm courseId)&#10;            SimpleTestQuestion simpleQuestion = new SimpleTestQuestion();&#10;            simpleQuestion.setCourseId(courseId);              // String - ID khóa học (MỚI)&#10;            simpleQuestion.setCorrectAnswer(correctAnswerArray);     // Array - 4 đáp án&#10;            simpleQuestion.setOptions(correctAnswerIndex);           // Number - index đáp án đúng&#10;            simpleQuestion.setQuestion(questionText);                // String - câu hỏi&#10;&#10;            simpleTestQuestions.add(simpleQuestion);&#10;&#10;            // Debug log chi tiết cho từng câu hỏi với courseId&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;--- QUESTION &quot; + (i+1) + &quot; DEBUG ---&quot;);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;courseId (String): \&quot;&quot; + courseId + &quot;\&quot;&quot;);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;question (String): \&quot;&quot; + questionText + &quot;\&quot;&quot;);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;correctAnswer (Array): &quot; + correctAnswerArray.toString());&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;options (Number): &quot; + correctAnswerIndex);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Đáp án đúng là: &quot; +&#10;                (correctAnswerIndex &gt;= 0 &amp;&amp; correctAnswerIndex &lt; correctAnswerArray.size() ?&#10;                 correctAnswerArray.get(correctAnswerIndex) : &quot;KHÔNG XÁC ĐỊNH&quot;));&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;SimpleTestQuestion Object: &quot; + simpleQuestion.toString());&#10;        }&#10;&#10;        // Debug tổng kết trước khi lưu&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;=== TỔNG KẾT TRƯỚC KHI LƯU ===&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Tổng số câu hỏi: &quot; + simpleTestQuestions.size());&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Collection đích: test&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Cấu trúc mỗi document:&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  - correctAnswer: Array[4] (4 đáp án)&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  - options: Number (index đáp án đúng)&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  - question: String (câu hỏi)&quot;);&#10;&#10;        // Lưu từng câu hỏi như một document riêng trong collection &quot;test&quot;&#10;        saveSimpleTestQuestionsToFirebase(simpleTestQuestions);&#10;    }&#10;&#10;    private void createDebugSampleData() {&#10;        // Tạo dữ liệu mẫu để kiểm tra&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;=== TẠO DỮ LIỆU MẪU ===&quot;);&#10;&#10;        // Tạo một danh sách câu hỏi mẫu&#10;        List&lt;SimpleTestQuestion&gt; sampleQuestions = new ArrayList&lt;&gt;();&#10;&#10;        // Tạo 5 câu hỏi mẫu với đáp án ngẫu nhiên&#10;        for (int i = 1; i &lt;= 5; i++) {&#10;            SimpleTestQuestion question = new SimpleTestQuestion();&#10;            question.setQuestion(&quot;Câu hỏi mẫu &quot; + i);&#10;&#10;            List&lt;String&gt; answers = new ArrayList&lt;&gt;();&#10;            answers.add(&quot;Đáp án A - Câu hỏi &quot; + i);&#10;            answers.add(&quot;Đáp án B - Câu hỏi &quot; + i);&#10;            answers.add(&quot;Đáp án C - Câu hỏi &quot; + i);&#10;            answers.add(&quot;Đáp án D - Câu hỏi &quot; + i);&#10;            question.setCorrectAnswer(answers);&#10;&#10;            // Chọn ngẫu nhiên một đáp án đúng&#10;            int correctIndex = (int) (Math.random() * 4);&#10;            question.setOptions(correctIndex);&#10;&#10;            sampleQuestions.add(question);&#10;&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Câu hỏi mẫu &quot; + i + &quot;: &quot; + question.toString());&#10;        }&#10;&#10;        // Lưu vào Firebase&#10;        saveSimpleTestQuestionsToFirebase(sampleQuestions);&#10;    }&#10;&#10;    private boolean validateInput() {&#10;        // Bỏ validation tên bài kiểm tra vì không cần thiết với cấu trúc mới&#10;        List&lt;QuestionViewHelper.QuestionViewData&gt; questionViews = questionViewHelper.getQuestionViews();&#10;&#10;        for (int i = 0; i &lt; questionViews.size(); i++) {&#10;            QuestionViewHelper.QuestionViewData questionData = questionViews.get(i);&#10;&#10;            String questionText = questionData.etQuestion.getText().toString().trim();&#10;            if (questionText.isEmpty()) {&#10;                questionData.etQuestion.setError(&quot;Vui lòng nhập câu hỏi &quot; + (i + 1));&#10;                questionData.etQuestion.requestFocus();&#10;                return false;&#10;            }&#10;&#10;            for (int j = 0; j &lt; 4; j++) {&#10;                String option = questionData.etOptions[j].getText().toString().trim();&#10;                if (option.isEmpty()) {&#10;                    questionData.etOptions[j].setError(&quot;Vui lòng nhập lựa chọn &quot; + (char)('A' + j));&#10;                    questionData.etOptions[j].requestFocus();&#10;                    return false;&#10;                }&#10;            }&#10;&#10;            // Check if any radio button is selected for this question&#10;            if (questionData.rgCorrectAnswer.getCheckedRadioButtonId() == -1) {&#10;                Toast.makeText(this, &quot;Vui lòng chọn đáp án đúng cho câu hỏi &quot; + (i + 1), Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;    private int getCorrectAnswerIndex(QuestionViewHelper.QuestionViewData questionData) {&#10;        RadioGroup radioGroup = questionData.rgCorrectAnswer;&#10;        int checkedId = radioGroup.getCheckedRadioButtonId();&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Getting correct answer - checkedId: &quot; + checkedId);&#10;&#10;        if (checkedId == -1) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;No option selected&quot;);&#10;            return -1;&#10;        }&#10;&#10;        // Phương pháp đơn giản: Kiểm tra trực tiếp từng RadioButton theo ID gốc&#10;        RadioButton rbA = questionData.questionView.findViewById(R.id.rb_option_a);&#10;        RadioButton rbB = questionData.questionView.findViewById(R.id.rb_option_b);&#10;        RadioButton rbC = questionData.questionView.findViewById(R.id.rb_option_c);&#10;        RadioButton rbD = questionData.questionView.findViewById(R.id.rb_option_d);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;RadioButton states - A:&quot; + (rbA != null ? rbA.isChecked() : &quot;null&quot;) +&#10;                                        &quot;, B:&quot; + (rbB != null ? rbB.isChecked() : &quot;null&quot;) +&#10;                                        &quot;, C:&quot; + (rbC != null ? rbC.isChecked() : &quot;null&quot;) +&#10;                                        &quot;, D:&quot; + (rbD != null ? rbD.isChecked() : &quot;null&quot;));&#10;&#10;        if (rbA != null &amp;&amp; rbA.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option A selected (index 0)&quot;);&#10;            return 0;&#10;        }&#10;        if (rbB != null &amp;&amp; rbB.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option B selected (index 1)&quot;);&#10;            return 1;&#10;        }&#10;        if (rbC != null &amp;&amp; rbC.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option C selected (index 2)&quot;);&#10;            return 2;&#10;        }&#10;        if (rbD != null &amp;&amp; rbD.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option D selected (index 3)&quot;);&#10;            return 3;&#10;        }&#10;&#10;        // Nếu vẫn không tìm được, thử kiểm tra bằng ID được sinh ra động&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Fallback: Checking by generated IDs&quot;);&#10;        for (int i = 0; i &lt; radioGroup.getChildCount(); i++) {&#10;            View child = radioGroup.getChildAt(i);&#10;            if (child instanceof RadioButton) {&#10;                RadioButton rb = (RadioButton) child;&#10;                if (rb.isChecked()) {&#10;                    android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Found checked RadioButton at child position &quot; + i);&#10;                    return i;&#10;                }&#10;            }&#10;        }&#10;&#10;        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Could not determine correct answer index for checkedId: &quot; + checkedId);&#10;        return -1;&#10;    }&#10;&#10;    private void saveTestQuestionsToFirebase(List&lt;TestQuestion&gt; testQuestions) {&#10;        btnCreateQuiz.setEnabled(false);&#10;        btnCreateQuiz.setText(&quot;Đang tạo...&quot;);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Starting Firebase save for test questions...&quot;);&#10;&#10;        // Lưu từng câu hỏi trong danh sách như một document riêng biệt&#10;        for (TestQuestion question : testQuestions) {&#10;            db.collection(&quot;test&quot;)  // Thay đổi từ &quot;quizzes&quot; sang &quot;test&quot;&#10;                    .add(question)&#10;                    .addOnSuccessListener(documentReference -&gt; {&#10;                        String documentId = documentReference.getId();&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Test question saved successfully with ID: &quot; + documentId);&#10;&#10;                        // Log từng câu hỏi đã lưu&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Saved Test Question:&quot;);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  ID: &quot; + documentId);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  courseId: &quot; + question.getCourseId());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  teacherId: &quot; + question.getTeacherId());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  correctAnswer: &quot; + question.getCorrectAnswer());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  options: &quot; + question.getOptions());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  question: &quot; + question.getQuestion());&#10;&#10;                        // Hiển thị thông báo thành công cho lần lưu cuối cùng&#10;                        if (question == testQuestions.get(testQuestions.size() - 1)) {&#10;                            Toast.makeText(this, &quot;Tạo bài kiểm tra thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Firebase save failed: &quot; + e.getMessage(), e);&#10;                        Toast.makeText(this, &quot;Lỗi khi tạo bài kiểm tra: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                        btnCreateQuiz.setEnabled(true);&#10;                        btnCreateQuiz.setText(&quot;Tạo bài kiểm tra&quot;);&#10;                    });&#10;        }&#10;    }&#10;&#10;    private void saveSimpleTestQuestionsToFirebase(List&lt;SimpleTestQuestion&gt; simpleTestQuestions) {&#10;        btnCreateQuiz.setEnabled(false);&#10;        btnCreateQuiz.setText(&quot;Đang tạo...&quot;);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Starting Firebase save for simple test questions...&quot;);&#10;&#10;        // Lưu từng câu hỏi trong danh sách như một document riêng biệt&#10;        for (SimpleTestQuestion question : simpleTestQuestions) {&#10;            db.collection(&quot;test&quot;)  // Thay đổi từ &quot;quizzes&quot; sang &quot;test&quot;&#10;                    .add(question)&#10;                    .addOnSuccessListener(documentReference -&gt; {&#10;                        String documentId = documentReference.getId();&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Simple test question saved successfully with ID: &quot; + documentId);&#10;&#10;                        // Log từng câu hỏi đã lưu&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Saved Simple Test Question:&quot;);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  ID: &quot; + documentId);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  correctAnswer: &quot; + question.getCorrectAnswer());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  options: &quot; + question.getOptions());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  question: &quot; + question.getQuestion());&#10;&#10;                        // Hiển thị thông báo thành công cho lần lưu cuối cùng&#10;                        if (question == simpleTestQuestions.get(simpleTestQuestions.size() - 1)) {&#10;                            Toast.makeText(this, &quot;Tạo bài kiểm tra thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Firebase save failed: &quot; + e.getMessage(), e);&#10;                        Toast.makeText(this, &quot;Lỗi khi tạo bài kiểm tra: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                        btnCreateQuiz.setEnabled(true);&#10;                        btnCreateQuiz.setText(&quot;Tạo bài kiểm tra&quot;);&#10;                    });&#10;        }&#10;    }&#10;&#10;    private void saveQuizQuestionsToFirebase(List&lt;QuizQuestion&gt; quizQuestions) {&#10;        btnCreateQuiz.setEnabled(false);&#10;        btnCreateQuiz.setText(&quot;Đang tạo...&quot;);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Starting Firebase save for quiz questions (old structure)...&quot;);&#10;&#10;        // Lưu từng câu hỏi trong danh sách như một document riêng biệt&#10;        for (QuizQuestion question : quizQuestions) {&#10;            db.collection(&quot;quizzes&quot;)  // Lưu vào collection &quot;quizzes&quot; với cấu trúc cũ&#10;                    .add(question)&#10;                    .addOnSuccessListener(documentReference -&gt; {&#10;                        String documentId = documentReference.getId();&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Quiz question (old structure) saved successfully with ID: &quot; + documentId);&#10;&#10;                        // Hiển thị thông báo thành công cho lần lưu cuối cùng&#10;                        if (question == quizQuestions.get(quizQuestions.size() - 1)) {&#10;                            Toast.makeText(this, &quot;Tạo bài kiểm tra thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Firebase save failed: &quot; + e.getMessage(), e);&#10;                        Toast.makeText(this, &quot;Lỗi khi tạo bài kiểm tra: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                        btnCreateQuiz.setEnabled(true);&#10;                        btnCreateQuiz.setText(&quot;Tạo bài kiểm tra&quot;);&#10;                    });&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean onSupportNavigateUp() {&#10;        onBackPressed();&#10;        return true;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.RadioButton;&#10;import android.widget.RadioGroup;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import android.widget.LinearLayout;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.models.Quiz;&#10;import com.vantinh.tienganh.models.QuizQuestion;&#10;import com.vantinh.tienganh.models.TestQuestion;&#10;import com.vantinh.tienganh.models.SimpleTestQuestion;&#10;import com.vantinh.tienganh.utils.QuestionViewHelper;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;&#10;public class CreateQuizActivity extends AppCompatActivity implements QuestionViewHelper.OnQuestionCountChangeListener {&#10;&#10;    private Toolbar toolbar;&#10;    private EditText etQuizTitle;&#10;    private TextView tvCourseName, tvQuestionCount;&#10;    private Button btnCreateQuiz, btnAddQuestion, btnRemoveQuestion, btnDebugCreate;&#10;    private LinearLayout llQuestionsContainer;&#10;    private String courseId, courseName;&#10;    private FirebaseFirestore db;&#10;    private FirebaseAuth mAuth;&#10;&#10;    private QuestionViewHelper questionViewHelper;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_create_quiz);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        initFirebase();&#10;        getCourseInfo();&#10;        initQuestionHelper();&#10;        setupClickListeners();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        etQuizTitle = findViewById(R.id.et_quiz_title);&#10;        tvCourseName = findViewById(R.id.tv_course_name);&#10;        tvQuestionCount = findViewById(R.id.tv_question_count);&#10;        btnCreateQuiz = findViewById(R.id.btn_create_quiz);&#10;        btnAddQuestion = findViewById(R.id.btn_add_question);&#10;        btnRemoveQuestion = findViewById(R.id.btn_remove_question);&#10;        llQuestionsContainer = findViewById(R.id.ll_questions_container);&#10;        btnDebugCreate = findViewById(R.id.btn_debug_create);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Tạo bài kiểm tra&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void initFirebase() {&#10;        db = FirebaseFirestore.getInstance();&#10;        mAuth = FirebaseAuth.getInstance();&#10;    }&#10;&#10;    private void getCourseInfo() {&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseName = getIntent().getStringExtra(&quot;courseName&quot;);&#10;&#10;        if (courseName != null) {&#10;            tvCourseName.setText(&quot;Khóa học: &quot; + courseName);&#10;        }&#10;    }&#10;&#10;    private void initQuestionHelper() {&#10;        questionViewHelper = new QuestionViewHelper(this, llQuestionsContainer);&#10;        questionViewHelper.setOnQuestionCountChangeListener(this);&#10;        questionViewHelper.initializeWithDefaultQuestions();&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnCreateQuiz.setOnClickListener(v -&gt; createQuiz());&#10;&#10;        btnAddQuestion.setOnClickListener(v -&gt; {&#10;            questionViewHelper.addQuestion();&#10;            // Debug log&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Added question, total: &quot; + questionViewHelper.getQuestionCount());&#10;        });&#10;&#10;        btnRemoveQuestion.setOnClickListener(v -&gt; {&#10;            int countBefore = questionViewHelper.getQuestionCount();&#10;            questionViewHelper.removeLastQuestion();&#10;            int countAfter = questionViewHelper.getQuestionCount();&#10;            // Debug log&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Remove clicked - Before: &quot; + countBefore + &quot;, After: &quot; + countAfter);&#10;            Toast.makeText(this, &quot;Đã xóa câu hỏi cuối&quot;, Toast.LENGTH_SHORT).show();&#10;        });&#10;&#10;        btnDebugCreate.setOnClickListener(v -&gt; createDebugSampleData());&#10;    }&#10;&#10;    @Override&#10;    public void onQuestionCountChanged(int count) {&#10;        tvQuestionCount.setText(&quot;(&quot; + count + &quot; câu)&quot;);&#10;        boolean canRemove = count &gt; 2;&#10;        btnRemoveQuestion.setEnabled(canRemove);&#10;&#10;        // Debug log&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Question count changed: &quot; + count + &quot;, Can remove: &quot; + canRemove);&#10;&#10;        // Thay đổi màu nút để thể hiện trạng thái&#10;        if (canRemove) {&#10;            btnRemoveQuestion.setBackgroundTintList(getResources().getColorStateList(android.R.color.holo_red_dark));&#10;            btnRemoveQuestion.setAlpha(1.0f);&#10;        } else {&#10;            btnRemoveQuestion.setBackgroundTintList(getResources().getColorStateList(android.R.color.darker_gray));&#10;            btnRemoveQuestion.setAlpha(0.5f);&#10;        }&#10;    }&#10;&#10;    private void createQuiz() {&#10;        if (!validateInput()) {&#10;            return;&#10;        }&#10;&#10;        // Debug: Bắt đầu quá trình tạo bài kiểm tra&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;=== BẮT ĐẦU TẠO BÁI KIỂM TRA ===&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Course ID: &quot; + courseId);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Course Name: &quot; + courseName);&#10;&#10;        List&lt;SimpleTestQuestion&gt; simpleTestQuestions = new ArrayList&lt;&gt;();&#10;&#10;        // Tạo từng câu hỏi theo cấu trúc mới chỉ với 3 trường&#10;        List&lt;QuestionViewHelper.QuestionViewData&gt; questionViews = questionViewHelper.getQuestionViews();&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Số câu hỏi cần tạo: &quot; + questionViews.size());&#10;&#10;        for (int i = 0; i &lt; questionViews.size(); i++) {&#10;            QuestionViewHelper.QuestionViewData questionData = questionViews.get(i);&#10;&#10;            // 1. Lấy question (String) - nội dung câu hỏi&#10;            String questionText = questionData.etQuestion.getText().toString().trim();&#10;            &#10;            // 2. Lấy correctAnswer (Array) - 4 đáp án A,B,C,D&#10;            List&lt;String&gt; correctAnswerArray = new ArrayList&lt;&gt;();&#10;            for (int j = 0; j &lt; 4; j++) {&#10;                String optionText = questionData.etOptions[j].getText().toString().trim();&#10;                correctAnswerArray.add(optionText);&#10;                android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  Option &quot; + (char)('A' + j) + &quot;: &quot; + optionText);&#10;            }&#10;&#10;            // 3. Lấy options (Number) - index của đáp án đúng (0-3)&#10;            int correctAnswerIndex = getCorrectAnswerIndex(questionData);&#10;            &#10;            // Tạo SimpleTestQuestion chỉ với 4 trường dữ liệu (thêm courseId)&#10;            SimpleTestQuestion simpleQuestion = new SimpleTestQuestion();&#10;            simpleQuestion.setCourseId(courseId);              // String - ID khóa học (MỚI)&#10;            simpleQuestion.setCorrectAnswer(correctAnswerArray);     // Array - 4 đáp án&#10;            simpleQuestion.setOptions(correctAnswerIndex);           // Number - index đáp án đúng&#10;            simpleQuestion.setQuestion(questionText);                // String - câu hỏi&#10;&#10;            simpleTestQuestions.add(simpleQuestion);&#10;&#10;            // Debug log chi tiết cho từng câu hỏi với courseId&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;--- QUESTION &quot; + (i+1) + &quot; DEBUG ---&quot;);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;courseId (String): \&quot;&quot; + courseId + &quot;\&quot;&quot;);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;question (String): \&quot;&quot; + questionText + &quot;\&quot;&quot;);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;correctAnswer (Array): &quot; + correctAnswerArray.toString());&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;options (Number): &quot; + correctAnswerIndex);&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Đáp án đúng là: &quot; +&#10;                (correctAnswerIndex &gt;= 0 &amp;&amp; correctAnswerIndex &lt; correctAnswerArray.size() ?&#10;                 correctAnswerArray.get(correctAnswerIndex) : &quot;KHÔNG XÁC ĐỊNH&quot;));&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;SimpleTestQuestion Object: &quot; + simpleQuestion.toString());&#10;        }&#10;&#10;        // Debug tổng kết trước khi lưu&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;=== TỔNG KẾT TRƯỚC KHI LƯU ===&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Tổng số câu hỏi: &quot; + simpleTestQuestions.size());&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Collection đích: test&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Cấu trúc mỗi document:&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  - correctAnswer: Array[4] (4 đáp án)&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  - options: Number (index đáp án đúng)&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  - question: String (câu hỏi)&quot;);&#10;&#10;        // Lưu từng câu hỏi như một document riêng trong collection &quot;test&quot;&#10;        saveSimpleTestQuestionsToFirebase(simpleTestQuestions);&#10;    }&#10;&#10;    private void createDebugSampleData() {&#10;        // Tạo dữ liệu mẫu để kiểm tra&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;=== TẠO DỮ LIỆU MẪU ===&quot;);&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;CourseId for sample data: &quot; + courseId);&#10;&#10;        // Tạo một danh sách câu hỏi mẫu&#10;        List&lt;SimpleTestQuestion&gt; sampleQuestions = new ArrayList&lt;&gt;();&#10;&#10;        // Tạo 5 câu hỏi mẫu với đáp án ngẫu nhiên&#10;        for (int i = 1; i &lt;= 5; i++) {&#10;            SimpleTestQuestion question = new SimpleTestQuestion();&#10;            question.setCourseId(courseId);  // Thêm courseId cho dữ liệu mẫu&#10;            question.setQuestion(&quot;Câu hỏi mẫu &quot; + i + &quot; - Khóa học: &quot; + courseName);&#10;&#10;            List&lt;String&gt; answers = new ArrayList&lt;&gt;();&#10;            answers.add(&quot;Đáp án A - Câu hỏi &quot; + i);&#10;            answers.add(&quot;Đáp án B - Câu hỏi &quot; + i);&#10;            answers.add(&quot;Đáp án C - Câu hỏi &quot; + i);&#10;            answers.add(&quot;Đáp án D - Câu hỏi &quot; + i);&#10;            question.setCorrectAnswer(answers);&#10;&#10;            // Chọn ngẫu nhiên một đáp án đúng&#10;            int correctIndex = (int) (Math.random() * 4);&#10;            question.setOptions(correctIndex);&#10;&#10;            sampleQuestions.add(question);&#10;&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Câu hỏi mẫu &quot; + i + &quot;: &quot; + question.toString());&#10;        }&#10;&#10;        // Lưu vào Firebase&#10;        saveSimpleTestQuestionsToFirebase(sampleQuestions);&#10;    }&#10;&#10;    private boolean validateInput() {&#10;        // Bỏ validation tên bài kiểm tra vì không cần thiết với cấu trúc mới&#10;        List&lt;QuestionViewHelper.QuestionViewData&gt; questionViews = questionViewHelper.getQuestionViews();&#10;&#10;        for (int i = 0; i &lt; questionViews.size(); i++) {&#10;            QuestionViewHelper.QuestionViewData questionData = questionViews.get(i);&#10;&#10;            String questionText = questionData.etQuestion.getText().toString().trim();&#10;            if (questionText.isEmpty()) {&#10;                questionData.etQuestion.setError(&quot;Vui lòng nhập câu hỏi &quot; + (i + 1));&#10;                questionData.etQuestion.requestFocus();&#10;                return false;&#10;            }&#10;&#10;            for (int j = 0; j &lt; 4; j++) {&#10;                String option = questionData.etOptions[j].getText().toString().trim();&#10;                if (option.isEmpty()) {&#10;                    questionData.etOptions[j].setError(&quot;Vui lòng nhập lựa chọn &quot; + (char)('A' + j));&#10;                    questionData.etOptions[j].requestFocus();&#10;                    return false;&#10;                }&#10;            }&#10;&#10;            // Check if any radio button is selected for this question&#10;            if (questionData.rgCorrectAnswer.getCheckedRadioButtonId() == -1) {&#10;                Toast.makeText(this, &quot;Vui lòng chọn đáp án đúng cho câu hỏi &quot; + (i + 1), Toast.LENGTH_SHORT).show();&#10;                return false;&#10;            }&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;    private int getCorrectAnswerIndex(QuestionViewHelper.QuestionViewData questionData) {&#10;        RadioGroup radioGroup = questionData.rgCorrectAnswer;&#10;        int checkedId = radioGroup.getCheckedRadioButtonId();&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Getting correct answer - checkedId: &quot; + checkedId);&#10;&#10;        if (checkedId == -1) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;No option selected&quot;);&#10;            return -1;&#10;        }&#10;&#10;        // Phương pháp đơn giản: Kiểm tra trực tiếp từng RadioButton theo ID gốc&#10;        RadioButton rbA = questionData.questionView.findViewById(R.id.rb_option_a);&#10;        RadioButton rbB = questionData.questionView.findViewById(R.id.rb_option_b);&#10;        RadioButton rbC = questionData.questionView.findViewById(R.id.rb_option_c);&#10;        RadioButton rbD = questionData.questionView.findViewById(R.id.rb_option_d);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;RadioButton states - A:&quot; + (rbA != null ? rbA.isChecked() : &quot;null&quot;) +&#10;                                        &quot;, B:&quot; + (rbB != null ? rbB.isChecked() : &quot;null&quot;) +&#10;                                        &quot;, C:&quot; + (rbC != null ? rbC.isChecked() : &quot;null&quot;) +&#10;                                        &quot;, D:&quot; + (rbD != null ? rbD.isChecked() : &quot;null&quot;));&#10;&#10;        if (rbA != null &amp;&amp; rbA.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option A selected (index 0)&quot;);&#10;            return 0;&#10;        }&#10;        if (rbB != null &amp;&amp; rbB.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option B selected (index 1)&quot;);&#10;            return 1;&#10;        }&#10;        if (rbC != null &amp;&amp; rbC.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option C selected (index 2)&quot;);&#10;            return 2;&#10;        }&#10;        if (rbD != null &amp;&amp; rbD.isChecked()) {&#10;            android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Option D selected (index 3)&quot;);&#10;            return 3;&#10;        }&#10;&#10;        // Nếu vẫn không tìm được, thử kiểm tra bằng ID được sinh ra động&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Fallback: Checking by generated IDs&quot;);&#10;        for (int i = 0; i &lt; radioGroup.getChildCount(); i++) {&#10;            View child = radioGroup.getChildAt(i);&#10;            if (child instanceof RadioButton) {&#10;                RadioButton rb = (RadioButton) child;&#10;                if (rb.isChecked()) {&#10;                    android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Found checked RadioButton at child position &quot; + i);&#10;                    return i;&#10;                }&#10;            }&#10;        }&#10;&#10;        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Could not determine correct answer index for checkedId: &quot; + checkedId);&#10;        return -1;&#10;    }&#10;&#10;    private void saveTestQuestionsToFirebase(List&lt;TestQuestion&gt; testQuestions) {&#10;        btnCreateQuiz.setEnabled(false);&#10;        btnCreateQuiz.setText(&quot;Đang tạo...&quot;);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Starting Firebase save for test questions...&quot;);&#10;&#10;        // Lưu từng câu hỏi trong danh sách như một document riêng biệt&#10;        for (TestQuestion question : testQuestions) {&#10;            db.collection(&quot;test&quot;)  // Thay đổi từ &quot;quizzes&quot; sang &quot;test&quot;&#10;                    .add(question)&#10;                    .addOnSuccessListener(documentReference -&gt; {&#10;                        String documentId = documentReference.getId();&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Test question saved successfully with ID: &quot; + documentId);&#10;&#10;                        // Log từng câu hỏi đã lưu&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Saved Test Question:&quot;);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  ID: &quot; + documentId);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  courseId: &quot; + question.getCourseId());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  teacherId: &quot; + question.getTeacherId());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  correctAnswer: &quot; + question.getCorrectAnswer());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  options: &quot; + question.getOptions());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  question: &quot; + question.getQuestion());&#10;&#10;                        // Hiển thị thông báo thành công cho lần lưu cuối cùng&#10;                        if (question == testQuestions.get(testQuestions.size() - 1)) {&#10;                            Toast.makeText(this, &quot;Tạo bài kiểm tra thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Firebase save failed: &quot; + e.getMessage(), e);&#10;                        Toast.makeText(this, &quot;Lỗi khi tạo bài kiểm tra: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                        btnCreateQuiz.setEnabled(true);&#10;                        btnCreateQuiz.setText(&quot;Tạo bài kiểm tra&quot;);&#10;                    });&#10;        }&#10;    }&#10;&#10;    private void saveSimpleTestQuestionsToFirebase(List&lt;SimpleTestQuestion&gt; simpleTestQuestions) {&#10;        btnCreateQuiz.setEnabled(false);&#10;        btnCreateQuiz.setText(&quot;Đang tạo...&quot;);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Starting Firebase save for simple test questions...&quot;);&#10;&#10;        // Lưu từng câu hỏi trong danh sách như một document riêng biệt&#10;        for (SimpleTestQuestion question : simpleTestQuestions) {&#10;            db.collection(&quot;test&quot;)  // Thay đổi từ &quot;quizzes&quot; sang &quot;test&quot;&#10;                    .add(question)&#10;                    .addOnSuccessListener(documentReference -&gt; {&#10;                        String documentId = documentReference.getId();&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Simple test question saved successfully with ID: &quot; + documentId);&#10;&#10;                        // Log từng câu hỏi đã lưu&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Saved Simple Test Question:&quot;);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  ID: &quot; + documentId);&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  correctAnswer: &quot; + question.getCorrectAnswer());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  options: &quot; + question.getOptions());&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;  question: &quot; + question.getQuestion());&#10;&#10;                        // Hiển thị thông báo thành công cho lần lưu cuối cùng&#10;                        if (question == simpleTestQuestions.get(simpleTestQuestions.size() - 1)) {&#10;                            Toast.makeText(this, &quot;Tạo bài kiểm tra thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Firebase save failed: &quot; + e.getMessage(), e);&#10;                        Toast.makeText(this, &quot;Lỗi khi tạo bài kiểm tra: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                        btnCreateQuiz.setEnabled(true);&#10;                        btnCreateQuiz.setText(&quot;Tạo bài kiểm tra&quot;);&#10;                    });&#10;        }&#10;    }&#10;&#10;    private void saveQuizQuestionsToFirebase(List&lt;QuizQuestion&gt; quizQuestions) {&#10;        btnCreateQuiz.setEnabled(false);&#10;        btnCreateQuiz.setText(&quot;Đang tạo...&quot;);&#10;&#10;        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Starting Firebase save for quiz questions (old structure)...&quot;);&#10;&#10;        // Lưu từng câu hỏi trong danh sách như một document riêng biệt&#10;        for (QuizQuestion question : quizQuestions) {&#10;            db.collection(&quot;quizzes&quot;)  // Lưu vào collection &quot;quizzes&quot; với cấu trúc cũ&#10;                    .add(question)&#10;                    .addOnSuccessListener(documentReference -&gt; {&#10;                        String documentId = documentReference.getId();&#10;                        android.util.Log.d(&quot;CreateQuiz&quot;, &quot;Quiz question (old structure) saved successfully with ID: &quot; + documentId);&#10;&#10;                        // Hiển thị thông báo thành công cho lần lưu cuối cùng&#10;                        if (question == quizQuestions.get(quizQuestions.size() - 1)) {&#10;                            Toast.makeText(this, &quot;Tạo bài kiểm tra thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        android.util.Log.e(&quot;CreateQuiz&quot;, &quot;Firebase save failed: &quot; + e.getMessage(), e);&#10;                        Toast.makeText(this, &quot;Lỗi khi tạo bài kiểm tra: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                        btnCreateQuiz.setEnabled(true);&#10;                        btnCreateQuiz.setText(&quot;Tạo bài kiểm tra&quot;);&#10;                    });&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean onSupportNavigateUp() {&#10;        onBackPressed();&#10;        return true;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/EditCourseActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/EditCourseActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.ArrayAdapter;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.ProgressBar;&#10;import android.widget.Spinner;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.android.material.bottomnavigation.BottomNavigationView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import java.util.Date;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;public class EditCourseActivity extends AppCompatActivity {&#10;&#10;    private EditText etCourseTitle, etCourseDescription, etCourseDuration;&#10;    private Spinner spinnerLevel, spinnerCategory;&#10;    private Button btnUpdateCourse, btnDeleteCourse, btnManageLessons, btnViewStudents;&#10;    private ProgressBar progressBar;&#10;    private BottomNavigationView bottomNavigation;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String courseId;&#10;    private Course currentCourse;&#10;&#10;    // Arrays cho spinners&#10;    private String[] levels = {&quot;Beginner&quot;, &quot;Intermediate&quot;, &quot;Advanced&quot;};&#10;    private String[] categories = {&quot;Grammar&quot;, &quot;Vocabulary&quot;, &quot;Listening&quot;, &quot;Speaking&quot;, &quot;Reading&quot;, &quot;Writing&quot;};&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_edit_course);&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        // Get course ID from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy ID khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupSpinners();&#10;        setupBottomNavigation();&#10;        setupClickListeners();&#10;        loadCourseData();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        bottomNavigation = findViewById(R.id.bottom_navigation);&#10;        etCourseTitle = findViewById(R.id.et_course_title);&#10;        etCourseDescription = findViewById(R.id.et_course_description);&#10;        etCourseDuration = findViewById(R.id.et_course_duration);&#10;        spinnerLevel = findViewById(R.id.spinner_level);&#10;        spinnerCategory = findViewById(R.id.spinner_category);&#10;        btnUpdateCourse = findViewById(R.id.btn_update_course);&#10;        btnDeleteCourse = findViewById(R.id.btn_delete_course);&#10;        btnManageLessons = findViewById(R.id.btn_manage_lessons);&#10;        btnViewStudents = findViewById(R.id.btn_view_students);&#10;        progressBar = findViewById(R.id.progress_bar);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Chỉnh sửa khóa học&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupSpinners() {&#10;        // Setup Level spinner&#10;        ArrayAdapter&lt;String&gt; levelAdapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, levels);&#10;        levelAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerLevel.setAdapter(levelAdapter);&#10;&#10;        // Setup Category spinner&#10;        ArrayAdapter&lt;String&gt; categoryAdapter = new ArrayAdapter&lt;&gt;(this,&#10;            android.R.layout.simple_spinner_item, categories);&#10;        categoryAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#10;        spinnerCategory.setAdapter(categoryAdapter);&#10;    }&#10;&#10;    private void setupBottomNavigation() {&#10;        bottomNavigation.setSelectedItemId(R.id.nav_courses);&#10;        bottomNavigation.setOnItemSelectedListener(item -&gt; {&#10;            int itemId = item.getItemId();&#10;            if (itemId == R.id.nav_home) {&#10;                startActivity(new Intent(this, TeacherDashboardActivity.class));&#10;                return true;&#10;            } else if (itemId == R.id.nav_courses) {&#10;                // Already on courses&#10;                return true;&#10;            } else if (itemId == R.id.nav_students) {&#10;                startActivity(new Intent(this, EnrollmentManagementActivity.class));&#10;                return true;&#10;            } else if (itemId == R.id.nav_profile) {&#10;                startActivity(new Intent(this, UpdateProfileActivity.class));&#10;                return true;&#10;            }&#10;            return false;&#10;        });&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnUpdateCourse.setOnClickListener(v -&gt; updateCourse());&#10;        btnDeleteCourse.setOnClickListener(v -&gt; deleteCourse());&#10;        btnManageLessons.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, LessonManagementActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, currentCourse != null ? currentCourse.getTitle() : &quot;&quot;);&#10;            intent.putExtra(&quot;courseCategory&quot;, currentCourse != null ? currentCourse.getCategory() : &quot;&quot;);&#10;            startActivity(intent);&#10;        });&#10;        btnViewStudents.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, CourseStudentsActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, currentCourse != null ? currentCourse.getTitle() : &quot;&quot;);&#10;            startActivity(intent);&#10;        });&#10;    }&#10;&#10;    private void loadCourseData() {&#10;        progressBar.setVisibility(View.VISIBLE);&#10;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;            .get()&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#10;                progressBar.setVisibility(View.GONE);&#10;                if (documentSnapshot.exists()) {&#10;                    currentCourse = documentSnapshot.toObject(Course.class);&#10;                    if (currentCourse != null) {&#10;                        currentCourse.setId(documentSnapshot.getId());&#10;                        populateFields();&#10;                    }&#10;                } else {&#10;                    Toast.makeText(this, &quot;Không tìm thấy khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                progressBar.setVisibility(View.GONE);&#10;                Toast.makeText(this, &quot;Lỗi khi tải dữ liệu khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                android.util.Log.e(&quot;EditCourse&quot;, &quot;Error loading course&quot;, e);&#10;            });&#10;    }&#10;&#10;    private void populateFields() {&#10;        // Điền thông tin khóa học vào các trường&#10;        etCourseTitle.setText(currentCourse.getTitle());&#10;        etCourseDescription.setText(currentCourse.getDescription());&#10;        etCourseDuration.setText(String.valueOf(currentCourse.getDuration()));&#10;&#10;        // Set spinner selections&#10;        setSpinnerSelection(spinnerLevel, currentCourse.getLevel());&#10;        setSpinnerSelection(spinnerCategory, currentCourse.getCategory());&#10;&#10;        android.util.Log.d(&quot;EditCourse&quot;, &quot;Populated fields for course: &quot; + currentCourse.getTitle());&#10;    }&#10;&#10;    private void setSpinnerSelection(Spinner spinner, String value) {&#10;        if (value != null) {&#10;            ArrayAdapter adapter = (ArrayAdapter) spinner.getAdapter();&#10;            int position = adapter.getPosition(value);&#10;            if (position &gt;= 0) {&#10;                spinner.setSelection(position);&#10;            }&#10;        }&#10;    }&#10;&#10;    private void updateCourse() {&#10;        String title = etCourseTitle.getText().toString().trim();&#10;        String description = etCourseDescription.getText().toString().trim();&#10;        String durationStr = etCourseDuration.getText().toString().trim();&#10;        String level = spinnerLevel.getSelectedItem().toString();&#10;        String category = spinnerCategory.getSelectedItem().toString();&#10;&#10;        // Validation&#10;        if (title.isEmpty()) {&#10;            etCourseTitle.setError(&quot;Vui lòng nhập tên khóa học&quot;);&#10;            etCourseTitle.requestFocus();&#10;            return;&#10;        }&#10;&#10;        if (description.isEmpty()) {&#10;            etCourseDescription.setError(&quot;Vui lòng nhập mô tả khóa học&quot;);&#10;            etCourseDescription.requestFocus();&#10;            return;&#10;        }&#10;&#10;        if (durationStr.isEmpty()) {&#10;            etCourseDuration.setError(&quot;Vui lòng nhập thời lượng&quot;);&#10;            etCourseDuration.requestFocus();&#10;            return;&#10;        }&#10;&#10;        int duration;&#10;        try {&#10;            duration = Integer.parseInt(durationStr);&#10;            if (duration &lt;= 0) {&#10;                etCourseDuration.setError(&quot;Thời lượng phải lớn hơn 0&quot;);&#10;                etCourseDuration.requestFocus();&#10;                return;&#10;            }&#10;        } catch (NumberFormatException e) {&#10;            etCourseDuration.setError(&quot;Thời lượng phải là số&quot;);&#10;            etCourseDuration.requestFocus();&#10;            return;&#10;        }&#10;&#10;        progressBar.setVisibility(View.VISIBLE);&#10;        btnUpdateCourse.setEnabled(false);&#10;&#10;        // Tạo map để update&#10;        Map&lt;String, Object&gt; updates = new HashMap&lt;&gt;();&#10;        updates.put(&quot;title&quot;, title);&#10;        updates.put(&quot;description&quot;, description);&#10;        updates.put(&quot;duration&quot;, duration);&#10;        updates.put(&quot;level&quot;, level);&#10;        updates.put(&quot;category&quot;, category);&#10;        updates.put(&quot;updatedAt&quot;, new Date());&#10;&#10;        android.util.Log.d(&quot;EditCourse&quot;, &quot;Updating course with: &quot; + updates);&#10;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;            .update(updates)&#10;            .addOnSuccessListener(aVoid -&gt; {&#10;                progressBar.setVisibility(View.GONE);&#10;                btnUpdateCourse.setEnabled(true);&#10;                Toast.makeText(this, &quot;Cập nhật khóa học thành công!&quot;, Toast.LENGTH_SHORT).show();&#10;&#10;                // Cập nhật currentCourse object&#10;                currentCourse.setTitle(title);&#10;                currentCourse.setDescription(description);&#10;                currentCourse.setDuration(duration);&#10;                currentCourse.setLevel(level);&#10;                currentCourse.setCategory(category);&#10;&#10;                android.util.Log.d(&quot;EditCourse&quot;, &quot;Course updated successfully&quot;);&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                progressBar.setVisibility(View.GONE);&#10;                btnUpdateCourse.setEnabled(true);&#10;                Toast.makeText(this, &quot;Lỗi khi cập nhật khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                android.util.Log.e(&quot;EditCourse&quot;, &quot;Error updating course&quot;, e);&#10;            });&#10;    }&#10;&#10;    private void deleteCourse() {&#10;        new androidx.appcompat.app.AlertDialog.Builder(this)&#10;            .setTitle(&quot;Xác nhận xóa khóa học&quot;)&#10;            .setMessage(&quot;Bạn có chắc chắn muốn xóa khóa học \&quot;&quot; + currentCourse.getTitle() + &quot;\&quot;?\n\nHành động này sẽ:\n- Xóa khóa học vĩnh viễn\n- Xóa tất cả bài học trong khóa\n- Không thể hoàn tác&quot;)&#10;            .setPositiveButton(&quot;Xóa&quot;, (dialog, which) -&gt; performDeleteCourse())&#10;            .setNegativeButton(&quot;Hủy&quot;, null)&#10;            .setIcon(android.R.drawable.ic_dialog_alert)&#10;            .show();&#10;    }&#10;&#10;    private void performDeleteCourse() {&#10;        progressBar.setVisibility(View.VISIBLE);&#10;        btnDeleteCourse.setEnabled(false);&#10;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;            .delete()&#10;            .addOnSuccessListener(aVoid -&gt; {&#10;                progressBar.setVisibility(View.GONE);&#10;                Toast.makeText(this, &quot;Đã xóa khóa học thành công&quot;, Toast.LENGTH_SHORT).show();&#10;                android.util.Log.d(&quot;EditCourse&quot;, &quot;Course deleted successfully&quot;);&#10;&#10;                // Quay về CourseManagementActivity&#10;                Intent intent = new Intent(this, CourseManagementActivity.class);&#10;                intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);&#10;                startActivity(intent);&#10;                finish();&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                progressBar.setVisibility(View.GONE);&#10;                btnDeleteCourse.setEnabled(true);&#10;                Toast.makeText(this, &quot;Lỗi khi xóa khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                android.util.Log.e(&quot;EditCourse&quot;, &quot;Error deleting course&quot;, e);&#10;            });&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Reload course data when returning to this activity&#10;        if (courseId != null) {&#10;            loadCourseData();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#13;&#10;&#13;&#10;import android.content.Intent;&#13;&#10;import android.os.Bundle;&#13;&#10;import android.view.MenuItem;&#13;&#10;import android.view.View;&#13;&#10;import android.widget.ArrayAdapter;&#13;&#10;import android.widget.Button;&#13;&#10;import android.widget.EditText;&#13;&#10;import android.widget.ProgressBar;&#13;&#10;import android.widget.Spinner;&#13;&#10;import android.widget.Toast;&#13;&#10;import androidx.annotation.NonNull;&#13;&#10;import androidx.appcompat.app.AppCompatActivity;&#13;&#10;import androidx.appcompat.widget.Toolbar;&#13;&#10;import com.google.android.material.bottomnavigation.BottomNavigationView;&#13;&#10;import com.google.firebase.auth.FirebaseAuth;&#13;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#13;&#10;import java.util.Date;&#13;&#10;import java.util.HashMap;&#13;&#10;import java.util.Map;&#13;&#10;&#13;&#10;public class EditCourseActivity extends AppCompatActivity {&#13;&#10;&#13;&#10;    private EditText etCourseTitle, etCourseDescription, etCourseDuration;&#13;&#10;    private Spinner spinnerLevel, spinnerCategory;&#13;&#10;    private Button btnUpdateCourse, btnDeleteCourse, btnManageLessons, btnViewStudents, btnEditTestQuestions;&#13;&#10;    private ProgressBar progressBar;&#13;&#10;    private BottomNavigationView bottomNavigation;&#13;&#10;    private Toolbar toolbar;&#13;&#10;&#13;&#10;    private FirebaseAuth mAuth;&#13;&#10;    private FirebaseFirestore db;&#13;&#10;    private String courseId;&#13;&#10;    private Course currentCourse;&#13;&#10;&#13;&#10;    // Arrays cho spinners&#13;&#10;    private String[] levels = {&quot;Beginner&quot;, &quot;Intermediate&quot;, &quot;Advanced&quot;};&#13;&#10;    private String[] categories = {&quot;Grammar&quot;, &quot;Vocabulary&quot;, &quot;Listening&quot;, &quot;Speaking&quot;, &quot;Reading&quot;, &quot;Writing&quot;};&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onCreate(Bundle savedInstanceState) {&#13;&#10;        super.onCreate(savedInstanceState);&#13;&#10;        setContentView(R.layout.activity_edit_course);&#13;&#10;&#13;&#10;        mAuth = FirebaseAuth.getInstance();&#13;&#10;        db = FirebaseFirestore.getInstance();&#13;&#10;&#13;&#10;        // Get course ID from intent&#13;&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#13;&#10;        if (courseId == null) {&#13;&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy ID khóa học&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;            finish();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        initViews();&#13;&#10;        setupToolbar();&#13;&#10;        setupSpinners();&#13;&#10;        setupBottomNavigation();&#13;&#10;        setupClickListeners();&#13;&#10;        loadCourseData();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void initViews() {&#13;&#10;        toolbar = findViewById(R.id.toolbar);&#13;&#10;        bottomNavigation = findViewById(R.id.bottom_navigation);&#13;&#10;        etCourseTitle = findViewById(R.id.et_course_title);&#13;&#10;        etCourseDescription = findViewById(R.id.et_course_description);&#13;&#10;        etCourseDuration = findViewById(R.id.et_course_duration);&#13;&#10;        spinnerLevel = findViewById(R.id.spinner_level);&#13;&#10;        spinnerCategory = findViewById(R.id.spinner_category);&#13;&#10;        btnUpdateCourse = findViewById(R.id.btn_update_course);&#13;&#10;        btnDeleteCourse = findViewById(R.id.btn_delete_course);&#13;&#10;        btnManageLessons = findViewById(R.id.btn_manage_lessons);&#13;&#10;        btnViewStudents = findViewById(R.id.btn_view_students);&#13;&#10;        btnEditTestQuestions = findViewById(R.id.btn_edit_test_questions); // Thêm nút mới&#13;&#10;        progressBar = findViewById(R.id.progress_bar);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupToolbar() {&#13;&#10;        setSupportActionBar(toolbar);&#13;&#10;        if (getSupportActionBar() != null) {&#13;&#10;            getSupportActionBar().setTitle(&quot;Chỉnh sửa khóa học&quot;);&#13;&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupSpinners() {&#13;&#10;        // Setup Level spinner&#13;&#10;        ArrayAdapter&lt;String&gt; levelAdapter = new ArrayAdapter&lt;&gt;(this,&#13;&#10;            android.R.layout.simple_spinner_item, levels);&#13;&#10;        levelAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#13;&#10;        spinnerLevel.setAdapter(levelAdapter);&#13;&#10;&#13;&#10;        // Setup Category spinner&#13;&#10;        ArrayAdapter&lt;String&gt; categoryAdapter = new ArrayAdapter&lt;&gt;(this,&#13;&#10;            android.R.layout.simple_spinner_item, categories);&#13;&#10;        categoryAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);&#13;&#10;        spinnerCategory.setAdapter(categoryAdapter);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupBottomNavigation() {&#13;&#10;        bottomNavigation.setSelectedItemId(R.id.nav_courses);&#13;&#10;        bottomNavigation.setOnItemSelectedListener(item -&gt; {&#13;&#10;            int itemId = item.getItemId();&#13;&#10;            if (itemId == R.id.nav_home) {&#13;&#10;                startActivity(new Intent(this, TeacherDashboardActivity.class));&#13;&#10;                return true;&#13;&#10;            } else if (itemId == R.id.nav_courses) {&#13;&#10;                // Already on courses&#13;&#10;                return true;&#13;&#10;            } else if (itemId == R.id.nav_students) {&#13;&#10;                startActivity(new Intent(this, EnrollmentManagementActivity.class));&#13;&#10;                return true;&#13;&#10;            } else if (itemId == R.id.nav_profile) {&#13;&#10;                startActivity(new Intent(this, UpdateProfileActivity.class));&#13;&#10;                return true;&#13;&#10;            }&#13;&#10;            return false;&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupClickListeners() {&#13;&#10;        btnUpdateCourse.setOnClickListener(v -&gt; updateCourse());&#13;&#10;        btnDeleteCourse.setOnClickListener(v -&gt; deleteCourse());&#13;&#10;        btnManageLessons.setOnClickListener(v -&gt; {&#13;&#10;            Intent intent = new Intent(this, LessonManagementActivity.class);&#13;&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#13;&#10;            intent.putExtra(&quot;courseTitle&quot;, currentCourse != null ? currentCourse.getTitle() : &quot;&quot;);&#13;&#10;            intent.putExtra(&quot;courseCategory&quot;, currentCourse != null ? currentCourse.getCategory() : &quot;&quot;);&#13;&#10;            startActivity(intent);&#13;&#10;        });&#13;&#10;        btnViewStudents.setOnClickListener(v -&gt; {&#13;&#10;            Intent intent = new Intent(this, CourseStudentsActivity.class);&#13;&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#13;&#10;            intent.putExtra(&quot;courseTitle&quot;, currentCourse != null ? currentCourse.getTitle() : &quot;&quot;);&#13;&#10;            startActivity(intent);&#13;&#10;        });&#13;&#10;        btnEditTestQuestions.setOnClickListener(v -&gt; {&#13;&#10;            Intent intent = new Intent(this, EditTestQuestionsActivity.class);&#13;&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#13;&#10;            intent.putExtra(&quot;courseTitle&quot;, currentCourse != null ? currentCourse.getTitle() : &quot;&quot;);&#13;&#10;            startActivity(intent);&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void loadCourseData() {&#13;&#10;        progressBar.setVisibility(View.VISIBLE);&#13;&#10;&#13;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#13;&#10;            .get()&#13;&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#13;&#10;                progressBar.setVisibility(View.GONE);&#13;&#10;                if (documentSnapshot.exists()) {&#13;&#10;                    currentCourse = documentSnapshot.toObject(Course.class);&#13;&#10;                    if (currentCourse != null) {&#13;&#10;                        currentCourse.setId(documentSnapshot.getId());&#13;&#10;                        populateFields();&#13;&#10;                    }&#13;&#10;                } else {&#13;&#10;                    Toast.makeText(this, &quot;Không tìm thấy khóa học&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                    finish();&#13;&#10;                }&#13;&#10;            })&#13;&#10;            .addOnFailureListener(e -&gt; {&#13;&#10;                progressBar.setVisibility(View.GONE);&#13;&#10;                Toast.makeText(this, &quot;Lỗi khi tải dữ liệu khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#13;&#10;                android.util.Log.e(&quot;EditCourse&quot;, &quot;Error loading course&quot;, e);&#13;&#10;            });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void populateFields() {&#13;&#10;        // Điền thông tin khóa học vào các trường&#13;&#10;        etCourseTitle.setText(currentCourse.getTitle());&#13;&#10;        etCourseDescription.setText(currentCourse.getDescription());&#13;&#10;        etCourseDuration.setText(String.valueOf(currentCourse.getDuration()));&#13;&#10;&#13;&#10;        // Set spinner selections&#13;&#10;        setSpinnerSelection(spinnerLevel, currentCourse.getLevel());&#13;&#10;        setSpinnerSelection(spinnerCategory, currentCourse.getCategory());&#13;&#10;&#13;&#10;        android.util.Log.d(&quot;EditCourse&quot;, &quot;Populated fields for course: &quot; + currentCourse.getTitle());&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setSpinnerSelection(Spinner spinner, String value) {&#13;&#10;        if (value != null) {&#13;&#10;            ArrayAdapter adapter = (ArrayAdapter) spinner.getAdapter();&#13;&#10;            int position = adapter.getPosition(value);&#13;&#10;            if (position &gt;= 0) {&#13;&#10;                spinner.setSelection(position);&#13;&#10;            }&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void updateCourse() {&#13;&#10;        String title = etCourseTitle.getText().toString().trim();&#13;&#10;        String description = etCourseDescription.getText().toString().trim();&#13;&#10;        String durationStr = etCourseDuration.getText().toString().trim();&#13;&#10;        String level = spinnerLevel.getSelectedItem().toString();&#13;&#10;        String category = spinnerCategory.getSelectedItem().toString();&#13;&#10;&#13;&#10;        // Validation&#13;&#10;        if (title.isEmpty()) {&#13;&#10;            etCourseTitle.setError(&quot;Vui lòng nhập tên khóa học&quot;);&#13;&#10;            etCourseTitle.requestFocus();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        if (description.isEmpty()) {&#13;&#10;            etCourseDescription.setError(&quot;Vui lòng nhập mô tả khóa học&quot;);&#13;&#10;            etCourseDescription.requestFocus();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        if (durationStr.isEmpty()) {&#13;&#10;            etCourseDuration.setError(&quot;Vui lòng nhập thời lượng&quot;);&#13;&#10;            etCourseDuration.requestFocus();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        int duration;&#13;&#10;        try {&#13;&#10;            duration = Integer.parseInt(durationStr);&#13;&#10;            if (duration &lt;= 0) {&#13;&#10;                etCourseDuration.setError(&quot;Thời lượng phải lớn hơn 0&quot;);&#13;&#10;                etCourseDuration.requestFocus();&#13;&#10;                return;&#13;&#10;            }&#13;&#10;        } catch (NumberFormatException e) {&#13;&#10;            etCourseDuration.setError(&quot;Thời lượng phải là số&quot;);&#13;&#10;            etCourseDuration.requestFocus();&#13;&#10;            return;&#13;&#10;        }&#13;&#10;&#13;&#10;        progressBar.setVisibility(View.VISIBLE);&#13;&#10;        btnUpdateCourse.setEnabled(false);&#13;&#10;&#13;&#10;        // Tạo map để update&#13;&#10;        Map&lt;String, Object&gt; updates = new HashMap&lt;&gt;();&#13;&#10;        updates.put(&quot;title&quot;, title);&#13;&#10;        updates.put(&quot;description&quot;, description);&#13;&#10;        updates.put(&quot;duration&quot;, duration);&#13;&#10;        updates.put(&quot;level&quot;, level);&#13;&#10;        updates.put(&quot;category&quot;, category);&#13;&#10;        updates.put(&quot;updatedAt&quot;, new Date());&#13;&#10;&#13;&#10;        android.util.Log.d(&quot;EditCourse&quot;, &quot;Updating course with: &quot; + updates);&#13;&#10;&#13;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#13;&#10;            .update(updates)&#13;&#10;            .addOnSuccessListener(aVoid -&gt; {&#13;&#10;                progressBar.setVisibility(View.GONE);&#13;&#10;                btnUpdateCourse.setEnabled(true);&#13;&#10;                Toast.makeText(this, &quot;Cập nhật khóa học thành công!&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;&#13;&#10;                // Cập nhật currentCourse object&#13;&#10;                currentCourse.setTitle(title);&#13;&#10;                currentCourse.setDescription(description);&#13;&#10;                currentCourse.setDuration(duration);&#13;&#10;                currentCourse.setLevel(level);&#13;&#10;                currentCourse.setCategory(category);&#13;&#10;&#13;&#10;                android.util.Log.d(&quot;EditCourse&quot;, &quot;Course updated successfully&quot;);&#13;&#10;            })&#13;&#10;            .addOnFailureListener(e -&gt; {&#13;&#10;                progressBar.setVisibility(View.GONE);&#13;&#10;                btnUpdateCourse.setEnabled(true);&#13;&#10;                Toast.makeText(this, &quot;Lỗi khi cập nhật khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#13;&#10;                android.util.Log.e(&quot;EditCourse&quot;, &quot;Error updating course&quot;, e);&#13;&#10;            });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void deleteCourse() {&#13;&#10;        new androidx.appcompat.app.AlertDialog.Builder(this)&#13;&#10;            .setTitle(&quot;Xác nhận xóa khóa học&quot;)&#13;&#10;            .setMessage(&quot;Bạn có chắc chắn muốn xóa khóa học \&quot;&quot; + currentCourse.getTitle() + &quot;\&quot;?\n\nHành động này sẽ:\n- Xóa khóa học vĩnh viễn\n- Xóa tất cả bài học trong khóa\n- Không thể hoàn tác&quot;)&#13;&#10;            .setPositiveButton(&quot;Xóa&quot;, (dialog, which) -&gt; performDeleteCourse())&#13;&#10;            .setNegativeButton(&quot;Hủy&quot;, null)&#13;&#10;            .setIcon(android.R.drawable.ic_dialog_alert)&#13;&#10;            .show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void performDeleteCourse() {&#13;&#10;        progressBar.setVisibility(View.VISIBLE);&#13;&#10;        btnDeleteCourse.setEnabled(false);&#13;&#10;&#13;&#10;        db.collection(&quot;courses&quot;).document(courseId)&#13;&#10;            .delete()&#13;&#10;            .addOnSuccessListener(aVoid -&gt; {&#13;&#10;                progressBar.setVisibility(View.GONE);&#13;&#10;                Toast.makeText(this, &quot;Đã xóa khóa học thành công&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                android.util.Log.d(&quot;EditCourse&quot;, &quot;Course deleted successfully&quot;);&#13;&#10;&#13;&#10;                // Quay về CourseManagementActivity&#13;&#10;                Intent intent = new Intent(this, CourseManagementActivity.class);&#13;&#10;                intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);&#13;&#10;                startActivity(intent);&#13;&#10;                finish();&#13;&#10;            })&#13;&#10;            .addOnFailureListener(e -&gt; {&#13;&#10;                progressBar.setVisibility(View.GONE);&#13;&#10;                btnDeleteCourse.setEnabled(true);&#13;&#10;                Toast.makeText(this, &quot;Lỗi khi xóa khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#13;&#10;                android.util.Log.e(&quot;EditCourse&quot;, &quot;Error deleting course&quot;, e);&#13;&#10;            });&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#13;&#10;        if (item.getItemId() == android.R.id.home) {&#13;&#10;            finish();&#13;&#10;            return true;&#13;&#10;        }&#13;&#10;        return super.onOptionsItemSelected(item);&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onResume() {&#13;&#10;        super.onResume();&#13;&#10;        // Reload course data when returning to this activity&#13;&#10;        if (courseId != null) {&#13;&#10;            loadCourseData();&#13;&#10;        }&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/EditSingleTestQuestionActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/EditSingleTestQuestionActivity.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.RadioButton;&#10;import android.widget.RadioGroup;&#10;import android.widget.Toast;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.models.SimpleTestQuestion;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class EditSingleTestQuestionActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;EditSingleTestQuestion&quot;;&#10;    &#10;    private Toolbar toolbar;&#10;    private TextInputEditText etQuestion, etOptionA, etOptionB, etOptionC, etOptionD;&#10;    private RadioGroup rgCorrectAnswer;&#10;    private RadioButton rbOptionA, rbOptionB, rbOptionC, rbOptionD;&#10;    private Button btnSaveQuestion, btnDeleteQuestion;&#10;    &#10;    private FirebaseFirestore db;&#10;    private String courseId, courseName, questionId;&#10;    private SimpleTestQuestion currentQuestion;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_edit_single_test_question);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        initFirebase();&#10;        getQuestionInfo();&#10;        setupClickListeners();&#10;        loadQuestionData();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        etQuestion = findViewById(R.id.et_question);&#10;        etOptionA = findViewById(R.id.et_option_a);&#10;        etOptionB = findViewById(R.id.et_option_b);&#10;        etOptionC = findViewById(R.id.et_option_c);&#10;        etOptionD = findViewById(R.id.et_option_d);&#10;        rgCorrectAnswer = findViewById(R.id.rg_correct_answer);&#10;        rbOptionA = findViewById(R.id.rb_option_a);&#10;        rbOptionB = findViewById(R.id.rb_option_b);&#10;        rbOptionC = findViewById(R.id.rb_option_c);&#10;        rbOptionD = findViewById(R.id.rb_option_d);&#10;        btnSaveQuestion = findViewById(R.id.btn_save_question);&#10;        btnDeleteQuestion = findViewById(R.id.btn_delete_question);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Chỉnh sửa câu hỏi&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void initFirebase() {&#10;        db = FirebaseFirestore.getInstance();&#10;    }&#10;&#10;    private void getQuestionInfo() {&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseName = getIntent().getStringExtra(&quot;courseName&quot;);&#10;        questionId = getIntent().getStringExtra(&quot;questionId&quot;);&#10;        &#10;        if (courseName != null) {&#10;            getSupportActionBar().setSubtitle(courseName);&#10;        }&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnSaveQuestion.setOnClickListener(v -&gt; saveQuestion());&#10;        btnDeleteQuestion.setOnClickListener(v -&gt; deleteQuestion());&#10;    }&#10;&#10;    private void loadQuestionData() {&#10;        if (questionId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy ID câu hỏi&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        Log.d(TAG, &quot;Loading question data for ID: &quot; + questionId);&#10;&#10;        db.collection(&quot;test&quot;)&#10;                .document(questionId)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        currentQuestion = documentSnapshot.toObject(SimpleTestQuestion.class);&#10;                        if (currentQuestion != null) {&#10;                            currentQuestion.setDocumentId(documentSnapshot.getId());&#10;                            populateFields();&#10;                        }&#10;                    } else {&#10;                        Toast.makeText(this, &quot;Không tìm thấy câu hỏi&quot;, Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Log.e(TAG, &quot;Error loading question&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi khi tải câu hỏi: &quot; + e.getMessage(), &#10;                                 Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                });&#10;    }&#10;&#10;    private void populateFields() {&#10;        if (currentQuestion == null) return;&#10;&#10;        // Điền nội dung câu hỏi&#10;        etQuestion.setText(currentQuestion.getQuestion());&#10;&#10;        // Điền các lựa chọn&#10;        List&lt;String&gt; options = currentQuestion.getCorrectAnswer();&#10;        if (options != null &amp;&amp; options.size() &gt;= 4) {&#10;            etOptionA.setText(options.get(0));&#10;            etOptionB.setText(options.get(1));&#10;            etOptionC.setText(options.get(2));&#10;            etOptionD.setText(options.get(3));&#10;        }&#10;&#10;        // Chọn đáp án đúng&#10;        int correctIndex = currentQuestion.getOptions();&#10;        switch (correctIndex) {&#10;            case 0:&#10;                rbOptionA.setChecked(true);&#10;                break;&#10;            case 1:&#10;                rbOptionB.setChecked(true);&#10;                break;&#10;            case 2:&#10;                rbOptionC.setChecked(true);&#10;                break;&#10;            case 3:&#10;                rbOptionD.setChecked(true);&#10;                break;&#10;        }&#10;&#10;        Log.d(TAG, &quot;Populated fields for question: &quot; + currentQuestion.getQuestion());&#10;    }&#10;&#10;    private void saveQuestion() {&#10;        if (!validateInput()) {&#10;            return;&#10;        }&#10;&#10;        String questionText = etQuestion.getText().toString().trim();&#10;        List&lt;String&gt; options = new ArrayList&lt;&gt;();&#10;        options.add(etOptionA.getText().toString().trim());&#10;        options.add(etOptionB.getText().toString().trim());&#10;        options.add(etOptionC.getText().toString().trim());&#10;        options.add(etOptionD.getText().toString().trim());&#10;&#10;        int correctAnswerIndex = getCorrectAnswerIndex();&#10;&#10;        // Cập nhật currentQuestion&#10;        currentQuestion.setQuestion(questionText);&#10;        currentQuestion.setCorrectAnswer(options);&#10;        currentQuestion.setOptions(correctAnswerIndex);&#10;&#10;        btnSaveQuestion.setEnabled(false);&#10;        btnSaveQuestion.setText(&quot;Đang lưu...&quot;);&#10;&#10;        Log.d(TAG, &quot;Saving question: &quot; + currentQuestion.toString());&#10;&#10;        db.collection(&quot;test&quot;)&#10;                .document(questionId)&#10;                .set(currentQuestion)&#10;                .addOnSuccessListener(aVoid -&gt; {&#10;                    Log.d(TAG, &quot;Question saved successfully&quot;);&#10;                    Toast.makeText(this, &quot;Đã lưu câu hỏi&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Log.e(TAG, &quot;Error saving question&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi khi lưu câu hỏi: &quot; + e.getMessage(), &#10;                                 Toast.LENGTH_SHORT).show();&#10;                    btnSaveQuestion.setEnabled(true);&#10;                    btnSaveQuestion.setText(&quot;Lưu thay đổi&quot;);&#10;                });&#10;    }&#10;&#10;    private void deleteQuestion() {&#10;        new androidx.appcompat.app.AlertDialog.Builder(this)&#10;                .setTitle(&quot;Xác nhận xóa câu hỏi&quot;)&#10;                .setMessage(&quot;Bạn có chắc chắn muốn xóa câu hỏi này?\n\nHành động này không thể hoàn tác.&quot;)&#10;                .setPositiveButton(&quot;Xóa&quot;, (dialog, which) -&gt; performDeleteQuestion())&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#10;                .setIcon(android.R.drawable.ic_dialog_alert)&#10;                .show();&#10;    }&#10;&#10;    private void performDeleteQuestion() {&#10;        btnDeleteQuestion.setEnabled(false);&#10;        btnDeleteQuestion.setText(&quot;Đang xóa...&quot;);&#10;&#10;        db.collection(&quot;test&quot;)&#10;                .document(questionId)&#10;                .delete()&#10;                .addOnSuccessListener(aVoid -&gt; {&#10;                    Log.d(TAG, &quot;Question deleted successfully&quot;);&#10;                    Toast.makeText(this, &quot;Đã xóa câu hỏi&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Log.e(TAG, &quot;Error deleting question&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi khi xóa câu hỏi: &quot; + e.getMessage(), &#10;                                 Toast.LENGTH_SHORT).show();&#10;                    btnDeleteQuestion.setEnabled(true);&#10;                    btnDeleteQuestion.setText(&quot;Xóa câu hỏi&quot;);&#10;                });&#10;    }&#10;&#10;    private boolean validateInput() {&#10;        String questionText = etQuestion.getText().toString().trim();&#10;        if (questionText.isEmpty()) {&#10;            etQuestion.setError(&quot;Vui lòng nhập nội dung câu hỏi&quot;);&#10;            etQuestion.requestFocus();&#10;            return false;&#10;        }&#10;&#10;        String[] options = {&#10;            etOptionA.getText().toString().trim(),&#10;            etOptionB.getText().toString().trim(),&#10;            etOptionC.getText().toString().trim(),&#10;            etOptionD.getText().toString().trim()&#10;        };&#10;&#10;        for (int i = 0; i &lt; options.length; i++) {&#10;            if (options[i].isEmpty()) {&#10;                switch (i) {&#10;                    case 0:&#10;                        etOptionA.setError(&quot;Vui lòng nhập lựa chọn A&quot;);&#10;                        etOptionA.requestFocus();&#10;                        break;&#10;                    case 1:&#10;                        etOptionB.setError(&quot;Vui lòng nhập lựa chọn B&quot;);&#10;                        etOptionB.requestFocus();&#10;                        break;&#10;                    case 2:&#10;                        etOptionC.setError(&quot;Vui lòng nhập lựa chọn C&quot;);&#10;                        etOptionC.requestFocus();&#10;                        break;&#10;                    case 3:&#10;                        etOptionD.setError(&quot;Vui lòng nhập lựa chọn D&quot;);&#10;                        etOptionD.requestFocus();&#10;                        break;&#10;                }&#10;                return false;&#10;            }&#10;        }&#10;&#10;        if (rgCorrectAnswer.getCheckedRadioButtonId() == -1) {&#10;            Toast.makeText(this, &quot;Vui lòng chọn đáp án đúng&quot;, Toast.LENGTH_SHORT).show();&#10;            return false;&#10;        }&#10;&#10;        return true;&#10;    }&#10;&#10;    private int getCorrectAnswerIndex() {&#10;        int checkedId = rgCorrectAnswer.getCheckedRadioButtonId();&#10;        &#10;        if (checkedId == rbOptionA.getId()) {&#10;            return 0;&#10;        } else if (checkedId == rbOptionB.getId()) {&#10;            return 1;&#10;        } else if (checkedId == rbOptionC.getId()) {&#10;            return 2;&#10;        } else if (checkedId == rbOptionD.getId()) {&#10;            return 3;&#10;        }&#10;        &#10;        return -1;&#10;    }&#10;&#10;    @Override&#10;    public boolean onSupportNavigateUp() {&#10;        onBackPressed();&#10;        return true;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/EditTestQuestionsActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/EditTestQuestionsActivity.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.View;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import com.vantinh.tienganh.adapters.EditTestQuestionAdapter;&#10;import com.vantinh.tienganh.models.SimpleTestQuestion;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class EditTestQuestionsActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;EditTestQuestions&quot;;&#10;    &#10;    private Toolbar toolbar;&#10;    private RecyclerView recyclerView;&#10;    private ProgressBar progressBar;&#10;    private TextView tvNoQuestions;&#10;    private EditTestQuestionAdapter adapter;&#10;    &#10;    private FirebaseFirestore db;&#10;    private String courseId;&#10;    private String courseName;&#10;    private List&lt;SimpleTestQuestion&gt; testQuestions;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_edit_test_questions);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        initFirebase();&#10;        getCourseInfo();&#10;        setupRecyclerView();&#10;        loadTestQuestions();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        recyclerView = findViewById(R.id.rv_test_questions);&#10;        progressBar = findViewById(R.id.progress_bar);&#10;        tvNoQuestions = findViewById(R.id.tv_no_questions);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Chỉnh sửa bài kiểm tra&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void initFirebase() {&#10;        db = FirebaseFirestore.getInstance();&#10;    }&#10;&#10;    private void getCourseInfo() {&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseName = getIntent().getStringExtra(&quot;courseName&quot;);&#10;        &#10;        if (courseName != null) {&#10;            getSupportActionBar().setSubtitle(courseName);&#10;        }&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        testQuestions = new ArrayList&lt;&gt;();&#10;        adapter = new EditTestQuestionAdapter(testQuestions, this::editQuestion, this::deleteQuestion);&#10;        recyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;        recyclerView.setAdapter(adapter);&#10;    }&#10;&#10;    private void loadTestQuestions() {&#10;        progressBar.setVisibility(View.VISIBLE);&#10;        recyclerView.setVisibility(View.GONE);&#10;        tvNoQuestions.setVisibility(View.GONE);&#10;&#10;        Log.d(TAG, &quot;Loading test questions for courseId: &quot; + courseId);&#10;&#10;        db.collection(&quot;test&quot;)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    testQuestions.clear();&#10;                    &#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        SimpleTestQuestion question = document.toObject(SimpleTestQuestion.class);&#10;                        question.setDocumentId(document.getId()); // Lưu document ID để có thể edit/delete&#10;                        testQuestions.add(question);&#10;                        &#10;                        Log.d(TAG, &quot;Loaded question: &quot; + question.getQuestion());&#10;                    }&#10;&#10;                    progressBar.setVisibility(View.GONE);&#10;                    &#10;                    if (testQuestions.isEmpty()) {&#10;                        tvNoQuestions.setVisibility(View.VISIBLE);&#10;                        recyclerView.setVisibility(View.GONE);&#10;                    } else {&#10;                        tvNoQuestions.setVisibility(View.GONE);&#10;                        recyclerView.setVisibility(View.VISIBLE);&#10;                        adapter.notifyDataSetChanged();&#10;                    }&#10;&#10;                    Log.d(TAG, &quot;Total questions loaded: &quot; + testQuestions.size());&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Log.e(TAG, &quot;Error loading test questions&quot;, e);&#10;                    progressBar.setVisibility(View.GONE);&#10;                    tvNoQuestions.setVisibility(View.VISIBLE);&#10;                    tvNoQuestions.setText(&quot;Lỗi khi tải danh sách câu hỏi&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi khi tải danh sách câu hỏi: &quot; + e.getMessage(), &#10;                                 Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void editQuestion(SimpleTestQuestion question) {&#10;        // Chuyển đến activity chỉnh sửa câu hỏi&#10;        Intent intent = new Intent(this, EditSingleTestQuestionActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, courseId);&#10;        intent.putExtra(&quot;courseName&quot;, courseName);&#10;        intent.putExtra(&quot;questionId&quot;, question.getDocumentId());&#10;        intent.putExtra(&quot;question&quot;, question.getQuestion());&#10;        // Truyền thêm dữ liệu khác nếu cần&#10;        startActivity(intent);&#10;    }&#10;&#10;    private void deleteQuestion(SimpleTestQuestion question) {&#10;        // Xóa câu hỏi&#10;        if (question.getDocumentId() != null) {&#10;            db.collection(&quot;test&quot;)&#10;                    .document(question.getDocumentId())&#10;                    .delete()&#10;                    .addOnSuccessListener(aVoid -&gt; {&#10;                        Log.d(TAG, &quot;Question deleted successfully&quot;);&#10;                        Toast.makeText(this, &quot;Đã xóa câu hỏi&quot;, Toast.LENGTH_SHORT).show();&#10;                        loadTestQuestions(); // Reload danh sách&#10;                    })&#10;                    .addOnFailureListener(e -&gt; {&#10;                        Log.e(TAG, &quot;Error deleting question&quot;, e);&#10;                        Toast.makeText(this, &quot;Lỗi khi xóa câu hỏi: &quot; + e.getMessage(), &#10;                                     Toast.LENGTH_SHORT).show();&#10;                    });&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean onSupportNavigateUp() {&#10;        onBackPressed();&#10;        return true;&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Reload danh sách khi quay lại từ activity chỉnh sửa&#10;        loadTestQuestions();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/LessonProgressAdapter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/LessonProgressAdapter.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.ImageView;&#10;import android.widget.TextView;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import java.util.List;&#10;&#10;public class LessonProgressAdapter extends RecyclerView.Adapter&lt;LessonProgressAdapter.LessonProgressViewHolder&gt; {&#10;&#10;    private List&lt;StudentProgressDetailActivity.LessonProgressItem&gt; lessonProgressList;&#10;&#10;    public LessonProgressAdapter(List&lt;StudentProgressDetailActivity.LessonProgressItem&gt; lessonProgressList) {&#10;        this.lessonProgressList = lessonProgressList;&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public LessonProgressViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_lesson_progress, parent, false);&#10;        return new LessonProgressViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull LessonProgressViewHolder holder, int position) {&#10;        StudentProgressDetailActivity.LessonProgressItem item = lessonProgressList.get(position);&#10;&#10;        holder.tvLessonTitle.setText(item.getLessonTitle());&#10;        holder.tvLessonType.setText(item.getLessonType());&#10;&#10;        // Set completion status&#10;        if (item.isCompleted()) {&#10;            holder.ivCompletionStatus.setImageResource(R.drawable.ic_check_circle);&#10;            holder.ivCompletionStatus.setColorFilter(holder.itemView.getContext().getColor(android.R.color.holo_green_dark));&#10;            holder.tvCompletionStatus.setText(&quot;Đã hoàn thành&quot;);&#10;            holder.tvCompletionStatus.setTextColor(holder.itemView.getContext().getColor(android.R.color.holo_green_dark));&#10;        } else {&#10;            holder.ivCompletionStatus.setImageResource(R.drawable.ic_circle_outline);&#10;            holder.ivCompletionStatus.setColorFilter(holder.itemView.getContext().getColor(android.R.color.darker_gray));&#10;            holder.tvCompletionStatus.setText(&quot;Chưa hoàn thành&quot;);&#10;            holder.tvCompletionStatus.setTextColor(holder.itemView.getContext().getColor(android.R.color.darker_gray));&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return lessonProgressList != null ? lessonProgressList.size() : 0;&#10;    }&#10;&#10;    static class LessonProgressViewHolder extends RecyclerView.ViewHolder {&#10;        TextView tvLessonTitle, tvLessonType, tvCompletionStatus;&#10;        ImageView ivCompletionStatus;&#10;&#10;        public LessonProgressViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            tvLessonTitle = itemView.findViewById(R.id.tv_lesson_title);&#10;            tvLessonType = itemView.findViewById(R.id.tv_lesson_type);&#10;            tvCompletionStatus = itemView.findViewById(R.id.tv_completion_status);&#10;            ivCompletionStatus = itemView.findViewById(R.id.iv_completion_status);&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.TextView;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import java.util.List;&#10;&#10;public class LessonProgressAdapter extends RecyclerView.Adapter&lt;LessonProgressAdapter.LessonProgressViewHolder&gt; {&#10;&#10;    private List&lt;StudentProgressDetailActivity.LessonProgressItem&gt; lessonProgressList;&#10;&#10;    public LessonProgressAdapter(List&lt;StudentProgressDetailActivity.LessonProgressItem&gt; lessonProgressList) {&#10;        this.lessonProgressList = lessonProgressList;&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public LessonProgressViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        // Use existing Android layout&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(android.R.layout.simple_list_item_2, parent, false);&#10;        return new LessonProgressViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull LessonProgressViewHolder holder, int position) {&#10;        StudentProgressDetailActivity.LessonProgressItem item = lessonProgressList.get(position);&#10;        &#10;        // Set completion status with emoji icons&#10;        if (item.isCompleted()) {&#10;            holder.tvLessonTitle.setText(&quot;✅ &quot; + item.getLessonTitle());&#10;            holder.tvLessonType.setText(item.getLessonType() + &quot; - Đã hoàn thành&quot;);&#10;            holder.tvLessonType.setTextColor(holder.itemView.getContext().getColor(android.R.color.holo_green_dark));&#10;        } else {&#10;            holder.tvLessonTitle.setText(&quot;⭕ &quot; + item.getLessonTitle());&#10;            holder.tvLessonType.setText(item.getLessonType() + &quot; - Chưa hoàn thành&quot;);&#10;            holder.tvLessonType.setTextColor(holder.itemView.getContext().getColor(android.R.color.darker_gray));&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return lessonProgressList != null ? lessonProgressList.size() : 0;&#10;    }&#10;&#10;    static class LessonProgressViewHolder extends RecyclerView.ViewHolder {&#10;        TextView tvLessonTitle, tvLessonType;&#10;&#10;        public LessonProgressViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            // Use standard Android layout IDs&#10;            tvLessonTitle = itemView.findViewById(android.R.id.text1);&#10;            tvLessonType = itemView.findViewById(android.R.id.text2);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/LoginActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/LoginActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.text.TextUtils;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;import android.widget.TextView;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.app.AlertDialog;&#10;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.auth.FirebaseAuthInvalidCredentialsException;&#10;import com.google.firebase.auth.FirebaseAuthInvalidUserException;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;public class LoginActivity extends AppCompatActivity {&#10;&#10;    private EditText etEmail, etPassword;&#10;    private Button btnLogin;&#10;    private TextView tvRegister;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_login);&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupClickListeners();&#10;&#10;        // Pre-fill test account for easier testing&#10;        etEmail.setText(&quot;quocthao@gmail.com&quot;);&#10;        etPassword.setText(&quot;123456&quot;);&#10;    }&#10;&#10;    private void initViews() {&#10;        etEmail = findViewById(R.id.et_email);&#10;        etPassword = findViewById(R.id.et_password);&#10;        btnLogin = findViewById(R.id.btn_login);&#10;        tvRegister = findViewById(R.id.tv_register);&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnLogin.setOnClickListener(v -&gt; handleLogin());&#10;&#10;        tvRegister.setOnClickListener(v -&gt;&#10;            startActivity(new Intent(LoginActivity.this, RegisterActivity.class)));&#10;&#10;        // Long click to create test account&#10;        btnLogin.setOnLongClickListener(v -&gt; {&#10;            showCreateTestAccountDialog();&#10;            return true;&#10;        });&#10;    }&#10;&#10;    private void handleLogin() {&#10;        String email = etEmail.getText() != null ? etEmail.getText().toString().trim() : &quot;&quot;;&#10;        String password = etPassword.getText() != null ? etPassword.getText().toString().trim() : &quot;&quot;;&#10;&#10;        if (validateInput(email, password)) {&#10;            btnLogin.setEnabled(false);&#10;            btnLogin.setText(&quot;Đang đăng nhập...&quot;);&#10;&#10;            android.util.Log.d(&quot;LoginActivity&quot;, &quot;Attempting to login with email: &quot; + email);&#10;&#10;            mAuth.signInWithEmailAndPassword(email, password)&#10;                .addOnCompleteListener(this, task -&gt; {&#10;                    android.util.Log.d(&quot;LoginActivity&quot;, &quot;Login task completed. Success: &quot; + task.isSuccessful());&#10;&#10;                    if (task.isSuccessful() &amp;&amp; mAuth.getCurrentUser() != null) {&#10;                        String userId = mAuth.getCurrentUser().getUid();&#10;                        android.util.Log.d(&quot;LoginActivity&quot;, &quot;Login successful for user: &quot; + userId);&#10;                        getUserRoleAndRedirect(userId);&#10;                    } else {&#10;                        handleLoginError(task.getException());&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;LoginActivity&quot;, &quot;Login failure&quot;, e);&#10;                    handleLoginError(e);&#10;                });&#10;        }&#10;    }&#10;&#10;    private void handleLoginError(Exception exception) {&#10;        btnLogin.setEnabled(true);&#10;        btnLogin.setText(&quot;Đăng nhập&quot;);&#10;&#10;        String errorMessage = &quot;Đăng nhập thất bại&quot;;&#10;&#10;        if (exception instanceof FirebaseAuthInvalidUserException) {&#10;            errorMessage = &quot;Tài khoản không tồn tại. Bạn có muốn tạo tài khoản này không?&quot;;&#10;            showCreateAccountDialog();&#10;            return;&#10;        } else if (exception instanceof FirebaseAuthInvalidCredentialsException) {&#10;            errorMessage = &quot;Email hoặc mật khẩu không đúng&quot;;&#10;        } else if (exception != null) {&#10;            errorMessage = &quot;Lỗi đăng nhập: &quot; + exception.getMessage();&#10;        }&#10;&#10;        Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();&#10;    }&#10;&#10;    private void showCreateAccountDialog() {&#10;        String email = etEmail.getText().toString().trim();&#10;        String password = etPassword.getText().toString().trim();&#10;&#10;        new AlertDialog.Builder(this)&#10;                .setTitle(&quot;Tạo tài khoản&quot;)&#10;                .setMessage(&quot;Tài khoản &quot; + email + &quot; chưa tồn tại. Bạn có muốn tạo tài khoản này không?&quot;)&#10;                .setPositiveButton(&quot;Tạo tài khoản&quot;, (dialog, which) -&gt; {&#10;                    createAccount(email, password, &quot;student&quot;); // Default to student&#10;                })&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#10;                .show();&#10;    }&#10;&#10;    private void showCreateTestAccountDialog() {&#10;        new AlertDialog.Builder(this)&#10;                .setTitle(&quot;Tạo tài khoản test&quot;)&#10;                .setMessage(&quot;Chọn loại tài khoản test muốn tạo:&quot;)&#10;                .setPositiveButton(&quot;Học viên&quot;, (dialog, which) -&gt; {&#10;                    etEmail.setText(&quot;student@test.com&quot;);&#10;                    etPassword.setText(&quot;123456&quot;);&#10;                    createAccount(&quot;student@test.com&quot;, &quot;123456&quot;, &quot;student&quot;);&#10;                })&#10;                .setNeutralButton(&quot;Giáo viên&quot;, (dialog, which) -&gt; {&#10;                    etEmail.setText(&quot;teacher@test.com&quot;);&#10;                    etPassword.setText(&quot;123456&quot;);&#10;                    createAccount(&quot;teacher@test.com&quot;, &quot;123456&quot;, &quot;teacher&quot;);&#10;                })&#10;                .setNegativeButton(&quot;Admin&quot;, (dialog, which) -&gt; {&#10;                    etEmail.setText(&quot;admin@test.com&quot;);&#10;                    etPassword.setText(&quot;123456&quot;);&#10;                    createAccount(&quot;admin@test.com&quot;, &quot;123456&quot;, &quot;admin&quot;);&#10;                })&#10;                .show();&#10;    }&#10;&#10;    private void createAccount(String email, String password, String role) {&#10;        btnLogin.setEnabled(false);&#10;        btnLogin.setText(&quot;Đang tạo tài khoản...&quot;);&#10;&#10;        mAuth.createUserWithEmailAndPassword(email, password)&#10;                .addOnCompleteListener(task -&gt; {&#10;                    if (task.isSuccessful() &amp;&amp; mAuth.getCurrentUser() != null) {&#10;                        String userId = mAuth.getCurrentUser().getUid();&#10;                        saveUserToFirestore(userId, email, role);&#10;                    } else {&#10;                        btnLogin.setEnabled(true);&#10;                        btnLogin.setText(&quot;Đăng nhập&quot;);&#10;                        String error = task.getException() != null ? task.getException().getMessage() : &quot;Lỗi tạo tài khoản&quot;;&#10;                        Toast.makeText(this, &quot;Tạo tài khoản thất bại: &quot; + error, Toast.LENGTH_LONG).show();&#10;                    }&#10;                });&#10;    }&#10;&#10;    private void saveUserToFirestore(String userId, String email, String role) {&#10;        // Tạo đối tượng User với chỉ 5 trường dữ liệu theo yêu cầu: ID, address, email, fullName, role&#10;        Map&lt;String, Object&gt; userData = new HashMap&lt;&gt;();&#10;        userData.put(&quot;id&quot;, userId);&#10;        userData.put(&quot;email&quot;, email);&#10;        userData.put(&quot;fullName&quot;, getFullNameFromRole(role)); // Sử dụng fullName thay vì name&#10;        userData.put(&quot;address&quot;, &quot;&quot;); // Địa chỉ mặc định trống&#10;        userData.put(&quot;role&quot;, role);&#10;&#10;        // Không lưu createdAt, updatedAt để chỉ có đúng 5 trường theo yêu cầu&#10;&#10;        db.collection(&quot;users&quot;).document(userId)&#10;                .set(userData)&#10;                .addOnSuccessListener(aVoid -&gt; {&#10;                    btnLogin.setEnabled(true);&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#10;                    Toast.makeText(this, &quot;Tạo tài khoản thành công! Đang đăng nhập...&quot;, Toast.LENGTH_SHORT).show();&#10;                    android.util.Log.d(&quot;LoginActivity&quot;, &quot;User saved with 5 fields: &quot; + userData.toString());&#10;                    redirectToRoleActivity(role);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    btnLogin.setEnabled(true);&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#10;                    android.util.Log.e(&quot;LoginActivity&quot;, &quot;Error saving user to Firestore&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi lưu thông tin: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                });&#10;    }&#10;&#10;    private String getFullNameFromRole(String role) {&#10;        switch (role.toLowerCase()) {&#10;            case &quot;admin&quot;: return &quot;Quản trị viên&quot;;&#10;            case &quot;teacher&quot;: return &quot;Giáo viên&quot;;&#10;            case &quot;student&quot;: return &quot;Học viên&quot;;&#10;            default: return &quot;Người dùng&quot;;&#10;        }&#10;    }&#10;&#10;    private void getUserRoleAndRedirect(String userId) {&#10;        android.util.Log.d(&quot;LoginActivity&quot;, &quot;Getting user role for: &quot; + userId);&#10;&#10;        db.collection(&quot;users&quot;).document(userId)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    btnLogin.setEnabled(true);&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#10;&#10;                    if (documentSnapshot.exists()) {&#10;                        String role = documentSnapshot.getString(&quot;role&quot;);&#10;                        android.util.Log.d(&quot;LoginActivity&quot;, &quot;User role found: &quot; + role);&#10;&#10;                        if (role != null) {&#10;                            redirectToRoleActivity(role);&#10;                        } else {&#10;                            android.util.Log.w(&quot;LoginActivity&quot;, &quot;User role is null, defaulting to student&quot;);&#10;                            redirectToRoleActivity(&quot;student&quot;);&#10;                        }&#10;                    } else {&#10;                        android.util.Log.w(&quot;LoginActivity&quot;, &quot;User document does not exist, creating default student profile&quot;);&#10;                        // Create user document if it doesn't exist&#10;                        saveUserToFirestore(userId, mAuth.getCurrentUser().getEmail(), &quot;student&quot;);&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    btnLogin.setEnabled(true);&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#10;                    android.util.Log.e(&quot;LoginActivity&quot;, &quot;Error getting user role&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi lấy thông tin người dùng: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                });&#10;    }&#10;&#10;    private void redirectToRoleActivity(String role) {&#10;        android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to activity for role: &quot; + role);&#10;&#10;        Intent intent;&#10;        switch (role.toLowerCase()) {&#10;            case &quot;admin&quot;:&#10;                intent = new Intent(this, AdminDashboardActivity.class);&#10;                android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to AdminDashboardActivity&quot;);&#10;                break;&#10;            case &quot;teacher&quot;:&#10;                intent = new Intent(this, TeacherDashboardActivity.class);&#10;                android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to TeacherDashboardActivity&quot;);&#10;                break;&#10;            case &quot;student&quot;:&#10;            default:&#10;                intent = new Intent(this, StudentDashboardActivity.class);&#10;                android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to StudentDashboardActivity&quot;);&#10;                break;&#10;        }&#10;&#10;        // Clear the activity stack so user can't go back to login&#10;        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;        startActivity(intent);&#10;        finish();&#10;    }&#10;&#10;    private boolean validateInput(String email, String password) {&#10;        if (TextUtils.isEmpty(email)) {&#10;            etEmail.setError(&quot;Vui lòng nhập email&quot;);&#10;            etEmail.requestFocus();&#10;            return false;&#10;        }&#10;&#10;        if (!android.util.Patterns.EMAIL_ADDRESS.matcher(email).matches()) {&#10;            etEmail.setError(&quot;Email không hợp lệ&quot;);&#10;            etEmail.requestFocus();&#10;            return false;&#10;        }&#10;&#10;        if (TextUtils.isEmpty(password)) {&#10;            etPassword.setError(&quot;Vui lòng nhập mật khẩu&quot;);&#10;            etPassword.requestFocus();&#10;            return false;&#10;        }&#10;&#10;        if (password.length() &lt; 6) {&#10;            etPassword.setError(&quot;Mật khẩu phải có ít nhất 6 ký tự&quot;);&#10;            etPassword.requestFocus();&#10;            return false;&#10;        }&#10;&#10;        return true;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#13;&#10;&#13;&#10;import android.content.Intent;&#13;&#10;import android.os.Bundle;&#13;&#10;import android.text.TextUtils;&#13;&#10;import android.widget.Button;&#13;&#10;import android.widget.EditText;&#13;&#10;import android.widget.Toast;&#13;&#10;import android.widget.TextView;&#13;&#10;&#13;&#10;import androidx.appcompat.app.AppCompatActivity;&#13;&#10;import androidx.appcompat.app.AlertDialog;&#13;&#10;&#13;&#10;import com.google.firebase.auth.FirebaseAuth;&#13;&#10;import com.google.firebase.auth.FirebaseAuthInvalidCredentialsException;&#13;&#10;import com.google.firebase.auth.FirebaseAuthInvalidUserException;&#13;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#13;&#10;&#13;&#10;import java.util.HashMap;&#13;&#10;import java.util.Map;&#13;&#10;&#13;&#10;public class LoginActivity extends AppCompatActivity {&#13;&#10;&#13;&#10;    private EditText etEmail, etPassword;&#13;&#10;    private Button btnLogin;&#13;&#10;    private TextView tvRegister;&#13;&#10;    private FirebaseAuth mAuth;&#13;&#10;    private FirebaseFirestore db;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void onCreate(Bundle savedInstanceState) {&#13;&#10;        super.onCreate(savedInstanceState);&#13;&#10;        setContentView(R.layout.activity_login);&#13;&#10;&#13;&#10;        mAuth = FirebaseAuth.getInstance();&#13;&#10;        db = FirebaseFirestore.getInstance();&#13;&#10;&#13;&#10;        initViews();&#13;&#10;        setupClickListeners();&#13;&#10;&#13;&#10;        // Removed pre-fill test account for production use&#13;&#10;    }&#13;&#10;&#13;&#10;    private void initViews() {&#13;&#10;        etEmail = findViewById(R.id.et_email);&#13;&#10;        etPassword = findViewById(R.id.et_password);&#13;&#10;        btnLogin = findViewById(R.id.btn_login);&#13;&#10;        tvRegister = findViewById(R.id.tv_register);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void setupClickListeners() {&#13;&#10;        btnLogin.setOnClickListener(v -&gt; handleLogin());&#13;&#10;&#13;&#10;        tvRegister.setOnClickListener(v -&gt;&#13;&#10;            startActivity(new Intent(LoginActivity.this, RegisterActivity.class)));&#13;&#10;&#13;&#10;        // Long click to create test account&#13;&#10;        btnLogin.setOnLongClickListener(v -&gt; {&#13;&#10;            showCreateTestAccountDialog();&#13;&#10;            return true;&#13;&#10;        });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void handleLogin() {&#13;&#10;        String email = etEmail.getText() != null ? etEmail.getText().toString().trim() : &quot;&quot;;&#13;&#10;        String password = etPassword.getText() != null ? etPassword.getText().toString().trim() : &quot;&quot;;&#13;&#10;&#13;&#10;        if (validateInput(email, password)) {&#13;&#10;            btnLogin.setEnabled(false);&#13;&#10;            btnLogin.setText(&quot;Đang đăng nhập...&quot;);&#13;&#10;&#13;&#10;            android.util.Log.d(&quot;LoginActivity&quot;, &quot;Attempting to login with email: &quot; + email);&#13;&#10;&#13;&#10;            mAuth.signInWithEmailAndPassword(email, password)&#13;&#10;                .addOnCompleteListener(this, task -&gt; {&#13;&#10;                    android.util.Log.d(&quot;LoginActivity&quot;, &quot;Login task completed. Success: &quot; + task.isSuccessful());&#13;&#10;&#13;&#10;                    if (task.isSuccessful() &amp;&amp; mAuth.getCurrentUser() != null) {&#13;&#10;                        String userId = mAuth.getCurrentUser().getUid();&#13;&#10;                        android.util.Log.d(&quot;LoginActivity&quot;, &quot;Login successful for user: &quot; + userId);&#13;&#10;                        getUserRoleAndRedirect(userId);&#13;&#10;                    } else {&#13;&#10;                        handleLoginError(task.getException());&#13;&#10;                    }&#13;&#10;                })&#13;&#10;                .addOnFailureListener(e -&gt; {&#13;&#10;                    android.util.Log.e(&quot;LoginActivity&quot;, &quot;Login failure&quot;, e);&#13;&#10;                    handleLoginError(e);&#13;&#10;                });&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void handleLoginError(Exception exception) {&#13;&#10;        btnLogin.setEnabled(true);&#13;&#10;        btnLogin.setText(&quot;Đăng nhập&quot;);&#13;&#10;&#13;&#10;        String errorMessage = &quot;Đăng nhập thất bại&quot;;&#13;&#10;&#13;&#10;        if (exception instanceof FirebaseAuthInvalidUserException) {&#13;&#10;            errorMessage = &quot;Tài khoản không tồn tại. Bạn có muốn tạo tài khoản này không?&quot;;&#13;&#10;            showCreateAccountDialog();&#13;&#10;            return;&#13;&#10;        } else if (exception instanceof FirebaseAuthInvalidCredentialsException) {&#13;&#10;            errorMessage = &quot;Email hoặc mật khẩu không đúng&quot;;&#13;&#10;        } else if (exception != null) {&#13;&#10;            errorMessage = &quot;Lỗi đăng nhập: &quot; + exception.getMessage();&#13;&#10;        }&#13;&#10;&#13;&#10;        Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void showCreateAccountDialog() {&#13;&#10;        String email = etEmail.getText().toString().trim();&#13;&#10;        String password = etPassword.getText().toString().trim();&#13;&#10;&#13;&#10;        new AlertDialog.Builder(this)&#13;&#10;                .setTitle(&quot;Tạo tài khoản&quot;)&#13;&#10;                .setMessage(&quot;Tài khoản &quot; + email + &quot; chưa tồn tại. Bạn có muốn tạo tài khoản này không?&quot;)&#13;&#10;                .setPositiveButton(&quot;Tạo tài khoản&quot;, (dialog, which) -&gt; {&#13;&#10;                    createAccount(email, password, &quot;student&quot;); // Default to student&#13;&#10;                })&#13;&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#13;&#10;                .show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void showCreateTestAccountDialog() {&#13;&#10;        new AlertDialog.Builder(this)&#13;&#10;                .setTitle(&quot;Tạo tài khoản test&quot;)&#13;&#10;                .setMessage(&quot;Chọn loại tài khoản test muốn tạo:&quot;)&#13;&#10;                .setPositiveButton(&quot;Học viên&quot;, (dialog, which) -&gt; {&#13;&#10;                    etEmail.setText(&quot;student@test.com&quot;);&#13;&#10;                    etPassword.setText(&quot;123456&quot;);&#13;&#10;                    createAccount(&quot;student@test.com&quot;, &quot;123456&quot;, &quot;student&quot;);&#13;&#10;                })&#13;&#10;                .setNeutralButton(&quot;Giáo viên&quot;, (dialog, which) -&gt; {&#13;&#10;                    etEmail.setText(&quot;teacher@test.com&quot;);&#13;&#10;                    etPassword.setText(&quot;123456&quot;);&#13;&#10;                    createAccount(&quot;teacher@test.com&quot;, &quot;123456&quot;, &quot;teacher&quot;);&#13;&#10;                })&#13;&#10;                .setNegativeButton(&quot;Admin&quot;, (dialog, which) -&gt; {&#13;&#10;                    etEmail.setText(&quot;admin@test.com&quot;);&#13;&#10;                    etPassword.setText(&quot;123456&quot;);&#13;&#10;                    createAccount(&quot;admin@test.com&quot;, &quot;123456&quot;, &quot;admin&quot;);&#13;&#10;                })&#13;&#10;                .show();&#13;&#10;    }&#13;&#10;&#13;&#10;    private void createAccount(String email, String password, String role) {&#13;&#10;        btnLogin.setEnabled(false);&#13;&#10;        btnLogin.setText(&quot;Đang tạo tài khoản...&quot;);&#13;&#10;&#13;&#10;        mAuth.createUserWithEmailAndPassword(email, password)&#13;&#10;                .addOnCompleteListener(task -&gt; {&#13;&#10;                    if (task.isSuccessful() &amp;&amp; mAuth.getCurrentUser() != null) {&#13;&#10;                        String userId = mAuth.getCurrentUser().getUid();&#13;&#10;                        saveUserToFirestore(userId, email, role);&#13;&#10;                    } else {&#13;&#10;                        btnLogin.setEnabled(true);&#13;&#10;                        btnLogin.setText(&quot;Đăng nhập&quot;);&#13;&#10;                        String error = task.getException() != null ? task.getException().getMessage() : &quot;Lỗi tạo tài khoản&quot;;&#13;&#10;                        Toast.makeText(this, &quot;Tạo tài khoản thất bại: &quot; + error, Toast.LENGTH_LONG).show();&#13;&#10;                    }&#13;&#10;                });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void saveUserToFirestore(String userId, String email, String role) {&#13;&#10;        // Tạo đối tượng User với chỉ 5 trường dữ liệu theo yêu cầu: ID, address, email, fullName, role&#13;&#10;        Map&lt;String, Object&gt; userData = new HashMap&lt;&gt;();&#13;&#10;        userData.put(&quot;id&quot;, userId);&#13;&#10;        userData.put(&quot;email&quot;, email);&#13;&#10;        userData.put(&quot;fullName&quot;, getFullNameFromRole(role)); // Sử dụng fullName thay vì name&#13;&#10;        userData.put(&quot;address&quot;, &quot;&quot;); // Địa chỉ mặc định trống&#13;&#10;        userData.put(&quot;role&quot;, role);&#13;&#10;&#13;&#10;        // Không lưu createdAt, updatedAt để chỉ có đúng 5 trường theo yêu cầu&#13;&#10;&#13;&#10;        db.collection(&quot;users&quot;).document(userId)&#13;&#10;                .set(userData)&#13;&#10;                .addOnSuccessListener(aVoid -&gt; {&#13;&#10;                    btnLogin.setEnabled(true);&#13;&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#13;&#10;                    Toast.makeText(this, &quot;Tạo tài khoản thành công! Đang đăng nhập...&quot;, Toast.LENGTH_SHORT).show();&#13;&#10;                    android.util.Log.d(&quot;LoginActivity&quot;, &quot;User saved with 5 fields: &quot; + userData.toString());&#13;&#10;                    redirectToRoleActivity(role);&#13;&#10;                })&#13;&#10;                .addOnFailureListener(e -&gt; {&#13;&#10;                    btnLogin.setEnabled(true);&#13;&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#13;&#10;                    android.util.Log.e(&quot;LoginActivity&quot;, &quot;Error saving user to Firestore&quot;, e);&#13;&#10;                    Toast.makeText(this, &quot;Lỗi lưu thông tin: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#13;&#10;                });&#13;&#10;    }&#13;&#10;&#13;&#10;    private String getFullNameFromRole(String role) {&#13;&#10;        switch (role.toLowerCase()) {&#13;&#10;            case &quot;admin&quot;: return &quot;Quản trị viên&quot;;&#13;&#10;            case &quot;teacher&quot;: return &quot;Giáo viên&quot;;&#13;&#10;            case &quot;student&quot;: return &quot;Học viên&quot;;&#13;&#10;            default: return &quot;Người dùng&quot;;&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private void getUserRoleAndRedirect(String userId) {&#13;&#10;        android.util.Log.d(&quot;LoginActivity&quot;, &quot;Getting user role for: &quot; + userId);&#13;&#10;&#13;&#10;        db.collection(&quot;users&quot;).document(userId)&#13;&#10;                .get()&#13;&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#13;&#10;                    btnLogin.setEnabled(true);&#13;&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#13;&#10;&#13;&#10;                    if (documentSnapshot.exists()) {&#13;&#10;                        String role = documentSnapshot.getString(&quot;role&quot;);&#13;&#10;                        android.util.Log.d(&quot;LoginActivity&quot;, &quot;User role found: &quot; + role);&#13;&#10;&#13;&#10;                        if (role != null) {&#13;&#10;                            redirectToRoleActivity(role);&#13;&#10;                        } else {&#13;&#10;                            android.util.Log.w(&quot;LoginActivity&quot;, &quot;User role is null, defaulting to student&quot;);&#13;&#10;                            redirectToRoleActivity(&quot;student&quot;);&#13;&#10;                        }&#13;&#10;                    } else {&#13;&#10;                        android.util.Log.w(&quot;LoginActivity&quot;, &quot;User document does not exist, creating default student profile&quot;);&#13;&#10;                        // Create user document if it doesn't exist&#13;&#10;                        saveUserToFirestore(userId, mAuth.getCurrentUser().getEmail(), &quot;student&quot;);&#13;&#10;                    }&#13;&#10;                })&#13;&#10;                .addOnFailureListener(e -&gt; {&#13;&#10;                    btnLogin.setEnabled(true);&#13;&#10;                    btnLogin.setText(&quot;Đăng nhập&quot;);&#13;&#10;                    android.util.Log.e(&quot;LoginActivity&quot;, &quot;Error getting user role&quot;, e);&#13;&#10;                    Toast.makeText(this, &quot;Lỗi lấy thông tin người dùng: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#13;&#10;                });&#13;&#10;    }&#13;&#10;&#13;&#10;    private void redirectToRoleActivity(String role) {&#13;&#10;        android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to activity for role: &quot; + role);&#13;&#10;&#13;&#10;        Intent intent;&#13;&#10;        switch (role.toLowerCase()) {&#13;&#10;            case &quot;admin&quot;:&#13;&#10;                intent = new Intent(this, AdminDashboardActivity.class);&#13;&#10;                android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to AdminDashboardActivity&quot;);&#13;&#10;                break;&#13;&#10;            case &quot;teacher&quot;:&#13;&#10;                intent = new Intent(this, TeacherDashboardActivity.class);&#13;&#10;                android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to TeacherDashboardActivity&quot;);&#13;&#10;                break;&#13;&#10;            case &quot;student&quot;:&#13;&#10;            default:&#13;&#10;                intent = new Intent(this, StudentDashboardActivity.class);&#13;&#10;                android.util.Log.d(&quot;LoginActivity&quot;, &quot;Redirecting to StudentDashboardActivity&quot;);&#13;&#10;                break;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Clear the activity stack so user can't go back to login&#13;&#10;        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#13;&#10;        startActivity(intent);&#13;&#10;        finish();&#13;&#10;    }&#13;&#10;&#13;&#10;    private boolean validateInput(String email, String password) {&#13;&#10;        if (TextUtils.isEmpty(email)) {&#13;&#10;            etEmail.setError(&quot;Vui lòng nhập email&quot;);&#13;&#10;            etEmail.requestFocus();&#13;&#10;            return false;&#13;&#10;        }&#13;&#10;&#13;&#10;        if (!android.util.Patterns.EMAIL_ADDRESS.matcher(email).matches()) {&#13;&#10;            etEmail.setError(&quot;Email không hợp lệ&quot;);&#13;&#10;            etEmail.requestFocus();&#13;&#10;            return false;&#13;&#10;        }&#13;&#10;&#13;&#10;        if (TextUtils.isEmpty(password)) {&#13;&#10;            etPassword.setError(&quot;Vui lòng nhập mật khẩu&quot;);&#13;&#10;            etPassword.requestFocus();&#13;&#10;            return false;&#13;&#10;        }&#13;&#10;&#13;&#10;        if (password.length() &lt; 6) {&#13;&#10;            etPassword.setError(&quot;Mật khẩu phải có ít nhất 6 ký tự&quot;);&#13;&#10;            etPassword.requestFocus();&#13;&#10;            return false;&#13;&#10;        }&#13;&#10;&#13;&#10;        return true;&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentCourseDetailActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentCourseDetailActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;&#10;public class StudentCourseDetailActivity extends AppCompatActivity {&#10;&#10;    private TextView tvCourseTitle, tvCourseDescription, tvCourseCategory, tvCourseLevel;&#10;    private TextView tvCourseDuration, tvTotalLessons, tvCompletedLessons;&#10;    private TextView tvEnrollmentDate, tvProgressPercentage;&#10;    private ProgressBar progressBarCompletion;&#10;    private Button btnStartLearning, btnViewLessons, btnViewProgress;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String courseId, courseTitle, courseCategory, enrollmentId;&#10;    private Course currentCourse;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_course_detail);&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;        courseCategory = getIntent().getStringExtra(&quot;courseCategory&quot;);&#10;        enrollmentId = getIntent().getStringExtra(&quot;enrollmentId&quot;);&#10;&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupClickListeners();&#10;        loadCourseData();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        tvCourseTitle = findViewById(R.id.tv_course_title);&#10;        tvCourseDescription = findViewById(R.id.tv_course_description);&#10;        tvCourseCategory = findViewById(R.id.tv_course_category);&#10;        tvCourseLevel = findViewById(R.id.tv_course_level);&#10;        tvCourseDuration = findViewById(R.id.tv_course_duration);&#10;        tvTotalLessons = findViewById(R.id.tv_total_lessons);&#10;        tvCompletedLessons = findViewById(R.id.tv_completed_lessons);&#10;        tvEnrollmentDate = findViewById(R.id.tv_enrollment_date);&#10;        tvProgressPercentage = findViewById(R.id.tv_progress_percentage);&#10;        progressBarCompletion = findViewById(R.id.progress_bar_completion);&#10;        btnStartLearning = findViewById(R.id.btn_start_learning);&#10;        btnViewLessons = findViewById(R.id.btn_view_lessons);&#10;        btnViewProgress = findViewById(R.id.btn_view_progress);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Chi tiết khóa học&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnStartLearning.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, StudentCourseLessonsActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;            intent.putExtra(&quot;courseCategory&quot;, courseCategory);&#10;            startActivity(intent);&#10;        });&#10;&#10;        btnViewLessons.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, StudentCourseLessonsActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;            intent.putExtra(&quot;courseCategory&quot;, courseCategory);&#10;            startActivity(intent);&#10;        });&#10;&#10;        btnViewProgress.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, StudentProgressDetailActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;            startActivity(intent);&#10;        });&#10;    }&#10;&#10;    private void loadCourseData() {&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;            .get()&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#10;                if (documentSnapshot.exists()) {&#10;                    currentCourse = documentSnapshot.toObject(Course.class);&#10;                    if (currentCourse != null) {&#10;                        currentCourse.setId(documentSnapshot.getId());&#10;                        displayCourseInfo();&#10;                        loadProgressData();&#10;                    }&#10;                } else {&#10;                    Toast.makeText(this, &quot;Không tìm thấy khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseDetail&quot;, &quot;Error loading course&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;            });&#10;    }&#10;&#10;    private void displayCourseInfo() {&#10;        tvCourseTitle.setText(currentCourse.getTitle());&#10;        tvCourseDescription.setText(currentCourse.getDescription());&#10;        tvCourseCategory.setText(currentCourse.getCategory());&#10;        tvCourseLevel.setText(currentCourse.getLevel());&#10;        tvCourseDuration.setText(currentCourse.getDuration() + &quot; giờ&quot;);&#10;    }&#10;&#10;    private void loadProgressData() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        // Load lesson count&#10;        db.collection(&quot;lessons&quot;)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .whereEqualTo(&quot;isPublished&quot;, true)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                int totalLessons = queryDocumentSnapshots.size();&#10;                tvTotalLessons.setText(&quot;Tổng số bài: &quot; + totalLessons);&#10;&#10;                // Load completed lessons count&#10;                loadCompletedLessonsCount(studentId, totalLessons);&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseDetail&quot;, &quot;Error loading lessons&quot;, e);&#10;                tvTotalLessons.setText(&quot;Tổng số bài: N/A&quot;);&#10;                tvCompletedLessons.setText(&quot;Đã học: N/A&quot;);&#10;                tvProgressPercentage.setText(&quot;0% hoàn thành&quot;);&#10;                progressBarCompletion.setProgress(0);&#10;            });&#10;    }&#10;&#10;    private void loadCompletedLessonsCount(String studentId, int totalLessons) {&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int completedLessons = queryDocumentSnapshots.size();&#10;                    tvCompletedLessons.setText(&quot;Đã học: &quot; + completedLessons);&#10;&#10;                    // Calculate progress&#10;                    int progress = totalLessons &gt; 0 ? (completedLessons * 100) / totalLessons : 0;&#10;                    progressBarCompletion.setProgress(progress);&#10;                    tvProgressPercentage.setText(progress + &quot;% hoàn thành (&quot; + completedLessons + &quot;/&quot; + totalLessons + &quot;)&quot;);&#10;&#10;                    android.util.Log.d(&quot;StudentCourseDetail&quot;, &quot;Progress calculated: &quot; + completedLessons + &quot;/&quot; + totalLessons + &quot; = &quot; + progress + &quot;%&quot;);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentCourseDetail&quot;, &quot;Error loading completed lessons&quot;, e);&#10;                    tvCompletedLessons.setText(&quot;Đã học: 0&quot;);&#10;                    tvProgressPercentage.setText(&quot;0% hoàn thành (0/&quot; + totalLessons + &quot;)&quot;);&#10;                    progressBarCompletion.setProgress(0);&#10;                });&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Refresh progress data when returning to this activity&#10;        if (currentCourse != null) {&#10;            loadProgressData();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;&#10;public class StudentCourseDetailActivity extends AppCompatActivity {&#10;&#10;    private TextView tvCourseTitle, tvCourseDescription, tvCourseCategory, tvCourseLevel;&#10;    private TextView tvCourseDuration, tvTotalLessons, tvCompletedLessons;&#10;    private TextView tvEnrollmentDate, tvProgressPercentage;&#10;    private ProgressBar progressBarCompletion;&#10;    private Button btnStartLearning, btnViewLessons, btnViewProgress;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String courseId, courseTitle, courseCategory, enrollmentId;&#10;    private Course currentCourse;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_course_detail);&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;        courseCategory = getIntent().getStringExtra(&quot;courseCategory&quot;);&#10;        enrollmentId = getIntent().getStringExtra(&quot;enrollmentId&quot;);&#10;&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupClickListeners();&#10;        loadCourseData();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        tvCourseTitle = findViewById(R.id.tv_course_title);&#10;        tvCourseDescription = findViewById(R.id.tv_course_description);&#10;        tvCourseCategory = findViewById(R.id.tv_course_category);&#10;        tvCourseLevel = findViewById(R.id.tv_course_level);&#10;        tvCourseDuration = findViewById(R.id.tv_course_duration);&#10;        tvTotalLessons = findViewById(R.id.tv_total_lessons);&#10;        tvCompletedLessons = findViewById(R.id.tv_completed_lessons);&#10;        tvEnrollmentDate = findViewById(R.id.tv_enrollment_date);&#10;        tvProgressPercentage = findViewById(R.id.tv_progress_percentage);&#10;        progressBarCompletion = findViewById(R.id.progress_bar_completion);&#10;        btnStartLearning = findViewById(R.id.btn_start_learning);&#10;        btnViewLessons = findViewById(R.id.btn_view_lessons);&#10;        btnViewProgress = findViewById(R.id.btn_view_progress);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Chi tiết khóa học&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnStartLearning.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, StudentCourseLessonsActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;            intent.putExtra(&quot;courseCategory&quot;, courseCategory);&#10;            startActivity(intent);&#10;        });&#10;&#10;        btnViewLessons.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, StudentCourseLessonsActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;            intent.putExtra(&quot;courseCategory&quot;, courseCategory);&#10;            startActivity(intent);&#10;        });&#10;&#10;        btnViewProgress.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, StudentProgressDetailActivity.class);&#10;            intent.putExtra(&quot;courseId&quot;, courseId);&#10;            intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;            startActivity(intent);&#10;        });&#10;    }&#10;&#10;    private void loadCourseData() {&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;            .get()&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#10;                if (documentSnapshot.exists()) {&#10;                    currentCourse = documentSnapshot.toObject(Course.class);&#10;                    if (currentCourse != null) {&#10;                        currentCourse.setId(documentSnapshot.getId());&#10;                        displayCourseInfo();&#10;                        loadProgressData();&#10;                    }&#10;                } else {&#10;                    Toast.makeText(this, &quot;Không tìm thấy khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseDetail&quot;, &quot;Error loading course&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;            });&#10;    }&#10;&#10;    private void displayCourseInfo() {&#10;        tvCourseTitle.setText(currentCourse.getTitle());&#10;        tvCourseDescription.setText(currentCourse.getDescription());&#10;        tvCourseCategory.setText(currentCourse.getCategory());&#10;        tvCourseLevel.setText(currentCourse.getLevel());&#10;        tvCourseDuration.setText(currentCourse.getDuration() + &quot; giờ&quot;);&#10;    }&#10;&#10;    private void loadProgressData() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        // Load lesson count&#10;        db.collection(&quot;lessons&quot;)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .whereEqualTo(&quot;isPublished&quot;, true)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                int totalLessons = queryDocumentSnapshots.size();&#10;                tvTotalLessons.setText(&quot;Tổng số bài: &quot; + totalLessons);&#10;&#10;                // Load completed lessons count&#10;                loadCompletedLessonsCount(studentId, totalLessons);&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseDetail&quot;, &quot;Error loading lessons&quot;, e);&#10;                tvTotalLessons.setText(&quot;Tổng số bài: N/A&quot;);&#10;                tvCompletedLessons.setText(&quot;Đã học: N/A&quot;);&#10;                tvProgressPercentage.setText(&quot;0% hoàn thành&quot;);&#10;                progressBarCompletion.setProgress(0);&#10;            });&#10;    }&#10;&#10;    private void loadCompletedLessonsCount(String studentId, int totalLessons) {&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int completedLessons = queryDocumentSnapshots.size();&#10;                    &#10;                    // Update UI with detailed progress information&#10;                    tvCompletedLessons.setText(&quot;Đã học: &quot; + completedLessons);&#10;&#10;                    // Calculate progress percentage&#10;                    int progress = totalLessons &gt; 0 ? (completedLessons * 100) / totalLessons : 0;&#10;                    progressBarCompletion.setProgress(progress);&#10;                    &#10;                    // Enhanced progress display with fraction and percentage&#10;                    String progressText = completedLessons + &quot;/&quot; + totalLessons + &quot; bài học (&quot; + progress + &quot;% hoàn thành)&quot;;&#10;                    tvProgressPercentage.setText(progressText);&#10;                    &#10;                    // Log for debugging&#10;                    android.util.Log.d(&quot;StudentCourseDetail&quot;, &quot;Progress updated: &quot; + completedLessons + &quot;/&quot; + totalLessons + &quot; = &quot; + progress + &quot;%&quot;);&#10;                    &#10;                    // Show completion status message&#10;                    if (completedLessons == totalLessons &amp;&amp; totalLessons &gt; 0) {&#10;                        Toast.makeText(this, &quot; Chúc mừng! Bạn đã hoàn thành toàn bộ khóa học!&quot;, Toast.LENGTH_LONG).show();&#10;                    } else if (completedLessons &gt; 0) {&#10;                        Toast.makeText(this, &quot;Tiến độ: &quot; + progressText, Toast.LENGTH_SHORT).show();&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentCourseDetail&quot;, &quot;Error loading completed lessons&quot;, e);&#10;                    tvCompletedLessons.setText(&quot;Đã học: 0&quot;);&#10;                    tvProgressPercentage.setText(&quot;0/&quot; + totalLessons + &quot; bài học (0% hoàn thành)&quot;);&#10;                    progressBarCompletion.setProgress(0);&#10;                });&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Refresh progress data when returning from lesson to show updated progress&#10;        if (currentCourse != null) {&#10;            loadProgressData();&#10;        }&#10;    }&#10;&#10;    // Add method to manually refresh progress (can be called from other activities)&#10;    public void refreshProgressData() {&#10;        loadProgressData();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentCourseLessonsActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentCourseLessonsActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.LinearLayout;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class StudentCourseLessonsActivity extends AppCompatActivity implements StudentLessonAdapter.OnLessonClickListener {&#10;&#10;    private RecyclerView rvLessons;&#10;    private LinearLayout layoutNoLessons;&#10;    private TextView tvCourseTitle, tvCourseInfo;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private List&lt;Lesson&gt; lessonList;&#10;    private StudentLessonAdapter lessonAdapter;&#10;&#10;    private String courseId;&#10;    private String courseTitle;&#10;    private String courseCategory;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_course_lessons);&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;        courseCategory = getIntent().getStringExtra(&quot;courseCategory&quot;);&#10;&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;        lessonList = new ArrayList&lt;&gt;();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupRecyclerView();&#10;        loadLessons();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        rvLessons = findViewById(R.id.rv_lessons);&#10;        layoutNoLessons = findViewById(R.id.layout_no_lessons);&#10;        tvCourseTitle = findViewById(R.id.tv_course_title);&#10;        tvCourseInfo = findViewById(R.id.tv_course_info);&#10;&#10;        tvCourseTitle.setText(courseTitle);&#10;        tvCourseInfo.setText(&quot;Danh mục: &quot; + courseCategory);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Bài học&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        lessonAdapter = new StudentLessonAdapter(lessonList, this);&#10;        rvLessons.setLayoutManager(new LinearLayoutManager(this));&#10;        rvLessons.setAdapter(lessonAdapter);&#10;    }&#10;&#10;    private void loadLessons() {&#10;        layoutNoLessons.setVisibility(View.VISIBLE);&#10;        rvLessons.setVisibility(View.GONE);&#10;&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;=== DEBUG: Starting loadLessons ===&quot;);&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;CourseId: &quot; + courseId);&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;CourseTitle: &quot; + courseTitle);&#10;&#10;        // DEBUG: First try loading ALL lessons for this course (ignore isPublished)&#10;        db.collection(&quot;lessons&quot;)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                lessonList.clear();&#10;&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;=== FIREBASE SUCCESS ===&quot;);&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Total lessons found (all): &quot; + queryDocumentSnapshots.size());&#10;&#10;                int publishedCount = 0;&#10;                int unpublishedCount = 0;&#10;&#10;                for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                    android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Document ID: &quot; + document.getId());&#10;                    android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Document data: &quot; + document.getData());&#10;&#10;                    Lesson lesson = document.toObject(Lesson.class);&#10;                    lesson.setId(document.getId());&#10;&#10;                    // Check if isPublished field exists and its value&#10;                    Boolean isPublished = document.getBoolean(&quot;isPublished&quot;);&#10;                    android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Lesson: &quot; + lesson.getTitle() +&#10;                        &quot;, isPublished field: &quot; + isPublished +&#10;                        &quot;, Order: &quot; + lesson.getOrder());&#10;&#10;                    if (isPublished != null &amp;&amp; isPublished) {&#10;                        publishedCount++;&#10;                    } else {&#10;                        unpublishedCount++;&#10;                    }&#10;&#10;                    // Set all lessons as accessible for now (ignore published status for debugging)&#10;                    lesson.setAccessible(true);&#10;                    lesson.setLocked(false);&#10;                    lesson.setCompleted(false);&#10;&#10;                    lessonList.add(lesson);&#10;                }&#10;&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Published lessons: &quot; + publishedCount);&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Unpublished lessons: &quot; + unpublishedCount);&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Total lessons added: &quot; + lessonList.size());&#10;&#10;                // Sort lessons by order&#10;                lessonList.sort((l1, l2) -&gt; Integer.compare(l1.getOrder(), l2.getOrder()));&#10;&#10;                // Show lessons immediately&#10;                showLessonsDirectly();&#10;&#10;                // Then load progress in background&#10;                if (mAuth.getCurrentUser() != null) {&#10;                    loadLessonProgressStatus();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;=== FIREBASE ERROR ===&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải bài học: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                layoutNoLessons.setVisibility(View.VISIBLE);&#10;                rvLessons.setVisibility(View.GONE);&#10;            });&#10;    }&#10;&#10;    private void loadLessonProgressStatus() {&#10;        if (mAuth.getCurrentUser() == null || lessonList.isEmpty()) {&#10;            showLessonsDirectly();&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        // Load all progress records for this student and course&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    // Create a set of completed lesson IDs&#10;                    java.util.Set&lt;String&gt; completedLessonIds = new java.util.HashSet&lt;&gt;();&#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        String lessonId = document.getString(&quot;lessonId&quot;);&#10;                        if (lessonId != null) {&#10;                            completedLessonIds.add(lessonId);&#10;                        }&#10;                    }&#10;&#10;                    // Update lesson completion status and accessibility&#10;                    for (int i = 0; i &lt; lessonList.size(); i++) {&#10;                        Lesson lesson = lessonList.get(i);&#10;&#10;                        // Set completion status&#10;                        boolean isCompleted = completedLessonIds.contains(lesson.getId());&#10;                        lesson.setCompleted(isCompleted);&#10;&#10;                        // Set accessibility: first lesson is always accessible,&#10;                        // subsequent lessons are accessible if previous lesson is completed&#10;                        if (i == 0) {&#10;                            lesson.setAccessible(true);&#10;                            lesson.setLocked(false);&#10;                        } else {&#10;                            Lesson previousLesson = lessonList.get(i - 1);&#10;                            boolean isAccessible = previousLesson.isCompleted();&#10;                            lesson.setAccessible(isAccessible);&#10;                            lesson.setLocked(!isAccessible);&#10;                        }&#10;                    }&#10;&#10;                    android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Progress loaded. Completed lessons: &quot; + completedLessonIds.size());&#10;                    showLessonsDirectly();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;Error loading lesson progress&quot;, e);&#10;                    // Show lessons without progress status if loading fails&#10;                    showLessonsDirectly();&#10;                });&#10;    }&#10;&#10;    private void showLessonsDirectly() {&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;=== SHOWING LESSONS ===&quot;);&#10;&#10;        if (lessonList.isEmpty()) {&#10;            android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Lesson list is empty - showing no lessons layout&quot;);&#10;            layoutNoLessons.setVisibility(View.VISIBLE);&#10;            rvLessons.setVisibility(View.GONE);&#10;            Toast.makeText(this, &quot;Khóa học này chưa có bài học nào&quot;, Toast.LENGTH_SHORT).show();&#10;        } else {&#10;            android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Showing &quot; + lessonList.size() + &quot; lessons in RecyclerView&quot;);&#10;&#10;            layoutNoLessons.setVisibility(View.GONE);&#10;            rvLessons.setVisibility(View.VISIBLE);&#10;            lessonAdapter.notifyDataSetChanged();&#10;&#10;            Toast.makeText(this, &quot;Đã tải &quot; + lessonList.size() + &quot; bài học&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    private String currentStudentId;&#10;&#10;    private void getCurrentStudentId(Runnable onComplete) {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        String firebaseUid = mAuth.getCurrentUser().getUid();&#10;&#10;        db.collection(&quot;users&quot;).document(firebaseUid)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        currentStudentId = documentSnapshot.getString(&quot;id&quot;);&#10;                        onComplete.run();&#10;                    } else {&#10;                        Toast.makeText(this, &quot;Không tìm thấy thông tin học viên&quot;, Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;Error loading student info&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải thông tin học viên&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                });&#10;    }&#10;&#10;    private void loadStudentProgress() {&#10;        if (currentStudentId == null) {&#10;            updateUI();&#10;            return;&#10;        }&#10;&#10;        // Load student progress from lessonProgress collection&#10;        db.collection(&quot;lessonProgress&quot;)&#10;            .whereEqualTo(&quot;studentId&quot;, currentStudentId)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                // Mark completed lessons and determine next available lesson&#10;                java.util.Set&lt;String&gt; completedLessons = new java.util.HashSet&lt;&gt;();&#10;&#10;                for (QueryDocumentSnapshot doc : queryDocumentSnapshots) {&#10;                    String lessonId = doc.getString(&quot;lessonId&quot;);&#10;                    Boolean isCompleted = doc.getBoolean(&quot;isCompleted&quot;);&#10;                    if (lessonId != null &amp;&amp; Boolean.TRUE.equals(isCompleted)) {&#10;                        completedLessons.add(lessonId);&#10;                    }&#10;                }&#10;&#10;                // Update lesson accessibility based on progress&#10;                updateLessonAccessibility(completedLessons);&#10;                updateUI();&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;Error loading progress&quot;, e);&#10;                // If no progress data, allow access to first lesson only&#10;                updateLessonAccessibility(new java.util.HashSet&lt;&gt;());&#10;                updateUI();&#10;            });&#10;    }&#10;&#10;    private void updateLessonAccessibility(java.util.Set&lt;String&gt; completedLessons) {&#10;        for (int i = 0; i &lt; lessonList.size(); i++) {&#10;            Lesson lesson = lessonList.get(i);&#10;&#10;            if (i == 0) {&#10;                // First lesson is always accessible&#10;                lesson.setAccessible(true);&#10;                lesson.setLocked(false);&#10;            } else {&#10;                // Other lessons are only accessible if previous lesson is completed&#10;                Lesson previousLesson = lessonList.get(i - 1);&#10;                boolean previousCompleted = completedLessons.contains(previousLesson.getId());&#10;&#10;                lesson.setAccessible(previousCompleted);&#10;                lesson.setLocked(!previousCompleted);&#10;            }&#10;&#10;            // Mark if lesson is completed&#10;            lesson.setCompleted(completedLessons.contains(lesson.getId()));&#10;&#10;            android.util.Log.d(&quot;StudentCourseLessons&quot;,&#10;                &quot;Lesson &quot; + lesson.getOrder() + &quot;: &quot; + lesson.getTitle() +&#10;                &quot; - Accessible: &quot; + lesson.isAccessible() +&#10;                &quot; - Completed: &quot; + lesson.isCompleted());&#10;        }&#10;    }&#10;&#10;    private void updateUI() {&#10;        if (lessonList.isEmpty()) {&#10;            layoutNoLessons.setVisibility(View.VISIBLE);&#10;            rvLessons.setVisibility(View.GONE);&#10;        } else {&#10;            layoutNoLessons.setVisibility(View.GONE);&#10;            rvLessons.setVisibility(View.VISIBLE);&#10;            lessonAdapter.notifyDataSetChanged();&#10;&#10;            Toast.makeText(this, &quot;Đã tải &quot; + lessonList.size() + &quot; bài học&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public void onLessonClick(Lesson lesson) {&#10;        // Check if lesson is accessible&#10;        if (!lesson.isAccessible()) {&#10;            if (lesson.isLocked()) {&#10;                Toast.makeText(this, &quot; Bài học này chưa mở khóa!\nHãy hoàn thành bài học trước đó.&quot;, Toast.LENGTH_LONG).show();&#10;            } else {&#10;                Toast.makeText(this, &quot;Bài học này chưa sẵn sàng.&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            return;&#10;        }&#10;&#10;        // Navigate to lesson learning activity&#10;        Intent intent = new Intent(this, StudentLessonLearningActivity.class);&#10;        intent.putExtra(&quot;lessonId&quot;, lesson.getId());&#10;        intent.putExtra(&quot;lessonTitle&quot;, lesson.getTitle());&#10;        intent.putExtra(&quot;courseId&quot;, courseId);&#10;        intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;        intent.putExtra(&quot;courseCategory&quot;, courseCategory);&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        loadLessons(); // Reload when returning from lesson&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.LinearLayout;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class StudentCourseLessonsActivity extends AppCompatActivity implements StudentLessonAdapter.OnLessonClickListener {&#10;&#10;    private RecyclerView rvLessons;&#10;    private LinearLayout layoutNoLessons;&#10;    private TextView tvCourseTitle, tvCourseInfo;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private List&lt;Lesson&gt; lessonList;&#10;    private StudentLessonAdapter lessonAdapter;&#10;&#10;    private String courseId;&#10;    private String courseTitle;&#10;    private String courseCategory;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_course_lessons);&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;        courseCategory = getIntent().getStringExtra(&quot;courseCategory&quot;);&#10;&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;        lessonList = new ArrayList&lt;&gt;();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupRecyclerView();&#10;        loadLessons();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        rvLessons = findViewById(R.id.rv_lessons);&#10;        layoutNoLessons = findViewById(R.id.layout_no_lessons);&#10;        tvCourseTitle = findViewById(R.id.tv_course_title);&#10;        tvCourseInfo = findViewById(R.id.tv_course_info);&#10;&#10;        tvCourseTitle.setText(courseTitle);&#10;        tvCourseInfo.setText(&quot;Danh mục: &quot; + courseCategory);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Bài học&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        lessonAdapter = new StudentLessonAdapter(lessonList, this);&#10;        rvLessons.setLayoutManager(new LinearLayoutManager(this));&#10;        rvLessons.setAdapter(lessonAdapter);&#10;    }&#10;&#10;    private void loadLessons() {&#10;        layoutNoLessons.setVisibility(View.VISIBLE);&#10;        rvLessons.setVisibility(View.GONE);&#10;&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;=== DEBUG: Starting loadLessons ===&quot;);&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;CourseId: &quot; + courseId);&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;CourseTitle: &quot; + courseTitle);&#10;&#10;        // Load lessons with proper isPublished filter (now that we fixed lesson creation)&#10;        db.collection(&quot;lessons&quot;)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .whereEqualTo(&quot;isPublished&quot;, true)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                lessonList.clear();&#10;&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;=== FIREBASE SUCCESS ===&quot;);&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Total published lessons found: &quot; + queryDocumentSnapshots.size());&#10;&#10;                for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                    Lesson lesson = document.toObject(Lesson.class);&#10;                    lesson.setId(document.getId());&#10;                    &#10;                    // Set all lessons as accessible for now&#10;                    lesson.setAccessible(true);&#10;                    lesson.setLocked(false);&#10;                    lesson.setCompleted(false);&#10;                    &#10;                    lessonList.add(lesson);&#10;                    &#10;                    android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Added lesson: &quot; + lesson.getTitle() + &quot; (Order: &quot; + lesson.getOrder() + &quot;)&quot;);&#10;                }&#10;&#10;                // Sort lessons by order&#10;                lessonList.sort((l1, l2) -&gt; Integer.compare(l1.getOrder(), l2.getOrder()));&#10;&#10;                android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Sorted lessons, total: &quot; + lessonList.size());&#10;&#10;                // Show lessons immediately&#10;                showLessonsDirectly();&#10;                &#10;                // Then load progress in background&#10;                if (mAuth.getCurrentUser() != null) {&#10;                    loadLessonProgressStatus();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;=== FIREBASE ERROR ===&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải bài học: &quot; + e.getMessage(), Toast.LENGTH_LONG).show();&#10;                layoutNoLessons.setVisibility(View.VISIBLE);&#10;                rvLessons.setVisibility(View.GONE);&#10;            });&#10;    }&#10;&#10;    private void loadLessonProgressStatus() {&#10;        if (mAuth.getCurrentUser() == null || lessonList.isEmpty()) {&#10;            showLessonsDirectly();&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        // Load all progress records for this student and course&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    // Create a set of completed lesson IDs&#10;                    java.util.Set&lt;String&gt; completedLessonIds = new java.util.HashSet&lt;&gt;();&#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        String lessonId = document.getString(&quot;lessonId&quot;);&#10;                        if (lessonId != null) {&#10;                            completedLessonIds.add(lessonId);&#10;                        }&#10;                    }&#10;&#10;                    // Update lesson completion status and accessibility&#10;                    for (int i = 0; i &lt; lessonList.size(); i++) {&#10;                        Lesson lesson = lessonList.get(i);&#10;&#10;                        // Set completion status&#10;                        boolean isCompleted = completedLessonIds.contains(lesson.getId());&#10;                        lesson.setCompleted(isCompleted);&#10;&#10;                        // Set accessibility: first lesson is always accessible,&#10;                        // subsequent lessons are accessible if previous lesson is completed&#10;                        if (i == 0) {&#10;                            lesson.setAccessible(true);&#10;                            lesson.setLocked(false);&#10;                        } else {&#10;                            Lesson previousLesson = lessonList.get(i - 1);&#10;                            boolean isAccessible = previousLesson.isCompleted();&#10;                            lesson.setAccessible(isAccessible);&#10;                            lesson.setLocked(!isAccessible);&#10;                        }&#10;                    }&#10;&#10;                    android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Progress loaded. Completed lessons: &quot; + completedLessonIds.size());&#10;                    showLessonsDirectly();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;Error loading lesson progress&quot;, e);&#10;                    // Show lessons without progress status if loading fails&#10;                    showLessonsDirectly();&#10;                });&#10;    }&#10;&#10;    private void showLessonsDirectly() {&#10;        android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;=== SHOWING LESSONS ===&quot;);&#10;&#10;        if (lessonList.isEmpty()) {&#10;            android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Lesson list is empty - showing no lessons layout&quot;);&#10;            layoutNoLessons.setVisibility(View.VISIBLE);&#10;            rvLessons.setVisibility(View.GONE);&#10;            Toast.makeText(this, &quot;Khóa học này chưa có bài học nào&quot;, Toast.LENGTH_SHORT).show();&#10;        } else {&#10;            android.util.Log.d(&quot;StudentCourseLessons&quot;, &quot;Showing &quot; + lessonList.size() + &quot; lessons in RecyclerView&quot;);&#10;&#10;            layoutNoLessons.setVisibility(View.GONE);&#10;            rvLessons.setVisibility(View.VISIBLE);&#10;            lessonAdapter.notifyDataSetChanged();&#10;&#10;            Toast.makeText(this, &quot;Đã tải &quot; + lessonList.size() + &quot; bài học&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    private String currentStudentId;&#10;&#10;    private void getCurrentStudentId(Runnable onComplete) {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        String firebaseUid = mAuth.getCurrentUser().getUid();&#10;&#10;        db.collection(&quot;users&quot;).document(firebaseUid)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        currentStudentId = documentSnapshot.getString(&quot;id&quot;);&#10;                        onComplete.run();&#10;                    } else {&#10;                        Toast.makeText(this, &quot;Không tìm thấy thông tin học viên&quot;, Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;Error loading student info&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải thông tin học viên&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                });&#10;    }&#10;&#10;    private void loadStudentProgress() {&#10;        if (currentStudentId == null) {&#10;            updateUI();&#10;            return;&#10;        }&#10;&#10;        // Load student progress from lessonProgress collection&#10;        db.collection(&quot;lessonProgress&quot;)&#10;            .whereEqualTo(&quot;studentId&quot;, currentStudentId)&#10;            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;            .get()&#10;            .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                // Mark completed lessons and determine next available lesson&#10;                java.util.Set&lt;String&gt; completedLessons = new java.util.HashSet&lt;&gt;();&#10;&#10;                for (QueryDocumentSnapshot doc : queryDocumentSnapshots) {&#10;                    String lessonId = doc.getString(&quot;lessonId&quot;);&#10;                    Boolean isCompleted = doc.getBoolean(&quot;isCompleted&quot;);&#10;                    if (lessonId != null &amp;&amp; Boolean.TRUE.equals(isCompleted)) {&#10;                        completedLessons.add(lessonId);&#10;                    }&#10;                }&#10;&#10;                // Update lesson accessibility based on progress&#10;                updateLessonAccessibility(completedLessons);&#10;                updateUI();&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentCourseLessons&quot;, &quot;Error loading progress&quot;, e);&#10;                // If no progress data, allow access to first lesson only&#10;                updateLessonAccessibility(new java.util.HashSet&lt;&gt;());&#10;                updateUI();&#10;            });&#10;    }&#10;&#10;    private void updateLessonAccessibility(java.util.Set&lt;String&gt; completedLessons) {&#10;        for (int i = 0; i &lt; lessonList.size(); i++) {&#10;            Lesson lesson = lessonList.get(i);&#10;&#10;            if (i == 0) {&#10;                // First lesson is always accessible&#10;                lesson.setAccessible(true);&#10;                lesson.setLocked(false);&#10;            } else {&#10;                // Other lessons are only accessible if previous lesson is completed&#10;                Lesson previousLesson = lessonList.get(i - 1);&#10;                boolean previousCompleted = completedLessons.contains(previousLesson.getId());&#10;&#10;                lesson.setAccessible(previousCompleted);&#10;                lesson.setLocked(!previousCompleted);&#10;            }&#10;&#10;            // Mark if lesson is completed&#10;            lesson.setCompleted(completedLessons.contains(lesson.getId()));&#10;&#10;            android.util.Log.d(&quot;StudentCourseLessons&quot;,&#10;                &quot;Lesson &quot; + lesson.getOrder() + &quot;: &quot; + lesson.getTitle() +&#10;                &quot; - Accessible: &quot; + lesson.isAccessible() +&#10;                &quot; - Completed: &quot; + lesson.isCompleted());&#10;        }&#10;    }&#10;&#10;    private void updateUI() {&#10;        if (lessonList.isEmpty()) {&#10;            layoutNoLessons.setVisibility(View.VISIBLE);&#10;            rvLessons.setVisibility(View.GONE);&#10;        } else {&#10;            layoutNoLessons.setVisibility(View.GONE);&#10;            rvLessons.setVisibility(View.VISIBLE);&#10;            lessonAdapter.notifyDataSetChanged();&#10;&#10;            Toast.makeText(this, &quot;Đã tải &quot; + lessonList.size() + &quot; bài học&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public void onLessonClick(Lesson lesson) {&#10;        // Check if lesson is accessible&#10;        if (!lesson.isAccessible()) {&#10;            if (lesson.isLocked()) {&#10;                Toast.makeText(this, &quot; Bài học này chưa mở khóa!\nHãy hoàn thành bài học trước đó.&quot;, Toast.LENGTH_LONG).show();&#10;            } else {&#10;                Toast.makeText(this, &quot;Bài học này chưa sẵn sàng.&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            return;&#10;        }&#10;&#10;        // Navigate to lesson learning activity&#10;        Intent intent = new Intent(this, StudentLessonLearningActivity.class);&#10;        intent.putExtra(&quot;lessonId&quot;, lesson.getId());&#10;        intent.putExtra(&quot;lessonTitle&quot;, lesson.getTitle());&#10;        intent.putExtra(&quot;courseId&quot;, courseId);&#10;        intent.putExtra(&quot;courseTitle&quot;, courseTitle);&#10;        intent.putExtra(&quot;courseCategory&quot;, courseCategory);&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        loadLessons(); // Reload when returning from lesson&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentLessonLearningActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentLessonLearningActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.LinearLayout;&#10;import android.widget.ScrollView;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.models.LessonProgress;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;import java.util.Date;&#10;&#10;public class StudentLessonLearningActivity extends AppCompatActivity {&#10;&#10;    private ScrollView scrollViewContent;&#10;    private TextView tvLessonTitle, tvLessonType, tvEstimatedTime;&#10;    private TextView tvLessonContent;&#10;    private LinearLayout layoutGrammarContent;&#10;    private TextView tvGrammarRule, tvGrammarStructure;&#10;    private LinearLayout layoutExamples, layoutUsage, layoutNotes;&#10;    private Button btnMarkCompleted, btnNextLesson, btnPreviousLesson;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String lessonId, lessonTitle, courseId, courseTitle, courseCategory;&#10;    private Lesson currentLesson;&#10;    private boolean isLessonCompleted = false;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_lesson_learning);&#10;&#10;        // Get lesson info from intent&#10;        lessonId = getIntent().getStringExtra(&quot;lessonId&quot;);&#10;        lessonTitle = getIntent().getStringExtra(&quot;lessonTitle&quot;);&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;        courseCategory = getIntent().getStringExtra(&quot;courseCategory&quot;);&#10;&#10;        if (lessonId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin bài học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupClickListeners();&#10;        loadLessonData();&#10;        checkLessonProgress();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        scrollViewContent = findViewById(R.id.scroll_view_content);&#10;        tvLessonTitle = findViewById(R.id.tv_lesson_title);&#10;        tvLessonType = findViewById(R.id.tv_lesson_type);&#10;        tvEstimatedTime = findViewById(R.id.tv_estimated_time);&#10;        tvLessonContent = findViewById(R.id.tv_lesson_content);&#10;&#10;        // Grammar-specific views&#10;        layoutGrammarContent = findViewById(R.id.layout_grammar_content);&#10;        tvGrammarRule = findViewById(R.id.tv_grammar_rule);&#10;        tvGrammarStructure = findViewById(R.id.tv_grammar_structure);&#10;        layoutExamples = findViewById(R.id.layout_examples);&#10;        layoutUsage = findViewById(R.id.layout_usage);&#10;        layoutNotes = findViewById(R.id.layout_notes);&#10;&#10;        // Action buttons&#10;        btnMarkCompleted = findViewById(R.id.btn_mark_completed);&#10;        btnNextLesson = findViewById(R.id.btn_next_lesson);&#10;        btnPreviousLesson = findViewById(R.id.btn_previous_lesson);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Học bài&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnMarkCompleted.setOnClickListener(v -&gt; markLessonAsCompleted());&#10;        btnNextLesson.setOnClickListener(v -&gt; navigateToNextLesson());&#10;        btnPreviousLesson.setOnClickListener(v -&gt; navigateToPreviousLesson());&#10;    }&#10;&#10;    private void loadLessonData() {&#10;        db.collection(&quot;lessons&quot;).document(lessonId)&#10;            .get()&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#10;                if (documentSnapshot.exists()) {&#10;                    currentLesson = documentSnapshot.toObject(Lesson.class);&#10;                    if (currentLesson != null) {&#10;                        currentLesson.setId(documentSnapshot.getId());&#10;                        displayLessonContent();&#10;                    }&#10;                } else {&#10;                    Toast.makeText(this, &quot;Không tìm thấy bài học&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error loading lesson&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải bài học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;            });&#10;    }&#10;&#10;    private void displayLessonContent() {&#10;        // Display basic lesson info&#10;        tvLessonTitle.setText(currentLesson.getTitle());&#10;        tvLessonType.setText(currentLesson.getTypeDisplayName());&#10;        tvEstimatedTime.setText(currentLesson.getEstimatedTimeString());&#10;        tvLessonContent.setText(currentLesson.getContent());&#10;&#10;        // Display Grammar-specific content if applicable&#10;        if (&quot;Grammar&quot;.equalsIgnoreCase(currentLesson.getCategory())) {&#10;            layoutGrammarContent.setVisibility(View.VISIBLE);&#10;            displayGrammarContent();&#10;        } else {&#10;            layoutGrammarContent.setVisibility(View.GONE);&#10;        }&#10;&#10;        // Set up lesson navigation&#10;        setupLessonNavigation();&#10;    }&#10;&#10;    private void displayGrammarContent() {&#10;        // Display grammar rule&#10;        if (currentLesson.getGrammarRule() != null &amp;&amp; !currentLesson.getGrammarRule().isEmpty()) {&#10;            tvGrammarRule.setText(currentLesson.getGrammarRule());&#10;            tvGrammarRule.setVisibility(View.VISIBLE);&#10;        } else {&#10;            tvGrammarRule.setVisibility(View.GONE);&#10;        }&#10;&#10;        // Display grammar structure&#10;        if (currentLesson.getGrammarStructure() != null &amp;&amp; !currentLesson.getGrammarStructure().isEmpty()) {&#10;            tvGrammarStructure.setText(currentLesson.getGrammarStructure());&#10;            tvGrammarStructure.setVisibility(View.VISIBLE);&#10;        } else {&#10;            tvGrammarStructure.setVisibility(View.GONE);&#10;        }&#10;&#10;        // Display examples&#10;        displayGrammarList(layoutExamples, currentLesson.getGrammarExamples(), &quot; Ví dụ:&quot;);&#10;&#10;        // Display usage notes&#10;        displayGrammarList(layoutUsage, currentLesson.getGrammarUsage(), &quot; Cách sử dụng:&quot;);&#10;&#10;        // Display notes&#10;        displayGrammarList(layoutNotes, currentLesson.getGrammarNotes(), &quot; Ghi chú:&quot;);&#10;    }&#10;&#10;    private void displayGrammarList(LinearLayout container, java.util.List&lt;String&gt; items, String title) {&#10;        container.removeAllViews();&#10;&#10;        if (items != null &amp;&amp; !items.isEmpty()) {&#10;            // Add title&#10;            TextView titleView = new TextView(this);&#10;            titleView.setText(title);&#10;            titleView.setTextSize(16);&#10;            titleView.setTextColor(getColor(android.R.color.holo_blue_dark));&#10;            titleView.setPadding(0, 16, 0, 8);&#10;            container.addView(titleView);&#10;&#10;            // Add items&#10;            for (int i = 0; i &lt; items.size(); i++) {&#10;                TextView itemView = new TextView(this);&#10;                itemView.setText((i + 1) + &quot;. &quot; + items.get(i));&#10;                itemView.setTextSize(14);&#10;                itemView.setPadding(16, 4, 0, 4);&#10;                container.addView(itemView);&#10;            }&#10;&#10;            container.setVisibility(View.VISIBLE);&#10;        } else {&#10;            container.setVisibility(View.GONE);&#10;        }&#10;    }&#10;&#10;    private void setupLessonNavigation() {&#10;        // TODO: Implement lesson navigation logic&#10;        // For now, disable navigation buttons&#10;        btnNextLesson.setEnabled(false);&#10;        btnPreviousLesson.setEnabled(false);&#10;    }&#10;&#10;    private void checkLessonProgress() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;lessonId&quot;, lessonId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    if (!queryDocumentSnapshots.isEmpty()) {&#10;                        LessonProgress progress = queryDocumentSnapshots.getDocuments().get(0).toObject(LessonProgress.class);&#10;                        if (progress != null &amp;&amp; progress.isCompleted()) {&#10;                            isLessonCompleted = true;&#10;                            btnMarkCompleted.setText(&quot;✅ Đã hoàn thành&quot;);&#10;                            btnMarkCompleted.setEnabled(false);&#10;                            btnMarkCompleted.setBackgroundColor(getColor(android.R.color.holo_green_light));&#10;                        }&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error checking lesson progress&quot;, e);&#10;                });&#10;    }&#10;&#10;    private void markLessonAsCompleted() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        if (isLessonCompleted) {&#10;            Toast.makeText(this, &quot;Bài học đã được đánh dấu hoàn thành trước đó&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        // Disable button while processing&#10;        btnMarkCompleted.setEnabled(false);&#10;        btnMarkCompleted.setText(&quot;Đang lưu...&quot;);&#10;&#10;        // Check if progress record already exists&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;lessonId&quot;, lessonId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    if (queryDocumentSnapshots.isEmpty()) {&#10;                        // Create new progress record&#10;                        createLessonProgress(studentId);&#10;                    } else {&#10;                        // Update existing progress record&#10;                        String progressId = queryDocumentSnapshots.getDocuments().get(0).getId();&#10;                        updateLessonProgress(progressId);&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error checking lesson progress&quot;, e);&#10;                    btnMarkCompleted.setEnabled(true);&#10;                    btnMarkCompleted.setText(&quot;Đánh dấu hoàn thành&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi kiểm tra tiến độ: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void createLessonProgress(String studentId) {&#10;        Map&lt;String, Object&gt; progressData = new HashMap&lt;&gt;();&#10;        progressData.put(&quot;studentId&quot;, studentId);&#10;        progressData.put(&quot;courseId&quot;, courseId);&#10;        progressData.put(&quot;lessonId&quot;, lessonId);&#10;        progressData.put(&quot;isCompleted&quot;, true);&#10;        progressData.put(&quot;completedAt&quot;, new Date());&#10;        progressData.put(&quot;createdAt&quot;, new Date());&#10;        progressData.put(&quot;updatedAt&quot;, new Date());&#10;&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .add(progressData)&#10;                .addOnSuccessListener(documentReference -&gt; {&#10;                    isLessonCompleted = true;&#10;                    btnMarkCompleted.setText(&quot;✅ Đã hoàn thành&quot;);&#10;                    btnMarkCompleted.setEnabled(false);&#10;                    btnMarkCompleted.setBackgroundColor(getColor(android.R.color.holo_green_light));&#10;                    Toast.makeText(this, &quot;Đã đánh dấu hoàn thành bài học!&quot;, Toast.LENGTH_SHORT).show();&#10;                    android.util.Log.d(&quot;StudentLessonLearning&quot;, &quot;Lesson progress created successfully&quot;);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error creating lesson progress&quot;, e);&#10;                    btnMarkCompleted.setEnabled(true);&#10;                    btnMarkCompleted.setText(&quot;Đánh dấu hoàn thành&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi lưu tiến độ: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void updateLessonProgress(String progressId) {&#10;        Map&lt;String, Object&gt; updateData = new HashMap&lt;&gt;();&#10;        updateData.put(&quot;isCompleted&quot;, true);&#10;        updateData.put(&quot;completedAt&quot;, new Date());&#10;        updateData.put(&quot;updatedAt&quot;, new Date());&#10;&#10;        db.collection(&quot;lesson_progress&quot;).document(progressId)&#10;                .update(updateData)&#10;                .addOnSuccessListener(aVoid -&gt; {&#10;                    isLessonCompleted = true;&#10;                    btnMarkCompleted.setText(&quot;✅ Đã hoàn thành&quot;);&#10;                    btnMarkCompleted.setEnabled(false);&#10;                    btnMarkCompleted.setBackgroundColor(getColor(android.R.color.holo_green_light));&#10;                    Toast.makeText(this, &quot;Đã đánh dấu hoàn thành bài học!&quot;, Toast.LENGTH_SHORT).show();&#10;                    android.util.Log.d(&quot;StudentLessonLearning&quot;, &quot;Lesson progress updated successfully&quot;);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error updating lesson progress&quot;, e);&#10;                    btnMarkCompleted.setEnabled(true);&#10;                    btnMarkCompleted.setText(&quot;Đánh dấu hoàn thành&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi cập nhật tiến độ: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void navigateToNextLesson() {&#10;        Toast.makeText(this, &quot;Chuyển đến bài học tiếp theo&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    private void navigateToPreviousLesson() {&#10;        Toast.makeText(this, &quot;Quay lại bài học trước&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.LinearLayout;&#10;import android.widget.ScrollView;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.models.LessonProgress;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;import java.util.Date;&#10;&#10;public class StudentLessonLearningActivity extends AppCompatActivity {&#10;&#10;    private ScrollView scrollViewContent;&#10;    private TextView tvLessonTitle, tvLessonType, tvEstimatedTime;&#10;    private TextView tvLessonContent;&#10;    private LinearLayout layoutGrammarContent;&#10;    private TextView tvGrammarRule, tvGrammarStructure;&#10;    private LinearLayout layoutExamples, layoutUsage, layoutNotes;&#10;    private Button btnMarkCompleted, btnNextLesson, btnPreviousLesson;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String lessonId, lessonTitle, courseId, courseTitle, courseCategory;&#10;    private Lesson currentLesson;&#10;    private boolean isLessonCompleted = false;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_lesson_learning);&#10;&#10;        // Get lesson info from intent&#10;        lessonId = getIntent().getStringExtra(&quot;lessonId&quot;);&#10;        lessonTitle = getIntent().getStringExtra(&quot;lessonTitle&quot;);&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;        courseCategory = getIntent().getStringExtra(&quot;courseCategory&quot;);&#10;&#10;        if (lessonId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin bài học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupClickListeners();&#10;        loadLessonData();&#10;        checkLessonProgress();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        scrollViewContent = findViewById(R.id.scroll_view_content);&#10;        tvLessonTitle = findViewById(R.id.tv_lesson_title);&#10;        tvLessonType = findViewById(R.id.tv_lesson_type);&#10;        tvEstimatedTime = findViewById(R.id.tv_estimated_time);&#10;        tvLessonContent = findViewById(R.id.tv_lesson_content);&#10;&#10;        // Grammar-specific views&#10;        layoutGrammarContent = findViewById(R.id.layout_grammar_content);&#10;        tvGrammarRule = findViewById(R.id.tv_grammar_rule);&#10;        tvGrammarStructure = findViewById(R.id.tv_grammar_structure);&#10;        layoutExamples = findViewById(R.id.layout_examples);&#10;        layoutUsage = findViewById(R.id.layout_usage);&#10;        layoutNotes = findViewById(R.id.layout_notes);&#10;&#10;        // Action buttons&#10;        btnMarkCompleted = findViewById(R.id.btn_mark_completed);&#10;        btnNextLesson = findViewById(R.id.btn_next_lesson);&#10;        btnPreviousLesson = findViewById(R.id.btn_previous_lesson);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Học bài&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnMarkCompleted.setOnClickListener(v -&gt; markLessonAsCompleted());&#10;        btnNextLesson.setOnClickListener(v -&gt; navigateToNextLesson());&#10;        btnPreviousLesson.setOnClickListener(v -&gt; navigateToPreviousLesson());&#10;    }&#10;&#10;    private void loadLessonData() {&#10;        db.collection(&quot;lessons&quot;).document(lessonId)&#10;            .get()&#10;            .addOnSuccessListener(documentSnapshot -&gt; {&#10;                if (documentSnapshot.exists()) {&#10;                    currentLesson = documentSnapshot.toObject(Lesson.class);&#10;                    if (currentLesson != null) {&#10;                        currentLesson.setId(documentSnapshot.getId());&#10;                        displayLessonContent();&#10;                    }&#10;                } else {&#10;                    Toast.makeText(this, &quot;Không tìm thấy bài học&quot;, Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                }&#10;            })&#10;            .addOnFailureListener(e -&gt; {&#10;                android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error loading lesson&quot;, e);&#10;                Toast.makeText(this, &quot;Lỗi tải bài học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;            });&#10;    }&#10;&#10;    private void displayLessonContent() {&#10;        // Display basic lesson info&#10;        tvLessonTitle.setText(currentLesson.getTitle());&#10;        tvLessonType.setText(currentLesson.getTypeDisplayName());&#10;        tvEstimatedTime.setText(currentLesson.getEstimatedTimeString());&#10;        tvLessonContent.setText(currentLesson.getContent());&#10;&#10;        // Display Grammar-specific content if applicable&#10;        if (&quot;Grammar&quot;.equalsIgnoreCase(currentLesson.getCategory())) {&#10;            layoutGrammarContent.setVisibility(View.VISIBLE);&#10;            displayGrammarContent();&#10;        } else {&#10;            layoutGrammarContent.setVisibility(View.GONE);&#10;        }&#10;&#10;        // Set up lesson navigation&#10;        setupLessonNavigation();&#10;    }&#10;&#10;    private void displayGrammarContent() {&#10;        // Display grammar rule&#10;        if (currentLesson.getGrammarRule() != null &amp;&amp; !currentLesson.getGrammarRule().isEmpty()) {&#10;            tvGrammarRule.setText(currentLesson.getGrammarRule());&#10;            tvGrammarRule.setVisibility(View.VISIBLE);&#10;        } else {&#10;            tvGrammarRule.setVisibility(View.GONE);&#10;        }&#10;&#10;        // Display grammar structure&#10;        if (currentLesson.getGrammarStructure() != null &amp;&amp; !currentLesson.getGrammarStructure().isEmpty()) {&#10;            tvGrammarStructure.setText(currentLesson.getGrammarStructure());&#10;            tvGrammarStructure.setVisibility(View.VISIBLE);&#10;        } else {&#10;            tvGrammarStructure.setVisibility(View.GONE);&#10;        }&#10;&#10;        // Display examples&#10;        displayGrammarList(layoutExamples, currentLesson.getGrammarExamples(), &quot; Ví dụ:&quot;);&#10;&#10;        // Display usage notes&#10;        displayGrammarList(layoutUsage, currentLesson.getGrammarUsage(), &quot; Cách sử dụng:&quot;);&#10;&#10;        // Display notes&#10;        displayGrammarList(layoutNotes, currentLesson.getGrammarNotes(), &quot; Ghi chú:&quot;);&#10;    }&#10;&#10;    private void displayGrammarList(LinearLayout container, java.util.List&lt;String&gt; items, String title) {&#10;        container.removeAllViews();&#10;&#10;        if (items != null &amp;&amp; !items.isEmpty()) {&#10;            // Add title&#10;            TextView titleView = new TextView(this);&#10;            titleView.setText(title);&#10;            titleView.setTextSize(16);&#10;            titleView.setTextColor(getColor(android.R.color.holo_blue_dark));&#10;            titleView.setPadding(0, 16, 0, 8);&#10;            container.addView(titleView);&#10;&#10;            // Add items&#10;            for (int i = 0; i &lt; items.size(); i++) {&#10;                TextView itemView = new TextView(this);&#10;                itemView.setText((i + 1) + &quot;. &quot; + items.get(i));&#10;                itemView.setTextSize(14);&#10;                itemView.setPadding(16, 4, 0, 4);&#10;                container.addView(itemView);&#10;            }&#10;&#10;            container.setVisibility(View.VISIBLE);&#10;        } else {&#10;            container.setVisibility(View.GONE);&#10;        }&#10;    }&#10;&#10;    private void setupLessonNavigation() {&#10;        // TODO: Implement lesson navigation logic&#10;        // For now, disable navigation buttons&#10;        btnNextLesson.setEnabled(false);&#10;        btnPreviousLesson.setEnabled(false);&#10;    }&#10;&#10;    private void checkLessonProgress() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;lessonId&quot;, lessonId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    if (!queryDocumentSnapshots.isEmpty()) {&#10;                        LessonProgress progress = queryDocumentSnapshots.getDocuments().get(0).toObject(LessonProgress.class);&#10;                        if (progress != null &amp;&amp; progress.isCompleted()) {&#10;                            isLessonCompleted = true;&#10;                            btnMarkCompleted.setText(&quot;✅ Đã hoàn thành&quot;);&#10;                            btnMarkCompleted.setEnabled(false);&#10;                            btnMarkCompleted.setBackgroundColor(getColor(android.R.color.holo_green_light));&#10;                        }&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error checking lesson progress&quot;, e);&#10;                });&#10;    }&#10;&#10;    private void markLessonAsCompleted() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        if (isLessonCompleted) {&#10;            Toast.makeText(this, &quot;Bài học đã được đánh dấu hoàn thành trước đó&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        // Disable button while processing&#10;        btnMarkCompleted.setEnabled(false);&#10;        btnMarkCompleted.setText(&quot;Đang lưu...&quot;);&#10;&#10;        // Check if progress record already exists&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;lessonId&quot;, lessonId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    if (queryDocumentSnapshots.isEmpty()) {&#10;                        // Create new progress record&#10;                        createLessonProgress(studentId);&#10;                    } else {&#10;                        // Update existing progress record&#10;                        String progressId = queryDocumentSnapshots.getDocuments().get(0).getId();&#10;                        updateLessonProgress(progressId);&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error checking lesson progress&quot;, e);&#10;                    btnMarkCompleted.setEnabled(true);&#10;                    btnMarkCompleted.setText(&quot;Đánh dấu hoàn thành&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi kiểm tra tiến độ: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void createLessonProgress(String studentId) {&#10;        Map&lt;String, Object&gt; progressData = new HashMap&lt;&gt;();&#10;        progressData.put(&quot;studentId&quot;, studentId);&#10;        progressData.put(&quot;courseId&quot;, courseId);&#10;        progressData.put(&quot;lessonId&quot;, lessonId);&#10;        progressData.put(&quot;isCompleted&quot;, true);&#10;        progressData.put(&quot;completedAt&quot;, new Date());&#10;        progressData.put(&quot;createdAt&quot;, new Date());&#10;        progressData.put(&quot;updatedAt&quot;, new Date());&#10;&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .add(progressData)&#10;                .addOnSuccessListener(documentReference -&gt; {&#10;                    isLessonCompleted = true;&#10;                    btnMarkCompleted.setText(&quot;✅ Đã hoàn thành&quot;);&#10;                    btnMarkCompleted.setEnabled(false);&#10;                    btnMarkCompleted.setBackgroundColor(getColor(android.R.color.holo_green_light));&#10;                    &#10;                    Toast.makeText(this, &quot;Đã đánh dấu hoàn thành bài học!&quot;, Toast.LENGTH_SHORT).show();&#10;                    android.util.Log.d(&quot;StudentLessonLearning&quot;, &quot;Lesson progress created successfully&quot;);&#10;                    &#10;                    // Calculate and show updated course progress&#10;                    calculateAndShowCourseProgress();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error creating lesson progress&quot;, e);&#10;                    btnMarkCompleted.setEnabled(true);&#10;                    btnMarkCompleted.setText(&quot;Đánh dấu hoàn thành&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi lưu tiến độ: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void updateLessonProgress(String progressId) {&#10;        Map&lt;String, Object&gt; updateData = new HashMap&lt;&gt;();&#10;        updateData.put(&quot;isCompleted&quot;, true);&#10;        updateData.put(&quot;completedAt&quot;, new Date());&#10;        updateData.put(&quot;updatedAt&quot;, new Date());&#10;&#10;        db.collection(&quot;lesson_progress&quot;).document(progressId)&#10;                .update(updateData)&#10;                .addOnSuccessListener(aVoid -&gt; {&#10;                    isLessonCompleted = true;&#10;                    btnMarkCompleted.setText(&quot;✅ Đã hoàn thành&quot;);&#10;                    btnMarkCompleted.setEnabled(false);&#10;                    btnMarkCompleted.setBackgroundColor(getColor(android.R.color.holo_green_light));&#10;                    &#10;                    Toast.makeText(this, &quot;Đã đánh dấu hoàn thành bài học!&quot;, Toast.LENGTH_SHORT).show();&#10;                    android.util.Log.d(&quot;StudentLessonLearning&quot;, &quot;Lesson progress updated successfully&quot;);&#10;                    &#10;                    // Calculate and show updated course progress&#10;                    calculateAndShowCourseProgress();&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error updating lesson progress&quot;, e);&#10;                    btnMarkCompleted.setEnabled(true);&#10;                    btnMarkCompleted.setText(&quot;Đánh dấu hoàn thành&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi cập nhật tiến độ: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    // New method to calculate and display course progress after completing a lesson&#10;    private void calculateAndShowCourseProgress() {&#10;        if (mAuth.getCurrentUser() == null) return;&#10;        &#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;        &#10;        // Get total lessons count&#10;        db.collection(&quot;lessons&quot;)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isPublished&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int totalLessons = queryDocumentSnapshots.size();&#10;                    &#10;                    // Get completed lessons count&#10;                    db.collection(&quot;lesson_progress&quot;)&#10;                            .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                            .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                            .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                            .get()&#10;                            .addOnSuccessListener(progressSnapshots -&gt; {&#10;                                int completedLessons = progressSnapshots.size();&#10;                                int progressPercentage = totalLessons &gt; 0 ? (completedLessons * 100) / totalLessons : 0;&#10;                                &#10;                                // Show progress update&#10;                                String progressMessage = &quot; Tiến độ khóa học: &quot; + completedLessons + &quot;/&quot; + totalLessons + &#10;                                                       &quot; (&quot; + progressPercentage + &quot;% hoàn thành)&quot;;&#10;                                &#10;                                Toast.makeText(this, progressMessage, Toast.LENGTH_LONG).show();&#10;                                &#10;                                // Check if course is completed&#10;                                if (completedLessons == totalLessons &amp;&amp; totalLessons &gt; 0) {&#10;                                    Toast.makeText(this, &quot; Chúc mừng! Bạn đã hoàn thành toàn bộ khóa học: &quot; + courseTitle + &quot;!&quot;, Toast.LENGTH_LONG).show();&#10;                                }&#10;                                &#10;                                android.util.Log.d(&quot;StudentLessonLearning&quot;, &quot;Course progress: &quot; + completedLessons + &quot;/&quot; + totalLessons + &quot; = &quot; + progressPercentage + &quot;%&quot;);&#10;                            })&#10;                            .addOnFailureListener(e -&gt; {&#10;                                android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error calculating course progress&quot;, e);&#10;                            });&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentLessonLearning&quot;, &quot;Error getting total lessons&quot;, e);&#10;                });&#10;    }&#10;&#10;    private void navigateToNextLesson() {&#10;        Toast.makeText(this, &quot;Chuyển đến bài học tiếp theo&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    private void navigateToPreviousLesson() {&#10;        Toast.makeText(this, &quot;Quay lại bài học trước&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentMyCoursesActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentMyCoursesActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.LinearLayout;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class StudentMyCoursesActivity extends AppCompatActivity implements StudentEnrolledCourseAdapter.OnCourseClickListener {&#10;&#10;    private RecyclerView rvMyCourses;&#10;    private LinearLayout layoutNoCourses;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private List&lt;EnrolledCourse&gt; enrolledCourseList;&#10;    private StudentEnrolledCourseAdapter courseAdapter;&#10;    private String currentStudentId;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_my_courses);&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;        enrolledCourseList = new ArrayList&lt;&gt;();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupRecyclerView();&#10;        getCurrentStudentId();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        rvMyCourses = findViewById(R.id.rv_my_courses);&#10;        layoutNoCourses = findViewById(R.id.layout_no_courses);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Khóa học của tôi&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        courseAdapter = new StudentEnrolledCourseAdapter(enrolledCourseList, this);&#10;        rvMyCourses.setLayoutManager(new LinearLayoutManager(this));&#10;        rvMyCourses.setAdapter(courseAdapter);&#10;    }&#10;&#10;    private void getCurrentStudentId() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        String firebaseUid = mAuth.getCurrentUser().getUid();&#10;        &#10;        // Get student info từ users collection&#10;        db.collection(&quot;users&quot;).document(firebaseUid)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        String userRole = documentSnapshot.getString(&quot;role&quot;);&#10;                        currentStudentId = documentSnapshot.getString(&quot;id&quot;);&#10;&#10;                        if (!&quot;student&quot;.equals(userRole)) {&#10;                            Toast.makeText(this, &quot;Chỉ học viên mới có thể xem khóa học của mình&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                            return;&#10;                        }&#10;&#10;                        if (currentStudentId != null) {&#10;                            loadEnrolledCourses();&#10;                        } else {&#10;                            Toast.makeText(this, &quot;Không tìm thấy thông tin học viên&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    } else {&#10;                        Toast.makeText(this, &quot;Không tìm thấy thông tin người dùng&quot;, Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentMyCourses&quot;, &quot;Error loading user info&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải thông tin: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                });&#10;    }&#10;&#10;    private void loadEnrolledCourses() {&#10;        layoutNoCourses.setVisibility(View.VISIBLE);&#10;        rvMyCourses.setVisibility(View.GONE);&#10;&#10;        android.util.Log.d(&quot;StudentMyCourses&quot;, &quot;Loading enrolled courses for student: &quot; + currentStudentId);&#10;&#10;        // Load approved enrollments từ collection &quot;enrollments&quot;&#10;        db.collection(&quot;enrollments&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, currentStudentId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    enrolledCourseList.clear();&#10;&#10;                    android.util.Log.d(&quot;StudentMyCourses&quot;, &quot;Found &quot; + queryDocumentSnapshots.size() + &quot; enrollments&quot;);&#10;&#10;                    if (queryDocumentSnapshots.isEmpty()) {&#10;                        showEmptyState();&#10;                        return;&#10;                    }&#10;&#10;                    // Với mỗi enrollment, load thông tin course tương ứng&#10;                    for (QueryDocumentSnapshot enrollmentDoc : queryDocumentSnapshots) {&#10;                        String courseId = enrollmentDoc.getString(&quot;courseId&quot;);&#10;                        String courseName = enrollmentDoc.getString(&quot;courseName&quot;);&#10;                        String enrollmentDate = enrollmentDoc.getTimestamp(&quot;enrollmentDate&quot;) != null ?&#10;                            enrollmentDoc.getTimestamp(&quot;enrollmentDate&quot;).toDate().toString() : &quot;&quot;;&#10;&#10;                        if (courseId != null) {&#10;                            loadCourseDetails(courseId, courseName, enrollmentDate, enrollmentDoc.getId());&#10;                        }&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentMyCourses&quot;, &quot;Error loading enrollments&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                    showEmptyState();&#10;                });&#10;    }&#10;&#10;    private void loadCourseDetails(String courseId, String courseName, String enrollmentDate, String enrollmentId) {&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;                .get()&#10;                .addOnSuccessListener(courseDoc -&gt; {&#10;                    if (courseDoc.exists()) {&#10;                        Course course = courseDoc.toObject(Course.class);&#10;                        if (course != null) {&#10;                            course.setId(courseDoc.getId());&#10;&#10;                            // Tạo EnrolledCourse object&#10;                            EnrolledCourse enrolledCourse = new EnrolledCourse();&#10;                            enrolledCourse.setCourse(course);&#10;                            enrolledCourse.setEnrollmentId(enrollmentId);&#10;                            enrolledCourse.setEnrollmentDate(enrollmentDate);&#10;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD&#10;                            enrolledCourse.setProgress(0); //&#10;=======&#10;                            enrolledCourse.setProgress(0); // TODO: Calculate actual progress&#10;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 542cd6292b68990ee1f3d7aca232549a251d4232&#10;&#10;                            enrolledCourseList.add(enrolledCourse);&#10;&#10;                            // Update UI&#10;                            updateUI();&#10;                        }&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentMyCourses&quot;, &quot;Error loading course details for: &quot; + courseId, e);&#10;                });&#10;    }&#10;&#10;    private void updateUI() {&#10;        if (enrolledCourseList.isEmpty()) {&#10;            showEmptyState();&#10;        } else {&#10;            layoutNoCourses.setVisibility(View.GONE);&#10;            rvMyCourses.setVisibility(View.VISIBLE);&#10;            courseAdapter.notifyDataSetChanged();&#10;&#10;            android.util.Log.d(&quot;StudentMyCourses&quot;, &quot;Showing &quot; + enrolledCourseList.size() + &quot; enrolled courses&quot;);&#10;        }&#10;    }&#10;&#10;    private void showEmptyState() {&#10;        layoutNoCourses.setVisibility(View.VISIBLE);&#10;        rvMyCourses.setVisibility(View.GONE);&#10;    }&#10;&#10;    @Override&#10;    public void onCourseClick(EnrolledCourse enrolledCourse) {&#10;        // Navigate to course learning activity&#10;        Intent intent = new Intent(this, StudentCourseDetailActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, enrolledCourse.getCourse().getId());&#10;        intent.putExtra(&quot;courseTitle&quot;, enrolledCourse.getCourse().getTitle());&#10;        intent.putExtra(&quot;courseCategory&quot;, enrolledCourse.getCourse().getCategory());&#10;        intent.putExtra(&quot;enrollmentId&quot;, enrolledCourse.getEnrollmentId());&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public void onContinueLearning(EnrolledCourse enrolledCourse) {&#10;        // Navigate to lessons list&#10;        Intent intent = new Intent(this, StudentCourseLessonsActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, enrolledCourse.getCourse().getId());&#10;        intent.putExtra(&quot;courseTitle&quot;, enrolledCourse.getCourse().getTitle());&#10;        intent.putExtra(&quot;courseCategory&quot;, enrolledCourse.getCourse().getCategory());&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public void onViewProgress(EnrolledCourse enrolledCourse) {&#10;        // Navigate to progress view&#10;        Intent intent = new Intent(this, StudentProgressDetailActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, enrolledCourse.getCourse().getId());&#10;        intent.putExtra(&quot;courseTitle&quot;, enrolledCourse.getCourse().getTitle());&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        if (currentStudentId != null) {&#10;            loadEnrolledCourses(); // Reload when returning to this activity&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.LinearLayout;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class StudentMyCoursesActivity extends AppCompatActivity implements StudentEnrolledCourseAdapter.OnCourseClickListener {&#10;&#10;    private RecyclerView rvMyCourses;&#10;    private LinearLayout layoutNoCourses;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private List&lt;EnrolledCourse&gt; enrolledCourseList;&#10;    private StudentEnrolledCourseAdapter courseAdapter;&#10;    private String currentStudentId;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_student_my_courses);&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;        enrolledCourseList = new ArrayList&lt;&gt;();&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        setupRecyclerView();&#10;        getCurrentStudentId();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        rvMyCourses = findViewById(R.id.rv_my_courses);&#10;        layoutNoCourses = findViewById(R.id.layout_no_courses);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Khóa học của tôi&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        courseAdapter = new StudentEnrolledCourseAdapter(enrolledCourseList, this);&#10;        rvMyCourses.setLayoutManager(new LinearLayoutManager(this));&#10;        rvMyCourses.setAdapter(courseAdapter);&#10;    }&#10;&#10;    private void getCurrentStudentId() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        String firebaseUid = mAuth.getCurrentUser().getUid();&#10;        &#10;        // Get student info từ users collection&#10;        db.collection(&quot;users&quot;).document(firebaseUid)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        String userRole = documentSnapshot.getString(&quot;role&quot;);&#10;                        currentStudentId = documentSnapshot.getString(&quot;id&quot;);&#10;&#10;                        if (!&quot;student&quot;.equals(userRole)) {&#10;                            Toast.makeText(this, &quot;Chỉ học viên mới có thể xem khóa học của mình&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                            return;&#10;                        }&#10;&#10;                        if (currentStudentId != null) {&#10;                            loadEnrolledCourses();&#10;                        } else {&#10;                            Toast.makeText(this, &quot;Không tìm thấy thông tin học viên&quot;, Toast.LENGTH_SHORT).show();&#10;                            finish();&#10;                        }&#10;                    } else {&#10;                        Toast.makeText(this, &quot;Không tìm thấy thông tin người dùng&quot;, Toast.LENGTH_SHORT).show();&#10;                        finish();&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentMyCourses&quot;, &quot;Error loading user info&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải thông tin: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                    finish();&#10;                });&#10;    }&#10;&#10;    private void loadEnrolledCourses() {&#10;        layoutNoCourses.setVisibility(View.VISIBLE);&#10;        rvMyCourses.setVisibility(View.GONE);&#10;&#10;        android.util.Log.d(&quot;StudentMyCourses&quot;, &quot;Loading enrolled courses for student: &quot; + currentStudentId);&#10;&#10;        // Load approved enrollments từ collection &quot;enrollments&quot;&#10;        db.collection(&quot;enrollments&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, currentStudentId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    enrolledCourseList.clear();&#10;&#10;                    android.util.Log.d(&quot;StudentMyCourses&quot;, &quot;Found &quot; + queryDocumentSnapshots.size() + &quot; enrollments&quot;);&#10;&#10;                    if (queryDocumentSnapshots.isEmpty()) {&#10;                        showEmptyState();&#10;                        return;&#10;                    }&#10;&#10;                    // Với mỗi enrollment, load thông tin course tương ứng&#10;                    for (QueryDocumentSnapshot enrollmentDoc : queryDocumentSnapshots) {&#10;                        String courseId = enrollmentDoc.getString(&quot;courseId&quot;);&#10;                        String courseName = enrollmentDoc.getString(&quot;courseName&quot;);&#10;                        String enrollmentDate = enrollmentDoc.getTimestamp(&quot;enrollmentDate&quot;) != null ?&#10;                            enrollmentDoc.getTimestamp(&quot;enrollmentDate&quot;).toDate().toString() : &quot;&quot;;&#10;&#10;                        if (courseId != null) {&#10;                            loadCourseDetails(courseId, courseName, enrollmentDate, enrollmentDoc.getId());&#10;                        }&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentMyCourses&quot;, &quot;Error loading enrollments&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải khóa học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                    showEmptyState();&#10;                });&#10;    }&#10;&#10;    private void loadCourseDetails(String courseId, String courseName, String enrollmentDate, String enrollmentId) {&#10;        db.collection(&quot;courses&quot;).document(courseId)&#10;                .get()&#10;                .addOnSuccessListener(courseDoc -&gt; {&#10;                    if (courseDoc.exists()) {&#10;                        Course course = courseDoc.toObject(Course.class);&#10;                        if (course != null) {&#10;                            course.setId(courseDoc.getId());&#10;&#10;                            // Tạo EnrolledCourse object&#10;                            EnrolledCourse enrolledCourse = new EnrolledCourse();&#10;                            enrolledCourse.setCourse(course);&#10;                            enrolledCourse.setEnrollmentId(enrollmentId);&#10;                            enrolledCourse.setEnrollmentDate(enrollmentDate);&#10;                            enrolledCourse.setProgress(0); // TODO: Calculate actual progress&#10;&#10;                            enrolledCourseList.add(enrolledCourse);&#10;&#10;                            // Update UI&#10;                            updateUI();&#10;                        }&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentMyCourses&quot;, &quot;Error loading course details for: &quot; + courseId, e);&#10;                });&#10;    }&#10;&#10;    private void updateUI() {&#10;        if (enrolledCourseList.isEmpty()) {&#10;            showEmptyState();&#10;        } else {&#10;            layoutNoCourses.setVisibility(View.GONE);&#10;            rvMyCourses.setVisibility(View.VISIBLE);&#10;            courseAdapter.notifyDataSetChanged();&#10;&#10;            android.util.Log.d(&quot;StudentMyCourses&quot;, &quot;Showing &quot; + enrolledCourseList.size() + &quot; enrolled courses&quot;);&#10;        }&#10;    }&#10;&#10;    private void showEmptyState() {&#10;        layoutNoCourses.setVisibility(View.VISIBLE);&#10;        rvMyCourses.setVisibility(View.GONE);&#10;    }&#10;&#10;    @Override&#10;    public void onCourseClick(EnrolledCourse enrolledCourse) {&#10;        // Navigate to course learning activity&#10;        Intent intent = new Intent(this, StudentCourseDetailActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, enrolledCourse.getCourse().getId());&#10;        intent.putExtra(&quot;courseTitle&quot;, enrolledCourse.getCourse().getTitle());&#10;        intent.putExtra(&quot;courseCategory&quot;, enrolledCourse.getCourse().getCategory());&#10;        intent.putExtra(&quot;enrollmentId&quot;, enrolledCourse.getEnrollmentId());&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public void onContinueLearning(EnrolledCourse enrolledCourse) {&#10;        // Navigate to lessons list&#10;        Intent intent = new Intent(this, StudentCourseLessonsActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, enrolledCourse.getCourse().getId());&#10;        intent.putExtra(&quot;courseTitle&quot;, enrolledCourse.getCourse().getTitle());&#10;        intent.putExtra(&quot;courseCategory&quot;, enrolledCourse.getCourse().getCategory());&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    public void onViewProgress(EnrolledCourse enrolledCourse) {&#10;        // Navigate to progress view&#10;        Intent intent = new Intent(this, StudentProgressDetailActivity.class);&#10;        intent.putExtra(&quot;courseId&quot;, enrolledCourse.getCourse().getId());&#10;        intent.putExtra(&quot;courseTitle&quot;, enrolledCourse.getCourse().getTitle());&#10;        startActivity(intent);&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        if (currentStudentId != null) {&#10;            loadEnrolledCourses(); // Reload when returning to this activity&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentProgressDetailActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/StudentProgressDetailActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;public class StudentProgressDetailActivity extends AppCompatActivity {&#10;&#10;    private TextView tvCourseTitle, tvProgressSummary;&#10;    private RecyclerView rvLessonProgress;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String courseId, courseTitle;&#10;    private List&lt;LessonProgressItem&gt; lessonProgressList;&#10;    private LessonProgressAdapter progressAdapter;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;&#10;        // Use simple layout since we don't have custom layout&#10;        setContentView(android.R.layout.activity_list_item);&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupRecyclerView();&#10;        loadProgressData();&#10;    }&#10;&#10;    private void initViews() {&#10;        // Use existing views from the layout that already exists&#10;        try {&#10;            toolbar = findViewById(R.id.toolbar);&#10;            if (toolbar != null) {&#10;                setSupportActionBar(toolbar);&#10;                if (getSupportActionBar() != null) {&#10;                    getSupportActionBar().setTitle(&quot;Chi tiết tiến độ học tập&quot;);&#10;                    getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;                }&#10;            }&#10;        } catch (Exception e) {&#10;            // If toolbar doesn't exist, set title directly&#10;            setTitle(&quot;Chi tiết tiến độ học tập&quot;);&#10;        }&#10;&#10;        // Try to find existing views, if not found, show Toast messages instead&#10;        try {&#10;            tvCourseTitle = findViewById(R.id.tv_course_title);&#10;        } catch (Exception e) {&#10;            android.util.Log.d(&quot;StudentProgressDetail&quot;, &quot;Course title view not found&quot;);&#10;        }&#10;&#10;        try {&#10;            rvLessonProgress = findViewById(R.id.rv_lesson_progress);&#10;        } catch (Exception e) {&#10;            // Try to find any RecyclerView or ListView&#10;            rvLessonProgress = findViewById(android.R.id.list);&#10;        }&#10;&#10;        // Create a simple TextView for progress summary if needed&#10;        if (tvCourseTitle == null) {&#10;            tvProgressSummary = new TextView(this);&#10;            tvProgressSummary.setPadding(16, 16, 16, 16);&#10;            tvProgressSummary.setTextSize(16);&#10;        }&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        if (rvLessonProgress != null) {&#10;            lessonProgressList = new ArrayList&lt;&gt;();&#10;            progressAdapter = new LessonProgressAdapter(lessonProgressList);&#10;            rvLessonProgress.setLayoutManager(new LinearLayoutManager(this));&#10;            rvLessonProgress.setAdapter(progressAdapter);&#10;        }&#10;    }&#10;&#10;    private void loadProgressData() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        if (tvCourseTitle != null) {&#10;            tvCourseTitle.setText(courseTitle);&#10;        }&#10;&#10;        // Load all lessons for this course&#10;        db.collection(&quot;lessons&quot;)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isPublished&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    List&lt;Lesson&gt; allLessons = new ArrayList&lt;&gt;();&#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        Lesson lesson = document.toObject(Lesson.class);&#10;                        lesson.setId(document.getId());&#10;                        allLessons.add(lesson);&#10;                    }&#10;&#10;                    if (allLessons.isEmpty()) {&#10;                        String message = &quot;Khóa học này chưa có bài học nào&quot;;&#10;                        if (tvProgressSummary != null) {&#10;                            tvProgressSummary.setText(message);&#10;                        } else {&#10;                            Toast.makeText(this, message, Toast.LENGTH_LONG).show();&#10;                        }&#10;                        return;&#10;                    }&#10;&#10;                    // Load progress for each lesson&#10;                    loadLessonProgress(studentId, allLessons);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentProgressDetail&quot;, &quot;Error loading lessons&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải danh sách bài học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void loadLessonProgress(String studentId, List&lt;Lesson&gt; allLessons) {&#10;        // Load all progress records for this student and course&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    // Create a map of completed lesson IDs&#10;                    Map&lt;String, Boolean&gt; completedLessons = new HashMap&lt;&gt;();&#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        String lessonId = document.getString(&quot;lessonId&quot;);&#10;                        if (lessonId != null) {&#10;                            completedLessons.put(lessonId, true);&#10;                        }&#10;                    }&#10;&#10;                    // Create progress items for all lessons&#10;                    if (lessonProgressList != null) {&#10;                        lessonProgressList.clear();&#10;                    } else {&#10;                        lessonProgressList = new ArrayList&lt;&gt;();&#10;                    }&#10;&#10;                    int completedCount = 0;&#10;&#10;                    for (Lesson lesson : allLessons) {&#10;                        boolean isCompleted = completedLessons.containsKey(lesson.getId());&#10;                        if (isCompleted) {&#10;                            completedCount++;&#10;                        }&#10;&#10;                        LessonProgressItem progressItem = new LessonProgressItem(&#10;                                lesson.getId(),&#10;                                lesson.getTitle(),&#10;                                lesson.getTypeDisplayName(),&#10;                                isCompleted&#10;                        );&#10;                        lessonProgressList.add(progressItem);&#10;                    }&#10;&#10;                    // Update UI&#10;                    int totalLessons = allLessons.size();&#10;                    int progressPercentage = totalLessons &gt; 0 ? (completedCount * 100) / totalLessons : 0;&#10;&#10;                    String progressText = &quot;Bạn đã hoàn thành &quot; + completedCount + &quot; trong tổng số &quot; + totalLessons + &quot; bài học&quot;;&#10;                    String completionText = progressPercentage + &quot;% hoàn thành (&quot; + completedCount + &quot;/&quot; + totalLessons + &quot;)&quot;;&#10;&#10;                    if (tvProgressSummary != null) {&#10;                        tvProgressSummary.setText(progressText + &quot;\n&quot; + completionText);&#10;                    }&#10;&#10;                    // Show progress as Toast if no UI elements available&#10;                    Toast.makeText(this, completionText, Toast.LENGTH_LONG).show();&#10;&#10;                    if (progressAdapter != null) {&#10;                        progressAdapter.notifyDataSetChanged();&#10;                    }&#10;&#10;                    android.util.Log.d(&quot;StudentProgressDetail&quot;, &quot;Progress loaded: &quot; + completedCount + &quot;/&quot; + totalLessons);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentProgressDetail&quot;, &quot;Error loading lesson progress&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải tiến độ học tập: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    // Inner class for lesson progress item&#10;    public static class LessonProgressItem {&#10;        private String lessonId;&#10;        private String lessonTitle;&#10;        private String lessonType;&#10;        private boolean isCompleted;&#10;&#10;        public LessonProgressItem(String lessonId, String lessonTitle, String lessonType, boolean isCompleted) {&#10;            this.lessonId = lessonId;&#10;            this.lessonTitle = lessonTitle;&#10;            this.lessonType = lessonType;&#10;            this.isCompleted = isCompleted;&#10;        }&#10;&#10;        // Getters&#10;        public String getLessonId() { return lessonId; }&#10;        public String getLessonTitle() { return lessonTitle; }&#10;        public String getLessonType() { return lessonType; }&#10;        public boolean isCompleted() { return isCompleted; }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.google.firebase.firestore.QueryDocumentSnapshot;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;public class StudentProgressDetailActivity extends AppCompatActivity {&#10;&#10;    private TextView tvCourseTitle, tvProgressSummary;&#10;    private RecyclerView rvLessonProgress;&#10;    private Toolbar toolbar;&#10;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private String courseId, courseTitle;&#10;    private List&lt;LessonProgressItem&gt; lessonProgressList;&#10;    private LessonProgressAdapter progressAdapter;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;&#10;        // Use simple layout since we don't have custom layout&#10;        setContentView(android.R.layout.activity_list_item);&#10;&#10;        // Get course info from intent&#10;        courseId = getIntent().getStringExtra(&quot;courseId&quot;);&#10;        courseTitle = getIntent().getStringExtra(&quot;courseTitle&quot;);&#10;&#10;        if (courseId == null) {&#10;            Toast.makeText(this, &quot;Lỗi: Không tìm thấy thông tin khóa học&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;&#10;        initViews();&#10;        setupRecyclerView();&#10;        loadProgressData();&#10;    }&#10;&#10;    private void initViews() {&#10;        // Set title directly since we may not have custom toolbar&#10;        setTitle(&quot;Chi tiết tiến độ học tập&quot;);&#10;        &#10;        // Don't try to find custom views that don't exist&#10;        // We'll display progress information via Toast messages instead&#10;        tvCourseTitle = null;&#10;        tvProgressSummary = null;&#10;        rvLessonProgress = null;&#10;        &#10;        android.util.Log.d(&quot;StudentProgressDetail&quot;, &quot;Using simplified UI without custom layouts&quot;);&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        if (rvLessonProgress != null) {&#10;            lessonProgressList = new ArrayList&lt;&gt;();&#10;            progressAdapter = new LessonProgressAdapter(lessonProgressList);&#10;            rvLessonProgress.setLayoutManager(new LinearLayoutManager(this));&#10;            rvLessonProgress.setAdapter(progressAdapter);&#10;        }&#10;    }&#10;&#10;    private void loadProgressData() {&#10;        if (mAuth.getCurrentUser() == null) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        String studentId = mAuth.getCurrentUser().getUid();&#10;&#10;        if (tvCourseTitle != null) {&#10;            tvCourseTitle.setText(courseTitle);&#10;        }&#10;&#10;        // Load all lessons for this course&#10;        db.collection(&quot;lessons&quot;)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isPublished&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    List&lt;Lesson&gt; allLessons = new ArrayList&lt;&gt;();&#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        Lesson lesson = document.toObject(Lesson.class);&#10;                        lesson.setId(document.getId());&#10;                        allLessons.add(lesson);&#10;                    }&#10;&#10;                    if (allLessons.isEmpty()) {&#10;                        String message = &quot;Khóa học này chưa có bài học nào&quot;;&#10;                        if (tvProgressSummary != null) {&#10;                            tvProgressSummary.setText(message);&#10;                        } else {&#10;                            Toast.makeText(this, message, Toast.LENGTH_LONG).show();&#10;                        }&#10;                        return;&#10;                    }&#10;&#10;                    // Load progress for each lesson&#10;                    loadLessonProgress(studentId, allLessons);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentProgressDetail&quot;, &quot;Error loading lessons&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải danh sách bài học: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void loadLessonProgress(String studentId, List&lt;Lesson&gt; allLessons) {&#10;        // Load all progress records for this student and course&#10;        db.collection(&quot;lesson_progress&quot;)&#10;                .whereEqualTo(&quot;studentId&quot;, studentId)&#10;                .whereEqualTo(&quot;courseId&quot;, courseId)&#10;                .whereEqualTo(&quot;isCompleted&quot;, true)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    // Create a map of completed lesson IDs&#10;                    Map&lt;String, Boolean&gt; completedLessons = new HashMap&lt;&gt;();&#10;                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {&#10;                        String lessonId = document.getString(&quot;lessonId&quot;);&#10;                        if (lessonId != null) {&#10;                            completedLessons.put(lessonId, true);&#10;                        }&#10;                    }&#10;&#10;                    // Create progress items for all lessons&#10;                    if (lessonProgressList != null) {&#10;                        lessonProgressList.clear();&#10;                    } else {&#10;                        lessonProgressList = new ArrayList&lt;&gt;();&#10;                    }&#10;&#10;                    int completedCount = 0;&#10;&#10;                    for (Lesson lesson : allLessons) {&#10;                        boolean isCompleted = completedLessons.containsKey(lesson.getId());&#10;                        if (isCompleted) {&#10;                            completedCount++;&#10;                        }&#10;&#10;                        LessonProgressItem progressItem = new LessonProgressItem(&#10;                                lesson.getId(),&#10;                                lesson.getTitle(),&#10;                                lesson.getTypeDisplayName(),&#10;                                isCompleted&#10;                        );&#10;                        lessonProgressList.add(progressItem);&#10;                    }&#10;&#10;                    // Update UI&#10;                    int totalLessons = allLessons.size();&#10;                    int progressPercentage = totalLessons &gt; 0 ? (completedCount * 100) / totalLessons : 0;&#10;&#10;                    String progressText = &quot;Bạn đã hoàn thành &quot; + completedCount + &quot; trong tổng số &quot; + totalLessons + &quot; bài học&quot;;&#10;                    String completionText = progressPercentage + &quot;% hoàn thành (&quot; + completedCount + &quot;/&quot; + totalLessons + &quot;)&quot;;&#10;&#10;                    if (tvProgressSummary != null) {&#10;                        tvProgressSummary.setText(progressText + &quot;\n&quot; + completionText);&#10;                    }&#10;&#10;                    // Show progress as Toast if no UI elements available&#10;                    Toast.makeText(this, completionText, Toast.LENGTH_LONG).show();&#10;&#10;                    if (progressAdapter != null) {&#10;                        progressAdapter.notifyDataSetChanged();&#10;                    }&#10;&#10;                    android.util.Log.d(&quot;StudentProgressDetail&quot;, &quot;Progress loaded: &quot; + completedCount + &quot;/&quot; + totalLessons);&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    android.util.Log.e(&quot;StudentProgressDetail&quot;, &quot;Error loading lesson progress&quot;, e);&#10;                    Toast.makeText(this, &quot;Lỗi tải tiến độ học tập: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        if (item.getItemId() == android.R.id.home) {&#10;            finish();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    // Inner class for lesson progress item&#10;    public static class LessonProgressItem {&#10;        private String lessonId;&#10;        private String lessonTitle;&#10;        private String lessonType;&#10;        private boolean isCompleted;&#10;&#10;        public LessonProgressItem(String lessonId, String lessonTitle, String lessonType, boolean isCompleted) {&#10;            this.lessonId = lessonId;&#10;            this.lessonTitle = lessonTitle;&#10;            this.lessonType = lessonType;&#10;            this.isCompleted = isCompleted;&#10;        }&#10;&#10;        // Getters&#10;        public String getLessonId() { return lessonId; }&#10;        public String getLessonTitle() { return lessonTitle; }&#10;        public String getLessonType() { return lessonType; }&#10;        public boolean isCompleted() { return isCompleted; }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/TeacherDashboardActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/TeacherDashboardActivity.java" />
              <option name="originalContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.Menu;&#10;import android.view.MenuItem;&#10;import android.widget.Button;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.utils.RealtimeManager;&#10;&#10;public class TeacherDashboardActivity extends AppCompatActivity {&#10;&#10;    private Toolbar toolbar;&#10;    private TextView tvWelcome, tvCoursesCount, tvStudentsCount, tvPendingRequestsCount;&#10;    private Button btnManageCourses, btnViewRequests, btnViewStudents, btnCreateCourse;&#10;    private Button btnManageCourses, btnViewRequests, btnCreateQuiz, btnCreateCourse;&#10;=======&#10;    private Button btnManageCourses, btnViewRequests, btnViewStudents, btnCreateCourse;&#10;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 542cd6292b68990ee1f3d7aca232549a251d4232&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private RealtimeManager realtimeManager;&#10;    private String currentTeacherId; // Đổi từ currentTeacherName sang currentTeacherId&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_teacher_dashboard);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        initFirebase();&#10;        loadDashboardData();&#10;        setupClickListeners();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        tvWelcome = findViewById(R.id.tv_welcome);&#10;        tvCoursesCount = findViewById(R.id.tv_courses_count);&#10;        tvStudentsCount = findViewById(R.id.tv_students_count);&#10;        btnViewStudents = findViewById(R.id.btn_view_students);&#10;&#10;        btnManageCourses = findViewById(R.id.btn_manage_courses);&#10;        btnViewRequests = findViewById(R.id.btn_view_requests);&#10;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD&#10;        btnCreateQuiz = findViewById(R.id.btn_create_quiz);&#10;=======&#10;        btnViewStudents = findViewById(R.id.btn_view_students);&#10;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 542cd6292b68990ee1f3d7aca232549a251d4232&#10;        btnCreateCourse = findViewById(R.id.btn_create_course);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Bảng điều khiển giáo viên&quot;);&#10;        }&#10;    }&#10;&#10;    private void initFirebase() {&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;        realtimeManager = RealtimeManager.getInstance();&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnManageCourses.setOnClickListener(v -&gt; {&#10;        btnViewStudents.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, EnrollmentManagementActivity.class));&#10;&#10;        // Thêm click listener cho nút &quot;View Requests&quot;&#10;        btnViewRequests.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, CourseRequestManagementActivity.class));&#10;        });&#10;&#10;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD&#10;        btnCreateQuiz.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, SelectCourseForQuizActivity.class));&#10;=======&#10;        btnViewStudents.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, EnrollmentManagementActivity.class));&#10;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 542cd6292b68990ee1f3d7aca232549a251d4232&#10;        });&#10;&#10;        btnCreateCourse.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, CreateCourseActivity.class));&#10;        });&#10;    }&#10;&#10;    private void loadDashboardData() {&#10;        String teacherId = mAuth.getCurrentUser().getUid();&#10;        currentTeacherId = teacherId; // Lưu teacherId trực tiếp&#10;&#10;        // Load teacher info&#10;        db.collection(&quot;users&quot;).document(teacherId)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        String fullName = documentSnapshot.getString(&quot;fullName&quot;);&#10;                        tvWelcome.setText(&quot;Xin chào, &quot; + fullName);&#10;&#10;                        // Load counts với teacherId&#10;                        loadCoursesCount(teacherId);&#10;                        loadStudentsCount(teacherId);&#10;                        setupRealTimePendingRequestsCount(); // Sử dụng teacherId&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Toast.makeText(this, &quot;Lỗi khi tải thông tin&quot;, Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void loadCoursesCount(String teacherId) {&#10;        db.collection(&quot;courses&quot;)&#10;                .whereEqualTo(&quot;teacherId&quot;, teacherId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int count = queryDocumentSnapshots.size();&#10;                    tvCoursesCount.setText(String.valueOf(count));&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    tvCoursesCount.setText(&quot;0&quot;);&#10;                });&#10;    }&#10;&#10;    private void loadStudentsCount(String teacherId) {&#10;        db.collection(&quot;enrollments&quot;)&#10;                .whereEqualTo(&quot;teacherId&quot;, teacherId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int count = queryDocumentSnapshots.size();&#10;                    tvStudentsCount.setText(String.valueOf(count));&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    tvStudentsCount.setText(&quot;0&quot;);&#10;                });&#10;    }&#10;&#10;    // Sửa để hiển thị TẤT CẢ pending requests (không filter theo teacherId)&#10;    private void setupRealTimePendingRequestsCount() {&#10;        // Đơn giản hóa - đếm tất cả pending requests&#10;        db.collection(&quot;courseRequests&quot;)&#10;                .whereEqualTo(&quot;status&quot;, &quot;pending&quot;)&#10;                .addSnapshotListener((queryDocumentSnapshots, e) -&gt; {&#10;                    if (e != null) {&#10;                        Log.e(&quot;TeacherDashboard&quot;, &quot;Error listening to pending requests&quot;, e);&#10;                        tvPendingRequestsCount.setText(&quot;0&quot;);&#10;                        return;&#10;                    }&#10;&#10;                    if (queryDocumentSnapshots != null) {&#10;                        int count = queryDocumentSnapshots.size();&#10;                        Log.d(&quot;TeacherDashboard&quot;, &quot;Real-time update: &quot; + count + &quot; pending requests total&quot;);&#10;&#10;                        runOnUiThread(() -&gt; {&#10;                            tvPendingRequestsCount.setText(String.valueOf(count));&#10;&#10;                            if (count &gt; 0) {&#10;                                btnViewRequests.setText(&quot;Xem yêu cầu (&quot; + count + &quot;)&quot;);&#10;                                // Animation nhấp nháy khi có yêu cầu mới&#10;                                btnViewRequests.animate()&#10;                                        .scaleX(1.1f)&#10;                                        .scaleY(1.1f)&#10;                                        .setDuration(200)&#10;                                        .withEndAction(() -&gt; {&#10;                                            btnViewRequests.animate()&#10;                                                    .scaleX(1f)&#10;                                                    .scaleY(1f)&#10;                                                    .setDuration(200)&#10;                                                    .start();&#10;                                        })&#10;                                        .start();&#10;                            } else {&#10;                                btnViewRequests.setText(&quot;Xem yêu cầu&quot;);&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;    }&#10;&#10;    @Override&#10;    public boolean onCreateOptionsMenu(Menu menu) {&#10;        getMenuInflater().inflate(R.menu.teacher_toolbar_menu, menu);&#10;        return true;&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        int itemId = item.getItemId();&#10;        if (itemId == R.id.action_logout) {&#10;            logout();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    private void logout() {&#10;        mAuth.signOut();&#10;        Intent intent = new Intent(this, LoginActivity.class);&#10;        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;        startActivity(intent);&#10;        finish();&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Refresh data khi quay lại activity&#10;        loadDashboardData();&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cleanup listeners khi destroy activity&#10;        if (realtimeManager != null) {&#10;            realtimeManager.removeAllListeners();&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.Menu;&#10;import android.view.MenuItem;&#10;import android.widget.Button;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import com.google.firebase.auth.FirebaseAuth;&#10;import com.google.firebase.firestore.FirebaseFirestore;&#10;import com.vantinh.tienganh.utils.RealtimeManager;&#10;&#10;public class TeacherDashboardActivity extends AppCompatActivity {&#10;&#10;    private Toolbar toolbar;&#10;    private TextView tvWelcome, tvCoursesCount, tvStudentsCount, tvPendingRequestsCount;&#10;    private Button btnManageCourses, btnViewRequests, btnCreateQuiz, btnCreateCourse;&#10;    private FirebaseAuth mAuth;&#10;    private FirebaseFirestore db;&#10;    private RealtimeManager realtimeManager;&#10;    private String currentTeacherId; // Đổi từ currentTeacherName sang currentTeacherId&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_teacher_dashboard);&#10;&#10;        initViews();&#10;        setupToolbar();&#10;        initFirebase();&#10;        loadDashboardData();&#10;        setupClickListeners();&#10;    }&#10;&#10;    private void initViews() {&#10;        toolbar = findViewById(R.id.toolbar);&#10;        tvWelcome = findViewById(R.id.tv_welcome);&#10;        tvCoursesCount = findViewById(R.id.tv_courses_count);&#10;        tvStudentsCount = findViewById(R.id.tv_students_count);&#10;        tvPendingRequestsCount = findViewById(R.id.tv_pending_requests_count);&#10;&#10;        btnManageCourses = findViewById(R.id.btn_manage_courses);&#10;        btnViewRequests = findViewById(R.id.btn_view_requests);&#10;        btnCreateQuiz = findViewById(R.id.btn_create_quiz);&#10;        btnCreateCourse = findViewById(R.id.btn_create_course);&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Bảng điều khiển giáo viên&quot;);&#10;        }&#10;    }&#10;&#10;    private void initFirebase() {&#10;        mAuth = FirebaseAuth.getInstance();&#10;        db = FirebaseFirestore.getInstance();&#10;        realtimeManager = RealtimeManager.getInstance();&#10;    }&#10;&#10;    private void setupClickListeners() {&#10;        btnManageCourses.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, CourseManagementActivity.class));&#10;        });&#10;&#10;        // Thêm click listener cho nút &quot;View Requests&quot;&#10;        btnViewRequests.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, CourseRequestManagementActivity.class));&#10;        });&#10;&#10;        btnCreateQuiz.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, SelectCourseForQuizActivity.class));&#10;        });&#10;&#10;        btnCreateCourse.setOnClickListener(v -&gt; {&#10;            startActivity(new Intent(this, CreateCourseActivity.class));&#10;        });&#10;    }&#10;&#10;    private void loadDashboardData() {&#10;        String teacherId = mAuth.getCurrentUser().getUid();&#10;        currentTeacherId = teacherId; // Lưu teacherId trực tiếp&#10;&#10;        // Load teacher info&#10;        db.collection(&quot;users&quot;).document(teacherId)&#10;                .get()&#10;                .addOnSuccessListener(documentSnapshot -&gt; {&#10;                    if (documentSnapshot.exists()) {&#10;                        String fullName = documentSnapshot.getString(&quot;fullName&quot;);&#10;                        tvWelcome.setText(&quot;Xin chào, &quot; + fullName);&#10;&#10;                        // Load counts với teacherId&#10;                        loadCoursesCount(teacherId);&#10;                        loadStudentsCount(teacherId);&#10;                        setupRealTimePendingRequestsCount(); // Sử dụng teacherId&#10;                    }&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    Toast.makeText(this, &quot;Lỗi khi tải thông tin&quot;, Toast.LENGTH_SHORT).show();&#10;                });&#10;    }&#10;&#10;    private void loadCoursesCount(String teacherId) {&#10;        db.collection(&quot;courses&quot;)&#10;                .whereEqualTo(&quot;teacherId&quot;, teacherId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int count = queryDocumentSnapshots.size();&#10;                    tvCoursesCount.setText(String.valueOf(count));&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    tvCoursesCount.setText(&quot;0&quot;);&#10;                });&#10;    }&#10;&#10;    private void loadStudentsCount(String teacherId) {&#10;        db.collection(&quot;enrollments&quot;)&#10;                .whereEqualTo(&quot;teacherId&quot;, teacherId)&#10;                .get()&#10;                .addOnSuccessListener(queryDocumentSnapshots -&gt; {&#10;                    int count = queryDocumentSnapshots.size();&#10;                    tvStudentsCount.setText(String.valueOf(count));&#10;                })&#10;                .addOnFailureListener(e -&gt; {&#10;                    tvStudentsCount.setText(&quot;0&quot;);&#10;                });&#10;    }&#10;&#10;    // Sửa để hiển thị TẤT CẢ pending requests (không filter theo teacherId)&#10;    private void setupRealTimePendingRequestsCount() {&#10;        // Đơn giản hóa - đếm tất cả pending requests&#10;        db.collection(&quot;courseRequests&quot;)&#10;                .whereEqualTo(&quot;status&quot;, &quot;pending&quot;)&#10;                .addSnapshotListener((queryDocumentSnapshots, e) -&gt; {&#10;                    if (e != null) {&#10;                        Log.e(&quot;TeacherDashboard&quot;, &quot;Error listening to pending requests&quot;, e);&#10;                        tvPendingRequestsCount.setText(&quot;0&quot;);&#10;                        return;&#10;                    }&#10;&#10;                    if (queryDocumentSnapshots != null) {&#10;                        int count = queryDocumentSnapshots.size();&#10;                        Log.d(&quot;TeacherDashboard&quot;, &quot;Real-time update: &quot; + count + &quot; pending requests total&quot;);&#10;&#10;                        runOnUiThread(() -&gt; {&#10;                            tvPendingRequestsCount.setText(String.valueOf(count));&#10;&#10;                            if (count &gt; 0) {&#10;                                btnViewRequests.setText(&quot;Xem yêu cầu (&quot; + count + &quot;)&quot;);&#10;                                // Animation nhấp nháy khi có yêu cầu mới&#10;                                btnViewRequests.animate()&#10;                                        .scaleX(1.1f)&#10;                                        .scaleY(1.1f)&#10;                                        .setDuration(200)&#10;                                        .withEndAction(() -&gt; {&#10;                                            btnViewRequests.animate()&#10;                                                    .scaleX(1f)&#10;                                                    .scaleY(1f)&#10;                                                    .setDuration(200)&#10;                                                    .start();&#10;                                        })&#10;                                        .start();&#10;                            } else {&#10;                                btnViewRequests.setText(&quot;Xem yêu cầu&quot;);&#10;                            }&#10;                        });&#10;                    }&#10;                });&#10;    }&#10;&#10;    @Override&#10;    public boolean onCreateOptionsMenu(Menu menu) {&#10;        getMenuInflater().inflate(R.menu.teacher_toolbar_menu, menu);&#10;        return true;&#10;    }&#10;&#10;    @Override&#10;    public boolean onOptionsItemSelected(@NonNull MenuItem item) {&#10;        int itemId = item.getItemId();&#10;        if (itemId == R.id.action_logout) {&#10;            logout();&#10;            return true;&#10;        }&#10;        return super.onOptionsItemSelected(item);&#10;    }&#10;&#10;    private void logout() {&#10;        mAuth.signOut();&#10;        Intent intent = new Intent(this, LoginActivity.class);&#10;        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;        startActivity(intent);&#10;        finish();&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Refresh data khi quay lại activity&#10;        loadDashboardData();&#10;    }&#10;&#10;    @Override&#10;    protected void onDestroy() {&#10;        super.onDestroy();&#10;        // Cleanup listeners khi destroy activity&#10;        if (realtimeManager != null) {&#10;            realtimeManager.removeAllListeners();&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/adapters/CourseSelectAdapter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/adapters/CourseSelectAdapter.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.adapters;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.TextView;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.vantinh.tienganh.R;&#10;import com.vantinh.tienganh.models.Course;&#10;import java.util.List;&#10;&#10;public class CourseSelectAdapter extends RecyclerView.Adapter&lt;CourseSelectAdapter.ViewHolder&gt; {&#10;&#10;    private List&lt;Course&gt; courses;&#10;    private OnCourseSelectListener listener;&#10;&#10;    public interface OnCourseSelectListener {&#10;        void onCourseSelected(Course course);&#10;    }&#10;&#10;    public CourseSelectAdapter(List&lt;Course&gt; courses, OnCourseSelectListener listener) {&#10;        this.courses = courses;&#10;        this.listener = listener;&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_course_select, parent, false);&#10;        return new ViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {&#10;        Course course = courses.get(position);&#10;        holder.bind(course);&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return courses.size();&#10;    }&#10;&#10;    class ViewHolder extends RecyclerView.ViewHolder {&#10;        private TextView tvCourseName, tvCourseDescription;&#10;&#10;        public ViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            tvCourseName = itemView.findViewById(R.id.tv_course_name);&#10;            tvCourseDescription = itemView.findViewById(R.id.tv_course_description);&#10;&#10;            itemView.setOnClickListener(v -&gt; {&#10;                if (listener != null) {&#10;                    listener.onCourseSelected(courses.get(getAdapterPosition()));&#10;                }&#10;            });&#10;        }&#10;&#10;        public void bind(Course course) {&#10;            tvCourseName.setText(course.getCourseName());&#10;            tvCourseDescription.setText(course.getDescription());&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/adapters/EditTestQuestionAdapter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/adapters/EditTestQuestionAdapter.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.adapters;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.Button;&#10;import android.widget.TextView;&#10;import androidx.annotation.NonNull;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import com.vantinh.tienganh.R;&#10;import com.vantinh.tienganh.models.SimpleTestQuestion;&#10;import java.util.List;&#10;&#10;public class EditTestQuestionAdapter extends RecyclerView.Adapter&lt;EditTestQuestionAdapter.ViewHolder&gt; {&#10;&#10;    private List&lt;SimpleTestQuestion&gt; questions;&#10;    private OnQuestionClickListener editListener;&#10;    private OnQuestionClickListener deleteListener;&#10;&#10;    public interface OnQuestionClickListener {&#10;        void onQuestionClick(SimpleTestQuestion question);&#10;    }&#10;&#10;    public EditTestQuestionAdapter(List&lt;SimpleTestQuestion&gt; questions, &#10;                                  OnQuestionClickListener editListener,&#10;                                  OnQuestionClickListener deleteListener) {&#10;        this.questions = questions;&#10;        this.editListener = editListener;&#10;        this.deleteListener = deleteListener;&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_edit_test_question, parent, false);&#10;        return new ViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {&#10;        SimpleTestQuestion question = questions.get(position);&#10;        &#10;        holder.tvQuestionNumber.setText(&quot;Câu &quot; + (position + 1));&#10;        holder.tvQuestion.setText(question.getQuestion());&#10;        &#10;        // Hiển thị các lựa chọn&#10;        List&lt;String&gt; options = question.getCorrectAnswer();&#10;        if (options != null &amp;&amp; options.size() &gt;= 4) {&#10;            holder.tvOptionA.setText(&quot;A. &quot; + options.get(0));&#10;            holder.tvOptionB.setText(&quot;B. &quot; + options.get(1));&#10;            holder.tvOptionC.setText(&quot;C. &quot; + options.get(2));&#10;            holder.tvOptionD.setText(&quot;D. &quot; + options.get(3));&#10;        }&#10;        &#10;        // Hiển thị đáp án đúng&#10;        int correctIndex = question.getOptions();&#10;        String correctLabel = &quot;&quot;;&#10;        switch (correctIndex) {&#10;            case 0: correctLabel = &quot;A&quot;; break;&#10;            case 1: correctLabel = &quot;B&quot;; break;&#10;            case 2: correctLabel = &quot;C&quot;; break;&#10;            case 3: correctLabel = &quot;D&quot;; break;&#10;        }&#10;        holder.tvCorrectAnswer.setText(&quot;Đáp án đúng: &quot; + correctLabel);&#10;        &#10;        // Set click listeners&#10;        holder.btnEdit.setOnClickListener(v -&gt; {&#10;            if (editListener != null) {&#10;                editListener.onQuestionClick(question);&#10;            }&#10;        });&#10;        &#10;        holder.btnDelete.setOnClickListener(v -&gt; {&#10;            if (deleteListener != null) {&#10;                deleteListener.onQuestionClick(question);&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return questions.size();&#10;    }&#10;&#10;    public static class ViewHolder extends RecyclerView.ViewHolder {&#10;        TextView tvQuestionNumber, tvQuestion, tvOptionA, tvOptionB, tvOptionC, tvOptionD, tvCorrectAnswer;&#10;        Button btnEdit, btnDelete;&#10;&#10;        public ViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            tvQuestionNumber = itemView.findViewById(R.id.tv_question_number);&#10;            tvQuestion = itemView.findViewById(R.id.tv_question);&#10;            tvOptionA = itemView.findViewById(R.id.tv_option_a);&#10;            tvOptionB = itemView.findViewById(R.id.tv_option_b);&#10;            tvOptionC = itemView.findViewById(R.id.tv_option_c);&#10;            tvOptionD = itemView.findViewById(R.id.tv_option_d);&#10;            tvCorrectAnswer = itemView.findViewById(R.id.tv_correct_answer);&#10;            btnEdit = itemView.findViewById(R.id.btn_edit);&#10;            btnDelete = itemView.findViewById(R.id.btn_delete);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/Course.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/Course.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.Date;&#10;import java.util.List;&#10;&#10;public class Course {&#10;    private String id;&#10;    private String title;&#10;    private String description;&#10;    private String teacherId;&#10;    private String imageUrl;&#10;    private String level; // Beginner, Intermediate, Advanced&#10;    private String category; // Grammar, Vocabulary, Listening, Speaking&#10;    private int duration; // in hours&#10;    private Date createdAt;&#10;    private Date updatedAt;&#10;    private boolean isActive;&#10;    private int enrolledStudents;&#10;    private double rating;&#10;    private List&lt;String&gt; tags;&#10;&#10;    public Course() {&#10;        // Required empty constructor for Firebase&#10;    }&#10;&#10;    public Course(String title, String description, String teacherId,&#10;                  String level, String category, int duration) {&#10;        this.title = title;&#10;        this.description = description;&#10;        this.teacherId = teacherId;&#10;        this.level = level;&#10;        this.category = category;&#10;        this.duration = duration;&#10;        this.createdAt = new Date();&#10;        this.updatedAt = new Date();&#10;        this.isActive = true;&#10;        this.enrolledStudents = 0;&#10;        this.rating = 0.0;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getId() { return id; }&#10;    public void setId(String id) { this.id = id; }&#10;&#10;    public String getTitle() { return title; }&#10;    public void setTitle(String title) { this.title = title; }&#10;&#10;    public String getDescription() { return description; }&#10;    public void setDescription(String description) { this.description = description; }&#10;&#10;    public String getTeacherId() { return teacherId; }&#10;    public void setTeacherId(String teacherId) { this.teacherId = teacherId; }&#10;&#10;    public String getImageUrl() { return imageUrl; }&#10;    public void setImageUrl(String imageUrl) { this.imageUrl = imageUrl; }&#10;&#10;    public String getLevel() { return level; }&#10;    public void setLevel(String level) { this.level = level; }&#10;&#10;    public String getCategory() { return category; }&#10;    public void setCategory(String category) { this.category = category; }&#10;&#10;    public int getDuration() { return duration; }&#10;    public void setDuration(int duration) { this.duration = duration; }&#10;&#10;    public Date getCreatedAt() { return createdAt; }&#10;    public void setCreatedAt(Date createdAt) { this.createdAt = createdAt; }&#10;&#10;    public Date getUpdatedAt() { return updatedAt; }&#10;    public void setUpdatedAt(Date updatedAt) { this.updatedAt = updatedAt; }&#10;&#10;    public boolean isActive() { return isActive; }&#10;    public void setActive(boolean active) { isActive = active; }&#10;&#10;    public int getEnrolledStudents() { return enrolledStudents; }&#10;    public void setEnrolledStudents(int enrolledStudents) { this.enrolledStudents = enrolledStudents; }&#10;&#10;    public double getRating() { return rating; }&#10;    public void setRating(double rating) { this.rating = rating; }&#10;&#10;    public List&lt;String&gt; getTags() { return tags; }&#10;    public void setTags(List&lt;String&gt; tags) { this.tags = tags; }&#10;&#10;    // Thêm phương thức getCourseName() để tương thích với code hiện tại&#10;    public String getCourseName() {&#10;        return this.title;&#10;    }&#10;&#10;    public void setCourseName(String courseName) {&#10;        this.title = courseName;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/LessonProgress.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/LessonProgress.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.Date;&#10;&#10;public class LessonProgress {&#10;    private String id;&#10;    private String studentId;&#10;    private String courseId;&#10;    private String lessonId;&#10;    private boolean isCompleted;&#10;    private Date completedAt;&#10;    private Date createdAt;&#10;    private Date updatedAt;&#10;&#10;    public LessonProgress() {&#10;        // Constructor mặc định cho Firestore&#10;    }&#10;&#10;    public LessonProgress(String studentId, String courseId, String lessonId, boolean isCompleted) {&#10;        this.studentId = studentId;&#10;        this.courseId = courseId;&#10;        this.lessonId = lessonId;&#10;        this.isCompleted = isCompleted;&#10;        this.createdAt = new Date();&#10;        this.updatedAt = new Date();&#10;        if (isCompleted) {&#10;            this.completedAt = new Date();&#10;        }&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(String id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public String getStudentId() {&#10;        return studentId;&#10;    }&#10;&#10;    public void setStudentId(String studentId) {&#10;        this.studentId = studentId;&#10;    }&#10;&#10;    public String getCourseId() {&#10;        return courseId;&#10;    }&#10;&#10;    public void setCourseId(String courseId) {&#10;        this.courseId = courseId;&#10;    }&#10;&#10;    public String getLessonId() {&#10;        return lessonId;&#10;    }&#10;&#10;    public void setLessonId(String lessonId) {&#10;        this.lessonId = lessonId;&#10;    }&#10;&#10;    public boolean isCompleted() {&#10;        return isCompleted;&#10;    }&#10;&#10;    public void setCompleted(boolean completed) {&#10;        isCompleted = completed;&#10;        this.updatedAt = new Date();&#10;        if (completed &amp;&amp; this.completedAt == null) {&#10;            this.completedAt = new Date();&#10;        }&#10;    }&#10;&#10;    public Date getCompletedAt() {&#10;        return completedAt;&#10;    }&#10;&#10;    public void setCompletedAt(Date completedAt) {&#10;        this.completedAt = completedAt;&#10;    }&#10;&#10;    public Date getCreatedAt() {&#10;        return createdAt;&#10;    }&#10;&#10;    public void setCreatedAt(Date createdAt) {&#10;        this.createdAt = createdAt;&#10;    }&#10;&#10;    public Date getUpdatedAt() {&#10;        return updatedAt;&#10;    }&#10;&#10;    public void setUpdatedAt(Date updatedAt) {&#10;        this.updatedAt = updatedAt;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/Quiz.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/Quiz.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.Date;&#10;import java.util.List;&#10;&#10;public class Quiz {&#10;    private String id;&#10;    private String title;&#10;    private String courseId;&#10;    private String courseName;&#10;    private String teacherId;&#10;    private List&lt;QuizQuestion&gt; questions;&#10;    private Date createdAt;&#10;    private boolean active;&#10;&#10;    public Quiz() {&#10;        // Empty constructor required for Firestore&#10;    }&#10;&#10;    public Quiz(String title, String courseId, String courseName, String teacherId, &#10;                List&lt;QuizQuestion&gt; questions, Date createdAt, boolean active) {&#10;        this.title = title;&#10;        this.courseId = courseId;&#10;        this.courseName = courseName;&#10;        this.teacherId = teacherId;&#10;        this.questions = questions;&#10;        this.createdAt = createdAt;&#10;        this.active = active;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(String id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public String getTitle() {&#10;        return title;&#10;    }&#10;&#10;    public void setTitle(String title) {&#10;        this.title = title;&#10;    }&#10;&#10;    public String getCourseId() {&#10;        return courseId;&#10;    }&#10;&#10;    public void setCourseId(String courseId) {&#10;        this.courseId = courseId;&#10;    }&#10;&#10;    public String getCourseName() {&#10;        return courseName;&#10;    }&#10;&#10;    public void setCourseName(String courseName) {&#10;        this.courseName = courseName;&#10;    }&#10;&#10;    public String getTeacherId() {&#10;        return teacherId;&#10;    }&#10;&#10;    public void setTeacherId(String teacherId) {&#10;        this.teacherId = teacherId;&#10;    }&#10;&#10;    public List&lt;QuizQuestion&gt; getQuestions() {&#10;        return questions;&#10;    }&#10;&#10;    public void setQuestions(List&lt;QuizQuestion&gt; questions) {&#10;        this.questions = questions;&#10;    }&#10;&#10;    public Date getCreatedAt() {&#10;        return createdAt;&#10;    }&#10;&#10;    public void setCreatedAt(Date createdAt) {&#10;        this.createdAt = createdAt;&#10;    }&#10;&#10;    public boolean isActive() {&#10;        return active;&#10;    }&#10;&#10;    public void setActive(boolean active) {&#10;        this.active = active;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/QuizQuestion.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/QuizQuestion.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.List;&#10;&#10;public class QuizQuestion {&#10;    private String title;           // Tên bài kiểm tra (trường mới)&#10;    private String question;        // Nội dung câu hỏi&#10;    private List&lt;String&gt; options;   // Các lựa chọn A, B, C, D&#10;    private int correctAnswer;      // Chỉ số đáp án đúng (0-3)&#10;&#10;    public QuizQuestion() {&#10;        // Empty constructor required for Firestore&#10;    }&#10;&#10;    public QuizQuestion(String title, String question, List&lt;String&gt; options, int correctAnswer) {&#10;        this.title = title;&#10;        this.question = question;&#10;        this.options = options;&#10;        this.correctAnswer = correctAnswer;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getTitle() {&#10;        return title;&#10;    }&#10;&#10;    public void setTitle(String title) {&#10;        this.title = title;&#10;    }&#10;&#10;    public String getQuestion() {&#10;        return question;&#10;    }&#10;&#10;    public void setQuestion(String question) {&#10;        this.question = question;&#10;    }&#10;&#10;    public List&lt;String&gt; getOptions() {&#10;        return options;&#10;    }&#10;&#10;    public void setOptions(List&lt;String&gt; options) {&#10;        this.options = options;&#10;    }&#10;&#10;    public int getCorrectAnswer() {&#10;        return correctAnswer;&#10;    }&#10;&#10;    public void setCorrectAnswer(int correctAnswer) {&#10;        this.correctAnswer = correctAnswer;&#10;    }&#10;&#10;    // Backward compatibility methods&#10;    public int getCorrectAnswers() {&#10;        return correctAnswer;&#10;    }&#10;&#10;    public void setCorrectAnswers(int correctAnswers) {&#10;        this.correctAnswer = correctAnswers;&#10;    }&#10;&#10;    public String getQuestionText() {&#10;        return question;&#10;    }&#10;&#10;    public void setQuestionText(String questionText) {&#10;        this.question = questionText;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/SimpleTestQuestion.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/SimpleTestQuestion.java" />
              <option name="originalContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.List;&#10;&#10;public class SimpleTestQuestion {&#10;    private String courseId;            // ID khóa học (trường mới)&#10;    private List&lt;String&gt; correctAnswer; // Array - 4 đáp án A,B,C,D&#10;    private int options;                // Number - Index của đáp án đúng (0-3)&#10;    private String question;            // String - Nội dung câu hỏi&#10;&#10;    public SimpleTestQuestion() {&#10;        // Empty constructor required for Firestore&#10;    }&#10;&#10;    public SimpleTestQuestion(String courseId, List&lt;String&gt; correctAnswer, int options, String question) {&#10;        this.courseId = courseId;&#10;        this.correctAnswer = correctAnswer;&#10;        this.options = options;&#10;        this.question = question;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getCourseId() {&#10;        return courseId;&#10;    }&#10;&#10;    public void setCourseId(String courseId) {&#10;        this.courseId = courseId;&#10;    }&#10;&#10;    public List&lt;String&gt; getCorrectAnswer() {&#10;        return correctAnswer;&#10;    }&#10;&#10;    public void setCorrectAnswer(List&lt;String&gt; correctAnswer) {&#10;        this.correctAnswer = correctAnswer;&#10;    }&#10;&#10;    public int getOptions() {&#10;        return options;&#10;    }&#10;&#10;    public void setOptions(int options) {&#10;        this.options = options;&#10;    }&#10;&#10;    public String getQuestion() {&#10;        return question;&#10;    }&#10;&#10;    public void setQuestion(String question) {&#10;        this.question = question;&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;SimpleTestQuestion{&quot; +&#10;                &quot;courseId='&quot; + courseId + '\'' +&#10;                &quot;, question='&quot; + question + '\'' +&#10;                &quot;, correctAnswer=&quot; + correctAnswer +&#10;                &quot;, options=&quot; + options +&#10;                '}';&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.List;&#10;&#10;public class SimpleTestQuestion {&#10;    private String documentId;          // ID document Firebase (để edit/delete)&#10;    private String courseId;            // ID khóa học (trường mới)&#10;    private List&lt;String&gt; correctAnswer; // Array - 4 đáp án A,B,C,D&#10;    private int options;                // Number - Index của đáp án đúng (0-3)&#10;    private String question;            // String - Nội dung câu hỏi&#10;&#10;    public SimpleTestQuestion() {&#10;        // Empty constructor required for Firestore&#10;    }&#10;&#10;    public SimpleTestQuestion(String documentId, String courseId, List&lt;String&gt; correctAnswer, int options, String question) {&#10;        this.documentId = documentId;&#10;        this.courseId = courseId;&#10;        this.correctAnswer = correctAnswer;&#10;        this.options = options;&#10;        this.question = question;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getDocumentId() {&#10;        return documentId;&#10;    }&#10;&#10;    public void setDocumentId(String documentId) {&#10;        this.documentId = documentId;&#10;    }&#10;&#10;    public String getCourseId() {&#10;        return courseId;&#10;    }&#10;&#10;    public void setCourseId(String courseId) {&#10;        this.courseId = courseId;&#10;    }&#10;&#10;    public List&lt;String&gt; getCorrectAnswer() {&#10;        return correctAnswer;&#10;    }&#10;&#10;    public void setCorrectAnswer(List&lt;String&gt; correctAnswer) {&#10;        this.correctAnswer = correctAnswer;&#10;    }&#10;&#10;    public int getOptions() {&#10;        return options;&#10;    }&#10;&#10;    public void setOptions(int options) {&#10;        this.options = options;&#10;    }&#10;&#10;    public String getQuestion() {&#10;        return question;&#10;    }&#10;&#10;    public void setQuestion(String question) {&#10;        this.question = question;&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;SimpleTestQuestion{&quot; +&#10;                &quot;documentId='&quot; + documentId + '\'' +&#10;                &quot;, courseId='&quot; + courseId + '\'' +&#10;                &quot;, question='&quot; + question + '\'' +&#10;                &quot;, correctAnswer=&quot; + correctAnswer +&#10;                &quot;, options=&quot; + options +&#10;                '}';&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/TestQuestion.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/models/TestQuestion.java" />
              <option name="updatedContent" value="package com.vantinh.tienganh.models;&#10;&#10;import java.util.List;&#10;&#10;public class TestQuestion {&#10;    private String courseId;        // ID khóa học&#10;    private String teacherId;       // ID giáo viên&#10;    private List&lt;String&gt; correctAnswer;  // Array 4 đáp án A,B,C,D&#10;    private int options;            // Index của đáp án đúng (0-3)&#10;    private String question;        // Nội dung câu hỏi&#10;&#10;    public TestQuestion() {&#10;        // Empty constructor required for Firestore&#10;    }&#10;&#10;    public TestQuestion(String courseId, String teacherId, List&lt;String&gt; correctAnswer, &#10;                       int options, String question) {&#10;        this.courseId = courseId;&#10;        this.teacherId = teacherId;&#10;        this.correctAnswer = correctAnswer;&#10;        this.options = options;&#10;        this.question = question;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getCourseId() {&#10;        return courseId;&#10;    }&#10;&#10;    public void setCourseId(String courseId) {&#10;        this.courseId = courseId;&#10;    }&#10;&#10;    public String getTeacherId() {&#10;        return teacherId;&#10;    }&#10;&#10;    public void setTeacherId(String teacherId) {&#10;        this.teacherId = teacherId;&#10;    }&#10;&#10;    public List&lt;String&gt; getCorrectAnswer() {&#10;        return correctAnswer;&#10;    }&#10;&#10;    public void setCorrectAnswer(List&lt;String&gt; correctAnswer) {&#10;        this.correctAnswer = correctAnswer;&#10;    }&#10;&#10;    public int getOptions() {&#10;        return options;&#10;    }&#10;&#10;    public void setOptions(int options) {&#10;        this.options = options;&#10;    }&#10;&#10;    public String getQuestion() {&#10;        return question;&#10;    }&#10;&#10;    public void setQuestion(String question) {&#10;        this.question = question;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/utils/QuestionViewHelper.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/vantinh/tienganh/utils/QuestionViewHelper.java" />
              <option name="originalContent" value="package com.vantinh.tienganh.utils;&#10;&#10;import android.content.Context;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.widget.EditText;&#10;import android.widget.ImageButton;&#10;import android.widget.LinearLayout;&#10;import android.widget.RadioGroup;&#10;import android.widget.RadioButton;&#10;import android.widget.TextView;&#10;import com.vantinh.tienganh.R;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class QuestionViewHelper {&#10;&#10;    public static class QuestionViewData {&#10;        public View questionView;&#10;        public EditText etQuestion;&#10;        public EditText[] etOptions;&#10;        public RadioGroup rgCorrectAnswer;&#10;        public TextView tvQuestionNumber;&#10;        public ImageButton btnDelete;&#10;&#10;        public QuestionViewData() {&#10;            etOptions = new EditText[4];&#10;        }&#10;    }&#10;&#10;    private Context context;&#10;    private LinearLayout questionsContainer;&#10;    private List&lt;QuestionViewData&gt; questionViews;&#10;    private OnQuestionCountChangeListener listener;&#10;&#10;    public interface OnQuestionCountChangeListener {&#10;        void onQuestionCountChanged(int count);&#10;    }&#10;&#10;    public QuestionViewHelper(Context context, LinearLayout questionsContainer) {&#10;        this.context = context;&#10;        this.questionsContainer = questionsContainer;&#10;        this.questionViews = new ArrayList&lt;&gt;();&#10;    }&#10;&#10;    public void setOnQuestionCountChangeListener(OnQuestionCountChangeListener listener) {&#10;        this.listener = listener;&#10;    }&#10;&#10;    public void addQuestion() {&#10;        LayoutInflater inflater = LayoutInflater.from(context);&#10;        View questionView = inflater.inflate(R.layout.item_dynamic_quiz_question, questionsContainer, false);&#10;&#10;        QuestionViewData questionData = new QuestionViewData();&#10;        questionData.questionView = questionView;&#10;        questionData.tvQuestionNumber = questionView.findViewById(R.id.tv_question_number);&#10;        questionData.etQuestion = questionView.findViewById(R.id.et_question);&#10;        questionData.etOptions[0] = questionView.findViewById(R.id.et_option_a);&#10;        questionData.etOptions[1] = questionView.findViewById(R.id.et_option_b);&#10;        questionData.etOptions[2] = questionView.findViewById(R.id.et_option_c);&#10;        questionData.etOptions[3] = questionView.findViewById(R.id.et_option_d);&#10;        questionData.rgCorrectAnswer = questionView.findViewById(R.id.rg_correct_answer);&#10;        questionData.btnDelete = questionView.findViewById(R.id.btn_delete_question);&#10;&#10;        // Set unique IDs for RadioButtons to avoid conflicts&#10;        int questionIndex = questionViews.size();&#10;        int baseId = 2000 + (questionIndex * 10);&#10;        RadioButton rbA = questionView.findViewById(R.id.rb_option_a);&#10;        RadioButton rbB = questionView.findViewById(R.id.rb_option_b);&#10;        RadioButton rbC = questionView.findViewById(R.id.rb_option_c);&#10;        RadioButton rbD = questionView.findViewById(R.id.rb_option_d);&#10;&#10;        // Kiểm tra null pointer&#10;        if (rbA == null || rbB == null || rbC == null || rbD == null) {&#10;            android.util.Log.e(&quot;QuestionViewHelper&quot;, &quot;RadioButton not found in layout!&quot;);&#10;            return;&#10;        }&#10;&#10;        rbA.setId(baseId + 1);&#10;        rbB.setId(baseId + 2);&#10;        rbC.setId(baseId + 3);&#10;        rbD.setId(baseId + 4);&#10;&#10;        // Setup toggle functionality for RadioButtons với log debug&#10;        android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Setting up RadioButton listeners for question &quot; + (questionIndex + 1));&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbA, &quot;A&quot;);&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbB, &quot;B&quot;);&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbC, &quot;C&quot;);&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbD, &quot;D&quot;);&#10;&#10;        // Set delete button click listener&#10;        if (questionData.btnDelete != null) {&#10;            questionData.btnDelete.setOnClickListener(v -&gt; removeQuestion(questionData));&#10;        }&#10;&#10;        questionViews.add(questionData);&#10;        questionsContainer.addView(questionView);&#10;&#10;        updateQuestionNumbers();&#10;        updateDeleteButtonsVisibility();&#10;&#10;        if (listener != null) {&#10;            listener.onQuestionCountChanged(questionViews.size());&#10;        }&#10;    }&#10;&#10;    private void setupRadioButtonToggle(RadioGroup radioGroup, RadioButton radioButton, String optionName) {&#10;        android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Setting up simplified listener for option &quot; + optionName);&#10;&#10;        // Chỉ sử dụng OnClickListener đơn giản - loại bỏ logic toggle phức tạp&#10;        radioButton.setOnClickListener(v -&gt; {&#10;            android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Option &quot; + optionName + &quot; clicked&quot;);&#10;&#10;            // Đơn giản: khi click thì check, RadioGroup sẽ tự động uncheck các button khác&#10;            if (!radioButton.isChecked()) {&#10;                radioButton.setChecked(true);&#10;                android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Checked option &quot; + optionName);&#10;            }&#10;        });&#10;&#10;        // Thêm OnCheckedChangeListener để debug&#10;        radioButton.setOnCheckedChangeListener((buttonView, isChecked) -&gt; {&#10;            android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Option &quot; + optionName + &quot; checked state changed to: &quot; + isChecked);&#10;        });&#10;    }&#10;&#10;    private void clearAllTags(RadioGroup radioGroup) {&#10;        // Clear tags của tất cả RadioButton trong group&#10;        for (int i = 0; i &lt; radioGroup.getChildCount(); i++) {&#10;            View child = radioGroup.getChildAt(i);&#10;            if (child instanceof LinearLayout) {&#10;                LinearLayout linearLayout = (LinearLayout) child;&#10;                for (int j = 0; j &lt; linearLayout.getChildCount(); j++) {&#10;                    View subChild = linearLayout.getChildAt(j);&#10;                    if (subChild instanceof RadioButton) {&#10;                        subChild.setTag(null);&#10;                    }&#10;                }&#10;            } else if (child instanceof RadioButton) {&#10;                child.setTag(null);&#10;            }&#10;        }&#10;    }&#10;&#10;    private void clearOtherButtonTags(RadioGroup radioGroup, RadioButton selectedButton) {&#10;        RadioButton rbA = radioGroup.findViewById(R.id.rb_option_a);&#10;        RadioButton rbB = radioGroup.findViewById(R.id.rb_option_b);&#10;        RadioButton rbC = radioGroup.findViewById(R.id.rb_option_c);&#10;        RadioButton rbD = radioGroup.findViewById(R.id.rb_option_d);&#10;&#10;        if (rbA != null &amp;&amp; rbA != selectedButton) rbA.setTag(false);&#10;        if (rbB != null &amp;&amp; rbB != selectedButton) rbB.setTag(false);&#10;        if (rbC != null &amp;&amp; rbC != selectedButton) rbC.setTag(false);&#10;        if (rbD != null &amp;&amp; rbD != selectedButton) rbD.setTag(false);&#10;    }&#10;&#10;    private void setupRadioGroupChangeListener(RadioGroup radioGroup) {&#10;        radioGroup.setOnCheckedChangeListener((group, checkedId) -&gt; {&#10;            android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;RadioGroup checked changed to: &quot; + checkedId);&#10;        });&#10;    }&#10;&#10;    public void removeQuestion(QuestionViewData questionData) {&#10;        if (questionViews.size() &lt;= 2) {&#10;            // Không cho phép xóa nếu chỉ còn 2 câu hỏi&#10;            return;&#10;        }&#10;&#10;        questionsContainer.removeView(questionData.questionView);&#10;        questionViews.remove(questionData);&#10;&#10;        updateQuestionNumbers();&#10;        updateDeleteButtonsVisibility();&#10;&#10;        if (listener != null) {&#10;            listener.onQuestionCountChanged(questionViews.size());&#10;        }&#10;    }&#10;&#10;    public void removeLastQuestion() {&#10;        if (questionViews.size() &lt;= 2) {&#10;            return;&#10;        }&#10;&#10;        QuestionViewData lastQuestion = questionViews.get(questionViews.size() - 1);&#10;        removeQuestion(lastQuestion);&#10;    }&#10;&#10;    private void updateQuestionNumbers() {&#10;        for (int i = 0; i &lt; questionViews.size(); i++) {&#10;            questionViews.get(i).tvQuestionNumber.setText(&quot;Câu hỏi &quot; + (i + 1) + &quot;:&quot;);&#10;        }&#10;    }&#10;&#10;    private void updateDeleteButtonsVisibility() {&#10;        boolean showDeleteButtons = questionViews.size() &gt; 2;&#10;        for (QuestionViewData questionData : questionViews) {&#10;            questionData.btnDelete.setVisibility(showDeleteButtons ? View.VISIBLE : View.GONE);&#10;        }&#10;    }&#10;&#10;    public List&lt;QuestionViewData&gt; getQuestionViews() {&#10;        return questionViews;&#10;    }&#10;&#10;    public int getQuestionCount() {&#10;        return questionViews.size();&#10;    }&#10;&#10;    public void initializeWithDefaultQuestions() {&#10;        // Thêm 2 câu hỏi mặc định&#10;        addQuestion();&#10;        addQuestion();&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.vantinh.tienganh.utils;&#10;&#10;import android.content.Context;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.widget.EditText;&#10;import android.widget.ImageButton;&#10;import android.widget.LinearLayout;&#10;import android.widget.RadioGroup;&#10;import android.widget.RadioButton;&#10;import android.widget.TextView;&#10;import com.vantinh.tienganh.R;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;public class QuestionViewHelper {&#10;&#10;    public static class QuestionViewData {&#10;        public View questionView;&#10;        public EditText etQuestion;&#10;        public EditText[] etOptions;&#10;        public RadioGroup rgCorrectAnswer;&#10;        public TextView tvQuestionNumber;&#10;        public ImageButton btnDelete;&#10;&#10;        public QuestionViewData() {&#10;            etOptions = new EditText[4];&#10;        }&#10;    }&#10;&#10;    private Context context;&#10;    private LinearLayout questionsContainer;&#10;    private List&lt;QuestionViewData&gt; questionViews;&#10;    private OnQuestionCountChangeListener listener;&#10;&#10;    public interface OnQuestionCountChangeListener {&#10;        void onQuestionCountChanged(int count);&#10;    }&#10;&#10;    public QuestionViewHelper(Context context, LinearLayout questionsContainer) {&#10;        this.context = context;&#10;        this.questionsContainer = questionsContainer;&#10;        this.questionViews = new ArrayList&lt;&gt;();&#10;    }&#10;&#10;    public void setOnQuestionCountChangeListener(OnQuestionCountChangeListener listener) {&#10;        this.listener = listener;&#10;    }&#10;&#10;    public void addQuestion() {&#10;        LayoutInflater inflater = LayoutInflater.from(context);&#10;        View questionView = inflater.inflate(R.layout.item_dynamic_quiz_question, questionsContainer, false);&#10;&#10;        QuestionViewData questionData = new QuestionViewData();&#10;        questionData.questionView = questionView;&#10;        questionData.tvQuestionNumber = questionView.findViewById(R.id.tv_question_number);&#10;        questionData.etQuestion = questionView.findViewById(R.id.et_question);&#10;        questionData.etOptions[0] = questionView.findViewById(R.id.et_option_a);&#10;        questionData.etOptions[1] = questionView.findViewById(R.id.et_option_b);&#10;        questionData.etOptions[2] = questionView.findViewById(R.id.et_option_c);&#10;        questionData.etOptions[3] = questionView.findViewById(R.id.et_option_d);&#10;        questionData.rgCorrectAnswer = questionView.findViewById(R.id.rg_correct_answer);&#10;        questionData.btnDelete = questionView.findViewById(R.id.btn_delete_question);&#10;&#10;        // Set unique IDs for RadioButtons to avoid conflicts&#10;        int questionIndex = questionViews.size();&#10;        int baseId = 2000 + (questionIndex * 10);&#10;        RadioButton rbA = questionView.findViewById(R.id.rb_option_a);&#10;        RadioButton rbB = questionView.findViewById(R.id.rb_option_b);&#10;        RadioButton rbC = questionView.findViewById(R.id.rb_option_c);&#10;        RadioButton rbD = questionView.findViewById(R.id.rb_option_d);&#10;&#10;        // Kiểm tra null pointer&#10;        if (rbA == null || rbB == null || rbC == null || rbD == null) {&#10;            android.util.Log.e(&quot;QuestionViewHelper&quot;, &quot;RadioButton not found in layout!&quot;);&#10;            return;&#10;        }&#10;&#10;        rbA.setId(baseId + 1);&#10;        rbB.setId(baseId + 2);&#10;        rbC.setId(baseId + 3);&#10;        rbD.setId(baseId + 4);&#10;&#10;        // Setup toggle functionality for RadioButtons với log debug&#10;        android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Setting up RadioButton listeners for question &quot; + (questionIndex + 1));&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbA, &quot;A&quot;);&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbB, &quot;B&quot;);&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbC, &quot;C&quot;);&#10;        setupRadioButtonToggle(questionData.rgCorrectAnswer, rbD, &quot;D&quot;);&#10;&#10;        // Set delete button click listener&#10;        if (questionData.btnDelete != null) {&#10;            questionData.btnDelete.setOnClickListener(v -&gt; removeQuestion(questionData));&#10;        }&#10;&#10;        questionViews.add(questionData);&#10;        questionsContainer.addView(questionView);&#10;&#10;        updateQuestionNumbers();&#10;        updateDeleteButtonsVisibility();&#10;&#10;        if (listener != null) {&#10;            listener.onQuestionCountChanged(questionViews.size());&#10;        }&#10;    }&#10;&#10;    private void setupRadioButtonToggle(RadioGroup radioGroup, RadioButton radioButton, String optionName) {&#10;        android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Setting up basic listener for option &quot; + optionName);&#10;&#10;        // Loại bỏ hoàn toàn logic toggle phức tạp - chỉ để RadioGroup tự quản lý&#10;        // Không cần OnClickListener custom vì RadioButton có sẵn behavior đúng&#10;        radioButton.setOnCheckedChangeListener((buttonView, isChecked) -&gt; {&#10;            if (isChecked) {&#10;                android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;Option &quot; + optionName + &quot; is now selected&quot;);&#10;            }&#10;        });&#10;    }&#10;&#10;    private void clearAllTags(RadioGroup radioGroup) {&#10;        // Clear tags của tất cả RadioButton trong group&#10;        for (int i = 0; i &lt; radioGroup.getChildCount(); i++) {&#10;            View child = radioGroup.getChildAt(i);&#10;            if (child instanceof LinearLayout) {&#10;                LinearLayout linearLayout = (LinearLayout) child;&#10;                for (int j = 0; j &lt; linearLayout.getChildCount(); j++) {&#10;                    View subChild = linearLayout.getChildAt(j);&#10;                    if (subChild instanceof RadioButton) {&#10;                        subChild.setTag(null);&#10;                    }&#10;                }&#10;            } else if (child instanceof RadioButton) {&#10;                child.setTag(null);&#10;            }&#10;        }&#10;    }&#10;&#10;    private void clearOtherButtonTags(RadioGroup radioGroup, RadioButton selectedButton) {&#10;        RadioButton rbA = radioGroup.findViewById(R.id.rb_option_a);&#10;        RadioButton rbB = radioGroup.findViewById(R.id.rb_option_b);&#10;        RadioButton rbC = radioGroup.findViewById(R.id.rb_option_c);&#10;        RadioButton rbD = radioGroup.findViewById(R.id.rb_option_d);&#10;&#10;        if (rbA != null &amp;&amp; rbA != selectedButton) rbA.setTag(false);&#10;        if (rbB != null &amp;&amp; rbB != selectedButton) rbB.setTag(false);&#10;        if (rbC != null &amp;&amp; rbC != selectedButton) rbC.setTag(false);&#10;        if (rbD != null &amp;&amp; rbD != selectedButton) rbD.setTag(false);&#10;    }&#10;&#10;    private void setupRadioGroupChangeListener(RadioGroup radioGroup) {&#10;        radioGroup.setOnCheckedChangeListener((group, checkedId) -&gt; {&#10;            android.util.Log.d(&quot;QuestionViewHelper&quot;, &quot;RadioGroup checked changed to: &quot; + checkedId);&#10;        });&#10;    }&#10;&#10;    public void removeQuestion(QuestionViewData questionData) {&#10;        if (questionViews.size() &lt;= 2) {&#10;            // Không cho phép xóa nếu chỉ còn 2 câu hỏi&#10;            return;&#10;        }&#10;&#10;        questionsContainer.removeView(questionData.questionView);&#10;        questionViews.remove(questionData);&#10;&#10;        updateQuestionNumbers();&#10;        updateDeleteButtonsVisibility();&#10;&#10;        if (listener != null) {&#10;            listener.onQuestionCountChanged(questionViews.size());&#10;        }&#10;    }&#10;&#10;    public void removeLastQuestion() {&#10;        if (questionViews.size() &lt;= 2) {&#10;            return;&#10;        }&#10;&#10;        QuestionViewData lastQuestion = questionViews.get(questionViews.size() - 1);&#10;        removeQuestion(lastQuestion);&#10;    }&#10;&#10;    private void updateQuestionNumbers() {&#10;        for (int i = 0; i &lt; questionViews.size(); i++) {&#10;            questionViews.get(i).tvQuestionNumber.setText(&quot;Câu hỏi &quot; + (i + 1) + &quot;:&quot;);&#10;        }&#10;    }&#10;&#10;    private void updateDeleteButtonsVisibility() {&#10;        boolean showDeleteButtons = questionViews.size() &gt; 2;&#10;        for (QuestionViewData questionData : questionViews) {&#10;            questionData.btnDelete.setVisibility(showDeleteButtons ? View.VISIBLE : View.GONE);&#10;        }&#10;    }&#10;&#10;    public List&lt;QuestionViewData&gt; getQuestionViews() {&#10;        return questionViews;&#10;    }&#10;&#10;    public int getQuestionCount() {&#10;        return questionViews.size();&#10;    }&#10;&#10;    public void initializeWithDefaultQuestions() {&#10;        // Thêm 2 câu hỏi mặc định&#10;        addQuestion();&#10;        addQuestion();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/border_gray.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/border_gray.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;@android:color/white&quot; /&gt;&#10;    &lt;stroke&#10;        android:width=&quot;1dp&quot;&#10;        android:color=&quot;@android:color/darker_gray&quot; /&gt;&#10;    &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/circle_button_red.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/circle_button_red.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#dc3545&quot; /&gt;&#10;    &lt;corners android:radius=&quot;20dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_a.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_a.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:shape=&quot;oval&quot;&gt;&#10;    &lt;solid android:color=&quot;#ffc107&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_b.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_b.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:shape=&quot;oval&quot;&gt;&#10;    &lt;solid android:color=&quot;#007bff&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_c.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_c.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:shape=&quot;oval&quot;&gt;&#10;    &lt;solid android:color=&quot;#28a745&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_d.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/circle_option_d.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:shape=&quot;oval&quot;&gt;&#10;    &lt;solid android:color=&quot;#dc3545&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/correct_answer_background.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/correct_answer_background.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#e8f5e8&quot; /&gt;&#10;    &lt;stroke android:width=&quot;2dp&quot; android:color=&quot;#28a745&quot; /&gt;&#10;    &lt;corners android:radius=&quot;12dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/gradient_header.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/gradient_header.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;gradient&#10;        android:startColor=&quot;#667eea&quot;&#10;        android:endColor=&quot;#764ba2&quot;&#10;        android:angle=&quot;45&quot; /&gt;&#10;    &lt;corners android:radius=&quot;12dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/input_background.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/input_background.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#f8f9fa&quot; /&gt;&#10;    &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#e9ecef&quot; /&gt;&#10;    &lt;corners android:radius=&quot;12dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/option_background_a.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/option_background_a.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#fff3cd&quot; /&gt;&#10;    &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#ffeaa7&quot; /&gt;&#10;    &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/option_background_b.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/option_background_b.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#d1ecf1&quot; /&gt;&#10;    &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#74c0fc&quot; /&gt;&#10;    &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/option_background_c.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/option_background_c.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#d4edda&quot; /&gt;&#10;    &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#51cf66&quot; /&gt;&#10;    &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/option_background_d.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/option_background_d.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#f8d7da&quot; /&gt;&#10;    &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#ff6b6b&quot; /&gt;&#10;    &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_a.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_a.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#ffc107&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;2dp&quot; android:color=&quot;#ff9800&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;    &lt;item android:state_checked=&quot;false&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#fff3cd&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#ffeaa7&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_b.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_b.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#007bff&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;2dp&quot; android:color=&quot;#0056b3&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;    &lt;item android:state_checked=&quot;false&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#d1ecf1&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#74c0fc&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_c.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_c.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#28a745&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;2dp&quot; android:color=&quot;#1e7e34&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;    &lt;item android:state_checked=&quot;false&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#d4edda&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#51cf66&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_d.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_button_selector_d.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#dc3545&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;2dp&quot; android:color=&quot;#bd2130&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;    &lt;item android:state_checked=&quot;false&quot;&gt;&#10;        &lt;shape android:shape=&quot;rectangle&quot;&gt;&#10;            &lt;solid android:color=&quot;#f8d7da&quot; /&gt;&#10;            &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;            &lt;stroke android:width=&quot;1dp&quot; android:color=&quot;#ff6b6b&quot; /&gt;&#10;        &lt;/shape&gt;&#10;    &lt;/item&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_a.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_a.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot; android:color=&quot;@android:color/white&quot; /&gt;&#10;    &lt;item android:state_checked=&quot;false&quot; android:color=&quot;#856404&quot; /&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_b.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_b.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot; android:color=&quot;@android:color/white&quot; /&gt;&#10;    &lt;item android:state_checked=&quot;false&quot; android:color=&quot;#004085&quot; /&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_c.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_c.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot; android:color=&quot;@android:color/white&quot; /&gt;&#10;    &lt;item android:state_checked=&quot;false&quot; android:color=&quot;#155724&quot; /&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_d.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/radio_text_color_d.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;item android:state_checked=&quot;true&quot; android:color=&quot;@android:color/white&quot; /&gt;&#10;    &lt;item android:state_checked=&quot;false&quot; android:color=&quot;#721c24&quot; /&gt;&#10;&lt;/selector&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/section_header.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/section_header.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;solid android:color=&quot;#e3f2fd&quot; /&gt;&#10;    &lt;corners android:radius=&quot;8dp&quot; /&gt;&#10;&lt;/shape&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/activity_select_course_for_quiz.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/activity_select_course_for_quiz.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:orientation=&quot;vertical&quot;&#10;    android:background=&quot;#F5F5F5&quot;&gt;&#10;&#10;    &lt;com.google.android.material.appbar.AppBarLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&gt;&#10;&#10;        &lt;androidx.appcompat.widget.Toolbar&#10;            android:id=&quot;@+id/toolbar&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;?attr/actionBarSize&quot;&#10;            android:background=&quot;?attr/colorPrimary&quot;&#10;            android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&#10;            app:popupTheme=&quot;@style/ThemeOverlay.AppCompat.Light&quot; /&gt;&#10;&#10;    &lt;/com.google.android.material.appbar.AppBarLayout&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;match_parent&quot;&#10;        android:orientation=&quot;vertical&quot;&#10;        android:padding=&quot;16dp&quot;&gt;&#10;&#10;        &lt;TextView&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;Chọn khóa học để tạo bài kiểm tra&quot;&#10;            android:textSize=&quot;20sp&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:textColor=&quot;@android:color/black&quot;&#10;            android:layout_marginBottom=&quot;16dp&quot;&#10;            android:gravity=&quot;center&quot; /&gt;&#10;&#10;        &lt;androidx.recyclerview.widget.RecyclerView&#10;            android:id=&quot;@+id/rv_courses&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;match_parent&quot;&#10;            android:layout_marginTop=&quot;8dp&quot; /&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;&lt;/LinearLayout&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/activity_teacher_dashboard.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/activity_teacher_dashboard.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:orientation=&quot;vertical&quot;&#10;    android:background=&quot;#F5F5F5&quot;&gt;&#10;&#10;    &lt;com.google.android.material.appbar.AppBarLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&gt;&#10;&#10;        &lt;androidx.appcompat.widget.Toolbar&#10;            android:id=&quot;@+id/toolbar&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;?attr/actionBarSize&quot;&#10;            android:background=&quot;?attr/colorPrimary&quot;&#10;            android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&#10;            app:popupTheme=&quot;@style/ThemeOverlay.AppCompat.Light&quot; /&gt;&#10;&#10;    &lt;/com.google.android.material.appbar.AppBarLayout&gt;&#10;&#10;    &lt;ScrollView&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;match_parent&quot;&#10;        android:padding=&quot;16dp&quot;&gt;&#10;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;vertical&quot;&gt;&#10;&#10;            &lt;!-- Welcome Text --&gt;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tv_welcome&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;Xin chào, Giáo viên&quot;&#10;                android:textSize=&quot;24sp&quot;&#10;                android:textStyle=&quot;bold&quot;&#10;                android:textColor=&quot;@android:color/black&quot;&#10;                android:layout_marginBottom=&quot;24dp&quot;&#10;                android:gravity=&quot;center&quot; /&gt;&#10;&#10;            &lt;!-- Statistics Cards --&gt;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:orientation=&quot;horizontal&quot;&#10;                android:layout_marginBottom=&quot;24dp&quot;&gt;&#10;&#10;                &lt;androidx.cardview.widget.CardView&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;100dp&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:layout_marginEnd=&quot;8dp&quot;&#10;                    app:cardCornerRadius=&quot;8dp&quot;&#10;                    app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;match_parent&quot;&#10;                        android:orientation=&quot;vertical&quot;&#10;                        android:gravity=&quot;center&quot;&#10;                        android:padding=&quot;16dp&quot;&gt;&#10;&#10;                        &lt;TextView&#10;                            android:id=&quot;@+id/tv_courses_count&quot;&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;0&quot;&#10;                            android:textSize=&quot;32sp&quot;&#10;                            android:textStyle=&quot;bold&quot;&#10;                            android:textColor=&quot;@android:color/holo_blue_dark&quot; /&gt;&#10;&#10;                        &lt;TextView&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Khóa học&quot;&#10;                            android:textSize=&quot;14sp&quot;&#10;                            android:textColor=&quot;@android:color/darker_gray&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;                &lt;androidx.cardview.widget.CardView&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;100dp&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:layout_marginStart=&quot;8dp&quot;&#10;                    android:layout_marginEnd=&quot;8dp&quot;&#10;                    app:cardCornerRadius=&quot;8dp&quot;&#10;                    app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;match_parent&quot;&#10;                        android:orientation=&quot;vertical&quot;&#10;                        android:gravity=&quot;center&quot;&#10;                        android:padding=&quot;16dp&quot;&gt;&#10;&#10;                        &lt;TextView&#10;                            android:id=&quot;@+id/tv_students_count&quot;&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;0&quot;&#10;                            android:textSize=&quot;32sp&quot;&#10;                            android:textStyle=&quot;bold&quot;&#10;                            android:textColor=&quot;@android:color/holo_green_dark&quot; /&gt;&#10;&#10;                        &lt;TextView&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Học viên&quot;&#10;                            android:textSize=&quot;14sp&quot;&#10;                            android:textColor=&quot;@android:color/darker_gray&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;                &lt;androidx.cardview.widget.CardView&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;100dp&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:layout_marginStart=&quot;8dp&quot;&#10;                    app:cardCornerRadius=&quot;8dp&quot;&#10;                    app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;match_parent&quot;&#10;                        android:orientation=&quot;vertical&quot;&#10;                        android:gravity=&quot;center&quot;&#10;                        android:padding=&quot;16dp&quot;&gt;&#10;&#10;                        &lt;TextView&#10;                            android:id=&quot;@+id/tv_pending_requests_count&quot;&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;0&quot;&#10;                            android:textSize=&quot;32sp&quot;&#10;                            android:textStyle=&quot;bold&quot;&#10;                            android:textColor=&quot;@android:color/holo_orange_dark&quot; /&gt;&#10;&#10;                        &lt;TextView&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Yêu cầu&quot;&#10;                            android:textSize=&quot;14sp&quot;&#10;                            android:textColor=&quot;@android:color/darker_gray&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;&#10;            &lt;!-- Action Buttons --&gt;&#10;            &lt;androidx.cardview.widget.CardView&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginBottom=&quot;16dp&quot;&#10;                app:cardCornerRadius=&quot;8dp&quot;&#10;                app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                &lt;LinearLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:orientation=&quot;vertical&quot;&#10;                    android:padding=&quot;16dp&quot;&gt;&#10;&#10;                    &lt;TextView&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:text=&quot;Quản lý khóa học&quot;&#10;                        android:textSize=&quot;18sp&quot;&#10;                        android:textStyle=&quot;bold&quot;&#10;                        android:textColor=&quot;@android:color/black&quot;&#10;                        android:layout_marginBottom=&quot;16dp&quot; /&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:orientation=&quot;horizontal&quot;&#10;                        android:layout_marginBottom=&quot;12dp&quot;&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_create_course&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Tạo khóa học&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_blue_dark&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginEnd=&quot;8dp&quot; /&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_manage_courses&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Quản lý khóa học&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_blue_dark&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginStart=&quot;8dp&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:orientation=&quot;horizontal&quot;&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_view_requests&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Xem yêu cầu&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_orange_dark&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginEnd=&quot;8dp&quot; /&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_view_students&quot;&#10;                            android:id=&quot;@+id/btn_create_quiz&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Xem học viên&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_green_dark&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_purple&quot;&#10;=======&#10;                            android:id=&quot;@+id/btn_view_students&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Xem học viên&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_green_dark&quot;&#10;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 542cd6292b68990ee1f3d7aca232549a251d4232&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginStart=&quot;8dp&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/LinearLayout&gt;&#10;&#10;            &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;    &lt;/ScrollView&gt;&#10;&#10;&lt;/LinearLayout&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;match_parent&quot;&#10;    android:orientation=&quot;vertical&quot;&#10;    android:background=&quot;#F5F5F5&quot;&gt;&#10;&#10;    &lt;com.google.android.material.appbar.AppBarLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&gt;&#10;&#10;        &lt;androidx.appcompat.widget.Toolbar&#10;            android:id=&quot;@+id/toolbar&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;?attr/actionBarSize&quot;&#10;            android:background=&quot;?attr/colorPrimary&quot;&#10;            android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&#10;            app:popupTheme=&quot;@style/ThemeOverlay.AppCompat.Light&quot; /&gt;&#10;&#10;    &lt;/com.google.android.material.appbar.AppBarLayout&gt;&#10;&#10;    &lt;ScrollView&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;match_parent&quot;&#10;        android:padding=&quot;16dp&quot;&gt;&#10;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;vertical&quot;&gt;&#10;&#10;            &lt;!-- Welcome Text --&gt;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tv_welcome&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;Xin chào, Giáo viên&quot;&#10;                android:textSize=&quot;24sp&quot;&#10;                android:textStyle=&quot;bold&quot;&#10;                android:textColor=&quot;@android:color/black&quot;&#10;                android:layout_marginBottom=&quot;24dp&quot;&#10;                android:gravity=&quot;center&quot; /&gt;&#10;&#10;            &lt;!-- Statistics Cards --&gt;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:orientation=&quot;horizontal&quot;&#10;                android:layout_marginBottom=&quot;24dp&quot;&gt;&#10;&#10;                &lt;androidx.cardview.widget.CardView&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;100dp&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:layout_marginEnd=&quot;8dp&quot;&#10;                    app:cardCornerRadius=&quot;8dp&quot;&#10;                    app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;match_parent&quot;&#10;                        android:orientation=&quot;vertical&quot;&#10;                        android:gravity=&quot;center&quot;&#10;                        android:padding=&quot;16dp&quot;&gt;&#10;&#10;                        &lt;TextView&#10;                            android:id=&quot;@+id/tv_courses_count&quot;&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;0&quot;&#10;                            android:textSize=&quot;32sp&quot;&#10;                            android:textStyle=&quot;bold&quot;&#10;                            android:textColor=&quot;@android:color/holo_blue_dark&quot; /&gt;&#10;&#10;                        &lt;TextView&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Khóa học&quot;&#10;                            android:textSize=&quot;14sp&quot;&#10;                            android:textColor=&quot;@android:color/darker_gray&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;                &lt;androidx.cardview.widget.CardView&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;100dp&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:layout_marginStart=&quot;8dp&quot;&#10;                    android:layout_marginEnd=&quot;8dp&quot;&#10;                    app:cardCornerRadius=&quot;8dp&quot;&#10;                    app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;match_parent&quot;&#10;                        android:orientation=&quot;vertical&quot;&#10;                        android:gravity=&quot;center&quot;&#10;                        android:padding=&quot;16dp&quot;&gt;&#10;&#10;                        &lt;TextView&#10;                            android:id=&quot;@+id/tv_students_count&quot;&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;0&quot;&#10;                            android:textSize=&quot;32sp&quot;&#10;                            android:textStyle=&quot;bold&quot;&#10;                            android:textColor=&quot;@android:color/holo_green_dark&quot; /&gt;&#10;&#10;                        &lt;TextView&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Học viên&quot;&#10;                            android:textSize=&quot;14sp&quot;&#10;                            android:textColor=&quot;@android:color/darker_gray&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;                &lt;androidx.cardview.widget.CardView&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;100dp&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:layout_marginStart=&quot;8dp&quot;&#10;                    app:cardCornerRadius=&quot;8dp&quot;&#10;                    app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;match_parent&quot;&#10;                        android:orientation=&quot;vertical&quot;&#10;                        android:gravity=&quot;center&quot;&#10;                        android:padding=&quot;16dp&quot;&gt;&#10;&#10;                        &lt;TextView&#10;                            android:id=&quot;@+id/tv_pending_requests_count&quot;&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;0&quot;&#10;                            android:textSize=&quot;32sp&quot;&#10;                            android:textStyle=&quot;bold&quot;&#10;                            android:textColor=&quot;@android:color/holo_orange_dark&quot; /&gt;&#10;&#10;                        &lt;TextView&#10;                            android:layout_width=&quot;wrap_content&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:text=&quot;Yêu cầu&quot;&#10;                            android:textSize=&quot;14sp&quot;&#10;                            android:textColor=&quot;@android:color/darker_gray&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;&#10;            &lt;!-- Action Buttons --&gt;&#10;            &lt;androidx.cardview.widget.CardView&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginBottom=&quot;16dp&quot;&#10;                app:cardCornerRadius=&quot;8dp&quot;&#10;                app:cardElevation=&quot;4dp&quot;&gt;&#10;&#10;                &lt;LinearLayout&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:orientation=&quot;vertical&quot;&#10;                    android:padding=&quot;16dp&quot;&gt;&#10;&#10;                    &lt;TextView&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:text=&quot;Quản lý khóa học&quot;&#10;                        android:textSize=&quot;18sp&quot;&#10;                        android:textStyle=&quot;bold&quot;&#10;                        android:textColor=&quot;@android:color/black&quot;&#10;                        android:layout_marginBottom=&quot;16dp&quot; /&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:orientation=&quot;horizontal&quot;&#10;                        android:layout_marginBottom=&quot;12dp&quot;&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_create_course&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Tạo khóa học&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_blue_dark&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginEnd=&quot;8dp&quot; /&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_manage_courses&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Quản lý khóa học&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_blue_dark&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginStart=&quot;8dp&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                    &lt;LinearLayout&#10;                        android:layout_width=&quot;match_parent&quot;&#10;                        android:layout_height=&quot;wrap_content&quot;&#10;                        android:orientation=&quot;horizontal&quot;&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_view_requests&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Xem yêu cầu&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_orange_dark&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginEnd=&quot;8dp&quot; /&gt;&#10;&#10;                        &lt;Button&#10;                            android:id=&quot;@+id/btn_create_quiz&quot;&#10;                            android:layout_width=&quot;0dp&quot;&#10;                            android:layout_height=&quot;wrap_content&quot;&#10;                            android:layout_weight=&quot;1&quot;&#10;                            android:text=&quot;Tạo bài kiểm tra&quot;&#10;                            android:backgroundTint=&quot;@android:color/holo_purple&quot;&#10;                            android:textColor=&quot;@android:color/white&quot;&#10;                            android:layout_marginStart=&quot;8dp&quot; /&gt;&#10;&#10;                    &lt;/LinearLayout&gt;&#10;&#10;                &lt;/LinearLayout&gt;&#10;&#10;            &lt;/androidx.cardview.widget.CardView&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;    &lt;/ScrollView&gt;&#10;&#10;&lt;/LinearLayout&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/item_quiz_question.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/item_quiz_question.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:orientation=&quot;vertical&quot;&#10;    android:layout_marginBottom=&quot;24dp&quot;&#10;    android:background=&quot;@drawable/border_gray&quot;&#10;    android:padding=&quot;16dp&quot;&gt;&#10;&#10;    &lt;TextView&#10;        android:id=&quot;@+id/tv_question_number&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;Câu hỏi 1:&quot;&#10;        android:textSize=&quot;16sp&quot;&#10;        android:textStyle=&quot;bold&quot;&#10;        android:textColor=&quot;@android:color/holo_purple&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot; /&gt;&#10;&#10;    &lt;com.google.android.material.textfield.TextInputLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:layout_marginBottom=&quot;16dp&quot;&#10;        android:hint=&quot;Nhập câu hỏi&quot;&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputEditText&#10;            android:id=&quot;@+id/et_question&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:minLines=&quot;2&quot; /&gt;&#10;&#10;    &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;TextView&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;Các lựa chọn:&quot;&#10;        android:textSize=&quot;14sp&quot;&#10;        android:textStyle=&quot;bold&quot;&#10;        android:textColor=&quot;@android:color/black&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot; /&gt;&#10;&#10;    &lt;!-- Option A --&gt;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;        &lt;RadioButton&#10;            android:id=&quot;@+id/rb_option_a&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;A&quot; /&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginStart=&quot;8dp&quot;&#10;            android:hint=&quot;Lựa chọn A&quot;&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputEditText&#10;                android:id=&quot;@+id/et_option_a&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;        &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;    &lt;!-- Option B --&gt;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;        &lt;RadioButton&#10;            android:id=&quot;@+id/rb_option_b&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;B&quot; /&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginStart=&quot;8dp&quot;&#10;            android:hint=&quot;Lựa chọn B&quot;&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputEditText&#10;                android:id=&quot;@+id/et_option_b&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;        &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;    &lt;!-- Option C --&gt;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;        &lt;RadioButton&#10;            android:id=&quot;@+id/rb_option_c&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;C&quot; /&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginStart=&quot;8dp&quot;&#10;            android:hint=&quot;Lựa chọn C&quot;&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputEditText&#10;                android:id=&quot;@+id/et_option_c&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;        &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;    &lt;!-- Option D --&gt;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;        &lt;RadioButton&#10;            android:id=&quot;@+id/rb_option_d&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;D&quot; /&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_marginStart=&quot;8dp&quot;&#10;            android:hint=&quot;Lựa chọn D&quot;&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputEditText&#10;                android:id=&quot;@+id/et_option_d&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;        &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;    &lt;TextView&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;Chọn đáp án đúng bằng cách tick vào radio button tương ứng&quot;&#10;        android:textSize=&quot;12sp&quot;&#10;        android:textStyle=&quot;italic&quot;&#10;        android:textColor=&quot;@android:color/darker_gray&quot;&#10;        android:layout_marginTop=&quot;8dp&quot; /&gt;&#10;&#10;&lt;/LinearLayout&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:orientation=&quot;vertical&quot;&#10;    android:layout_marginBottom=&quot;24dp&quot;&#10;    android:background=&quot;@drawable/border_gray&quot;&#10;    android:padding=&quot;16dp&quot;&gt;&#10;&#10;    &lt;TextView&#10;        android:id=&quot;@+id/tv_question_number&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;Câu hỏi 1:&quot;&#10;        android:textSize=&quot;16sp&quot;&#10;        android:textStyle=&quot;bold&quot;&#10;        android:textColor=&quot;@android:color/holo_purple&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot; /&gt;&#10;&#10;    &lt;com.google.android.material.textfield.TextInputLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:layout_marginBottom=&quot;16dp&quot;&#10;        android:hint=&quot;Nhập câu hỏi&quot;&gt;&#10;&#10;        &lt;com.google.android.material.textfield.TextInputEditText&#10;            android:id=&quot;@+id/et_question&quot;&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:minLines=&quot;2&quot; /&gt;&#10;&#10;    &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;    &lt;TextView&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;Các lựa chọn:&quot;&#10;        android:textSize=&quot;14sp&quot;&#10;        android:textStyle=&quot;bold&quot;&#10;        android:textColor=&quot;@android:color/black&quot;&#10;        android:layout_marginBottom=&quot;8dp&quot; /&gt;&#10;&#10;    &lt;!-- RadioGroup to properly group RadioButtons --&gt;&#10;    &lt;RadioGroup&#10;        android:id=&quot;@+id/rg_correct_answer&quot;&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;vertical&quot;&gt;&#10;&#10;        &lt;!-- Option A --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_option_a&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;A&quot; /&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginStart=&quot;8dp&quot;&#10;                android:hint=&quot;Lựa chọn A&quot;&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputEditText&#10;                    android:id=&quot;@+id/et_option_a&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;            &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Option B --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_option_b&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;B&quot; /&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginStart=&quot;8dp&quot;&#10;                android:hint=&quot;Lựa chọn B&quot;&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputEditText&#10;                    android:id=&quot;@+id/et_option_b&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;            &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Option C --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_option_c&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;C&quot; /&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginStart=&quot;8dp&quot;&#10;                android:hint=&quot;Lựa chọn C&quot;&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputEditText&#10;                    android:id=&quot;@+id/et_option_c&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;            &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Option D --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginBottom=&quot;8dp&quot;&gt;&#10;&#10;            &lt;RadioButton&#10;                android:id=&quot;@+id/rb_option_d&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;D&quot; /&gt;&#10;&#10;            &lt;com.google.android.material.textfield.TextInputLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_marginStart=&quot;8dp&quot;&#10;                android:hint=&quot;Lựa chọn D&quot;&gt;&#10;&#10;                &lt;com.google.android.material.textfield.TextInputEditText&#10;                    android:id=&quot;@+id/et_option_d&quot;&#10;                    android:layout_width=&quot;match_parent&quot;&#10;                    android:layout_height=&quot;wrap_content&quot; /&gt;&#10;&#10;            &lt;/com.google.android.material.textfield.TextInputLayout&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;    &lt;/RadioGroup&gt;&#10;&#10;    &lt;TextView&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:text=&quot;Chọn đáp án đúng bằng cách tick vào radio button tương ứng&quot;&#10;        android:textSize=&quot;12sp&quot;&#10;        android:textStyle=&quot;italic&quot;&#10;        android:textColor=&quot;@android:color/darker_gray&quot;&#10;        android:layout_marginTop=&quot;8dp&quot; /&gt;&#10;&#10;&lt;/LinearLayout&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>